<!DOCTYPE html>
<div class="articleTxt">
 <div class="articleBadge-editionMeta-doi-copyLink">
  <span class="_articleBadge">
   Artigos Gerais
  </span>
  <span class="_separator">
   •
  </span>
  <span class="_editionMeta">
   Rev. Bras. Ensino Fís. 25 
                (1)
   <span class="_separator">
    •
   </span>
   2003
  </span>
  <span class="_separator">
   •
  </span>
  <span class="group-doi">
   <a class="_doi" href="https://doi.org/10.1590/S1806-11172003000100004" target="_blank">
    https://doi.org/10.1590/S1806-11172003000100004
   </a>
   <a class="copyLink" data-clipboard-text="https://doi.org/10.1590/S1806-11172003000100004">
    <span class="sci-ico-link">
    </span>
    copiar
   </a>
  </span>
 </div>
 <h1 class="article-title">
  <span class="sci-ico-openAccess showTooltip" data-original-title="by-nc 4.0 " data-toggle="tooltip">
  </span>
  Partícula em um poço de potencial infinito e o método variacional de Monte Carlo
  <a class="short-link" href="#" id="shorten">
   <span class="sci-ico-link">
   </span>
  </a>
 </h1>
 <h2 class="article-title">
  Particle in an infinity potential well and the variational Monte Carlo method
 </h2>
 <div class="articleMeta">
 </div>
 <div class="contribGroup">
  <span class="dropdown">
   <a class="dropdown-toggle" data-toggle="dropdown" id="contribGroupTutor1">
    <span>
     Rodrigo Canabrava
    </span>
   </a>
   <ul aria-labelledby="contribGrupoTutor1" class="dropdown-menu" role="menu">
    <strong>
    </strong>
    ,  Campinas,  
          ,  São Paulo,  
        ,  Universidade Estadual de Campinas,  Instituto de Física ,  Brazil
   </ul>
  </span>
  <span class="dropdown">
   <a class="dropdown-toggle" data-toggle="dropdown" id="contribGroupTutor2">
    <span>
     Silvio A. Vitiello
    </span>
   </a>
   <ul aria-labelledby="contribGrupoTutor2" class="dropdown-menu" role="menu">
    <strong>
    </strong>
    ,  Campinas,  
          ,  São Paulo,  
        ,  Universidade Estadual de Campinas,  Instituto de Física ,  Brazil
   </ul>
  </span>
  <a class="outlineFadeLink" data-target="#ModalTutors" data-toggle="modal" href="">
   Sobre os autores
  </a>
 </div>
 <div class="row">
  <ul class="col-md-2 hidden-sm articleMenu">
  </ul>
  <article class="col-md-10 col-md-offset-2 col-sm-12 col-sm-offset-0" id="articleText">
   <div class="articleSection" data-anchor="Resumos">
    <h1 class="articleSectionTitle">
     Resumos
    </h1>
   </div>
   <div>
    <p>
     Neste trabalho, apresentamos o método variacional de Monte Carlo, aplicado a um sistema de uma partícula confinada em um poço de potencial infinito. A amostragem da densidade de probabilidade é feita utilizando-se o algoritmo de Metropolis. O objetivo do trabalho é apresentar de forma didática o método e sua implementação em computadores.
    </p>
   </div>
   <hr/>
   <div>
    <p>
     We apply the variational Monte Carlo method to study a particle in an infinite potential well. The probability density is sampled using the Metropolis algorithm. The aim of this work is to present in a pedagogical way both the method and its computer implementation.
    </p>
   </div>
   <hr/>
   <div class="articleSection" data-anchor="Text">
    <p>
    </p>
    <p>
     <b>
      Partícula em um poço de potencial infinito e o método variacional de Monte Carlo
     </b>
    </p>
    <p>
    </p>
    <p>
     <b>
      Particle in an infinity potential well and the variational Monte Carlo method
     </b>
    </p>
    <p>
    </p>
    <p>
     <b>
      Rodrigo Canabrava;  Silvio A. Vitiello
     </b>
    </p>
    <p>
    </p>
    <p>
     Instituto de Física, Universidade Estadual de Campinas. 13083 Campinas - SP, Brasil
    </p>
    <p>
    </p>
    <p>
     <span class="ref footnote">
      <sup class="xref">
       Endereço para correspondência
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        Endereço para correspondência
         Rodrigo Canabrava 
         E-mail: 
        
          rodrigo.canabrava@ic.unicamp.br
       </span>
      </span>
     </span>
    </p>
    <p>
    </p>
    <p>
     <b>
      RESUMO
     </b>
    </p>
    <p>
    </p>
    <p>
     Neste trabalho, apresentamos o método variacional de Monte Carlo, aplicado a um sistema de uma partícula confinada em um poço de potencial infinito. A amostragem da densidade de probabilidade é feita utilizando-se o algoritmo de Metropolis. O objetivo do trabalho é apresentar de forma didática o método e sua implementação em computadores.
    </p>
    <p>
    </p>
    <p>
     <b>
      ABSTRACT
     </b>
    </p>
    <p>
    </p>
    <p>
     We apply the variational Monte Carlo method to study a particle in an infinite potential well. The probability density is sampled using the Metropolis algorithm. The aim of this work is to present in a pedagogical way both the method and its computer implementation.
    </p>
    <p>
    </p>
    <p>
     <b>
      I Introdução
     </b>
    </p>
    <p>
    </p>
    <p>
     A simulação de sistemas físicos em computadores vem se tornando essencial para o estudo da física e da ciência dos materiais, pois os modelos teóricos dos sistemas da natureza, cada vez mais realistas, são também cada vez mais complexos.
    </p>
    <p>
    </p>
    <p>
     Nessas simulações são avaliadas grandezas de interesse do sistema, sem que as equações que as descrevem sejam explicitamente resolvidas. A idéia desses métodos é obter respostas numéricas sujeitas apenas a incertezas de natureza estatística em situações em que não é possível determinar resultados de forma analítica.
    </p>
    <p>
    </p>
    <p>
     Neste artigo, apresentamos o método variacional de Monte Carlo e o aplicamos num problema físico extremamente simples de uma partícula confinada em um poço de potencial infinito.
    </p>
    <p>
    </p>
    <p>
     O método de Monte Carlo possibilita o cálculo de diversas grandezas de interesse do sistema, entre elas, a sua energia total. Para tanto, diversas configurações (posições da partícula no espaço), são utilizadas. Cada configuração possui uma probabilidade de ocorrer. Assim, a energia do sistema é dada pela média das energias associadas a cada configuração, e ponderada pela densidade de probabilidade
     <i>
      P
     </i>
     de esta configuração ocorrer.
    </p>
    <p>
    </p>
    <p>
     Essa ponderação é feita escolhendo-se as configurações por essa densidade de probabilidade. Dentre os algoritmos que permitem fazer essa amostragem, está o algoritmo de Metropolis[1].
    </p>
    <p>
    </p>
    <p>
     O algoritmo de Metropolis permite, a cada passo, obter uma nova configuração a partir da anterior, utilizando a densidade de probabilidade
     <i>
      P
     </i>
     . O algoritmo permite essencialmente que configurações mais prováveis tenham mais chance de ocorrer na média das grandezas de interesse.
    </p>
    <p>
    </p>
    <p>
     Na próxima seção, descrevemos o modelo da partícula no poço de potencial. Na seção 3 discutimos o método variacional. Nas duas seções seguintes, apresentamos o método variacional, e o algoritmo de Metropolis, respectivamente. Em seguida, discutimos detalhes da implementação, e apresentamos os resultados obtidos.
    </p>
    <p>
    </p>
    <p>
     <b>
      II Partícula confinada num poço de potencial infinito
     </b>
    </p>
    <p>
    </p>
    <p>
     Para uma partícula em estado estacionário, isto é, em que não há variação na sua energia, a equação de Schrödinger é dada por
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm01">
     <a name="frm01">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/6f0155de634630fb1170d9ac04c1ac5f93a10abc.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     em que
     <i>
      H
     </i>
     é a Hamiltoniana, em um problema unidimensional, escrita como
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm02">
     <a name="frm02">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/7c4244efce7ba96af2eaa9c393af78479348253d.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     Para simplificarmos, utilizamos unidades onde
     <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/d1dce78b651b494f94e81526b3e8fcf1747d871a.gif" style="max-width:100%"/>
     = 2
     <i>
      m
     </i>
     = 1. Para uma partícula em um poço de potencial infinito, podemos ter:
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm03">
     <a name="frm03">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/f51e75af63a3a48f39825295e95a7f59ee985743.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     Assim, as condições de contorno satisfeitas por y(
     <i>
      x
     </i>
     ) devem ser:
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm04">
     <a name="frm04">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/3837fdaffca0bef5f6a25b170877a3e68a3f6355.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     A Eq. (1) é uma equação diferencial de segundo grau homogênea e permite soluções exatas da forma
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm05">
     <a name="frm05">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/b265b6ded00a8a157f7231d6aacc0104796981a5.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     Considerando as condições de contorno, obtemos as soluções
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm06">
     <a name="frm06">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/a53e44dbb3ed48931d149301cfeb2e38fdcffd6a.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     com
     <i>
      n
     </i>
     inteiro e maior que zero. Utilizando este resultado na Eq. (1), obtemos os auto-valores da energia
     <i>
      E
      <sub>
       n
      </sub>
     </i>
     :
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm07">
     <a name="frm07">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/bffd16a597a9e2f90917ff3f7a994033322c4769.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     Portanto, para o estado fundamental, temos
     <i>
      E
     </i>
     <sub>
      0
     </sub>
     = p
     <sup>
      2
     </sup>
    </p>
    <p>
    </p>
    <p>
     <b>
      III Método variacional
     </b>
    </p>
    <p>
    </p>
    <p>
     Em situações onde não é possível determinarmos a solução exata da equação de Schrödinger, o método variacional é de grande utilidade. Isso porque, como sabemos[2], ele fornece um limite superior para o valor da energia. Ao construirmos uma função de onda tentativa y
     <sub>
      <i>
       T
      </i>
     </sub>
     , é importante que ela incorpore da melhor maneira possível os conhecimentos que temos do sistema.
    </p>
    <p>
    </p>
    <p>
     A energia variacional de um sistema pode ser escrita como:
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm08">
     <a name="frm08">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/1e10e769bec897dd716293d16ee8fcdd4e768b0d.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     Se na construção de y
     <sub>
      <i>
       T
      </i>
     </sub>
     utilizamos parâmetros,
     <i>
      E
      <sub>
       T
      </sub>
     </i>
     é minimizada com respeito aos mesmos.
    </p>
    <p>
    </p>
    <p>
     Para ilustrar a aplicação do método variacional ao problema da partícula no poço de potencial, vamos adotar como função tentativa, para o estado fundamental:
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm09">
     <a name="frm09">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/9c79460b8ab3599e9086d457eeb138a7b00466d1.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     em que
     <i>
      N
     </i>
     é a constante de normalização. Na
     <a class="open-asset-modal" data-target="#ModalFigfig01" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      Fig. 1
     </a>
     apresentamos uma comparação desta função tentativa com a função de onda exata do problema.
    </p>
    <div class="row fig" id="fig01">
     <a name="fig01">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigfig01" data-toggle="modal" href="">
       <div class="thumbOff">
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <br/>
     </div>
    </div>
    <p>
    </p>
    <p>
     Portanto, para esse problema, se substituírmos y
     <sub>
      <i>
       T
      </i>
     </sub>
     dada pela Eq. (9) na Eq. (8), temos que
     <i>
      E
      <sub>
       T
      </sub>
     </i>
     = 10. Este valor é bem próximo do valor exato da Eq. (7).
    </p>
    <p>
    </p>
    <p>
     <b>
      IV Método variacional de Monte Carlo
     </b>
    </p>
    <p>
    </p>
    <p>
     A integração que acabamos de realizar analiticamente sem dúvida pode ser feita numericamente. Caso estivéssemos tratando um problema de muitas partículas e que envolvessem funções não integráveis analiticamente, provavelmente a única alternativa seria empregarmos o método de Monte Carlo para realizarmos as integrações necessárias. Apesar de nosso problema não justificar a utilização deste método, iremos empregá-lo aqui para ilustrar sua aplicação.
    </p>
    <p>
    </p>
    <p>
     Na aplicação do método variacional de Monte Carlo, é útil reescrevermos a Eq. (8) como
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm10">
     <a name="frm10">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/c02e9f1a0ea170897121c86fc1ea9528bf1cf006.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     onde
     <i>
      P
     </i>
     (
     <i>
      R
     </i>
     ) é uma densidade de probabilidade dada por:
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm11">
     <a name="frm11">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/9274e7e5d036607e4873029161c26ba55698ec52.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     e
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm12">
     <a name="frm12">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/3eee88eb502c57a52559119663b8aa42f6df3976.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     é chamada de energia local. Obviamente, para as auto-funções da Hamiltoniana (1),
     <i>
      E
      <sub>
       L
      </sub>
     </i>
     será uma constante.
    </p>
    <p>
    </p>
    <p>
     A probabilidade de encontrarmos uma partícula numa certa posição,
     <i>
      P
     </i>
     (
     <i>
      x
     </i>
     ) = |y
     <sub>
      0
     </sub>
     (
     <i>
      x
     </i>
     )|
     <sup>
      2
     </sup>
     , é dada, considerando-se a função variacional da Eq. (9), por
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm13">
     <a name="frm13">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/fefe5f036d6f7c511f825b19104cc419bffd4075.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     Note que o método de Metropolis não envolve o conhecimento explícito do valor da constante
     <i>
      N
     </i>
     . A energia local, neste caso, é dada por
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm14">
     <a name="frm14">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/47214d4870dbd9f6cf481798d5de85b68d1a3958.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     A energia variacional, como escrita na Eq. (10), mostra a utilidade dos métodos de Monte Carlo na sua determinação. É necessário amostrarmos a densidade de probabilidade
     <i>
      P
     </i>
     (
     <i>
      x
     </i>
     ) para obter a seqüência de configurações
     <i>
      x
     </i>
     <sub>
      1
     </sub>
     ,
     <i>
      x
     </i>
     <sub>
      2
     </sub>
     ,...,x
     <sub>
      M
     </sub>
     e compor a média:
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm15">
     <a name="frm15">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/29b1a78e7891e31a40bb6f33e38ebdef30429437.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     com as M configurações
     <i>
      x
      <sub>
       i
      </sub>
     </i>
     .
    </p>
    <p>
    </p>
    <p>
     No processo de amostragem construimos uma seqüência
     <i>
      x
      <sub>
       i
      </sub>
     </i>
     distribuida de acordo com
     <i>
      P
     </i>
     (
     <i>
      x
     </i>
     ), isto é, teremos mais pontos onde
     <i>
      P
     </i>
     assume seus maiores valores. Como já mencionamos, os resultados estão sujeitos a incertezas estatísticas, o que torna essencial a estimativa da variância:
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm16">
     <a name="frm16">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/2501c43e8c32f9e354794c0bc9651a8276f383ee.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     e conseqüentemente do erro padrão s/
     <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/98afe569dfb4821d27f5d847d0efe5ae9d00a303.gif" style="max-width:100%"/>
     .
    </p>
    <p>
    </p>
    <p>
     A amostragem de
     <i>
      P
     </i>
     (
     <i>
      x
     </i>
     ), no caso particular deste trabalho, pode ser feita sem dificuldades utilizando diversos algoritmos. O algoritmo de Metropolis é um dos mais empregados na literatura por ser de aplicação geral. Ele será utilizado aqui e é descrito a seguir.
    </p>
    <p>
    </p>
    <p>
     <b>
      V Algoritmo de Metropolis
     </b>
    </p>
    <p>
    </p>
    <p>
     O algoritmo de Metropolis [1] é muito poderoso porque permite amostrarmos qualquer distribuição de probabilidade
     <i>
      P
     </i>
     . Uma nova configuração aleatória para o sistema é proposta a partir da anterior. As probabilidades da posição atual e da nova posição proposta são utilizadas para determinar se a nova configuração é aceita. São permitidos movimentos tanto para configurações de maior como de menor probabilidade que a atual.
    </p>
    <p>
    </p>
    <p>
     O algoritmo é o seguinte:
    </p>
    <p>
    </p>
    <p>
     1) Escolha uma configuração arbitrária
     <i>
      x
      <sub>
       i
      </sub>
     </i>
     onde
     <i>
      i
     </i>
     = 0.
    </p>
    <p>
    </p>
    <p>
     2) Faça
     <i>
      x
      <sub>
       novo
      </sub>
     </i>
     =
     <i>
      x
      <sub>
       i
      </sub>
     </i>
     + (
     <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/c9268d76fb96fe9beed2b9bdc84d6fc48af3c2b8.gif" style="max-width:100%"/>
     
     <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/42d7f6be48472449247b8c3ef5ecdb87ebb424dc.gif" style="max-width:100%"/>
     )D,
    </p>
    <p>
    </p>
    <p>
     onde
     <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/c9268d76fb96fe9beed2b9bdc84d6fc48af3c2b8.gif" style="max-width:100%"/>
     é um número aleatório[3] no intervalo [0,1], e D é um parâmetro do qual os resultados são independentes.
    </p>
    <p>
    </p>
    <p>
     3) Se
    </p>
    <div class="row fig" id="606cb7f52fa224d54a2ee9b09e87f7de10cc0678">
     <a name="606cb7f52fa224d54a2ee9b09e87f7de10cc0678">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalImg606cb7f52fa224d54a2ee9b09e87f7de10cc0678" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/606cb7f52fa224d54a2ee9b09e87f7de10cc0678.gif" style="max-width:100%"/>
       </div>
      </a>
     </div>
    </div>
    &gt;
    <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/c9268d76fb96fe9beed2b9bdc84d6fc48af3c2b8.gif" style="max-width:100%"/>
    ¢  então
    <i>
     x
    </i>
    <sub>
     <i>
      i
     </i>
     +1
    </sub>
    =
    <i>
     x
     <sub>
      novo
     </sub>
    </i>
    <p>
    </p>
    <p>
     senão
     <i>
      x
     </i>
     <sub>
      <i>
       i
      </i>
      +1
     </sub>
     =
     <i>
      x
      <sub>
       i
      </sub>
     </i>
     ;
    </p>
    <p>
    </p>
    <p>
     <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/c9268d76fb96fe9beed2b9bdc84d6fc48af3c2b8.gif" style="max-width:100%"/>
     ¢  é um novo número aleatório.
    </p>
    <p>
    </p>
    <p>
     4) Faça
     <i>
      i
     </i>
     =
     <i>
      i
     </i>
     + 1.
    </p>
    <p>
    </p>
    <p>
     5) Se
     <i>
      i
     </i>
     &lt;
     <i>
      M
     </i>
     vá para 2, (M é o número total de amostras).
    </p>
    <p>
    </p>
    <p>
     A nova configuração obtida a cada passo pode, eventualmente, ser igual à anterior. Novas configurações são calculadas e propostas no passo 2.   D  é um parâmetro que determina a amplitude do deslocamento da partícula. Seu valor é ajustado para que cerca de 50% das novas configurações sejam aceitas.
    </p>
    <p>
    </p>
    <p>
     No passo 3, temos os testes para aceitar ou não essa configuração. Se o sistema vai para uma nova configuração mais provável, ela é aceita. Mesmo que a probabilidade da nova configuração seja menor, ela ainda pode ser aceita, com uma probabilidade dada pelo número aleatório
     <img src="https://minio.scielo.br/documentstore/1806-9126/FfsdWkChMNX8TMTPVSfqVCc/c9268d76fb96fe9beed2b9bdc84d6fc48af3c2b8.gif" style="max-width:100%"/>
     ¢.
    </p>
    <p>
    </p>
    <p>
     Observa-se que a configuração inicial é arbitrária. Levando em conta esse fato, descartamos os primeiros passos para que o sistema se equilibre.
    </p>
    <p>
    </p>
    <p>
     <b>
      VI Implementação
     </b>
    </p>
    <p>
    </p>
    <p>
     Para realizar a simulação, escrevemos um programa que, a partir de uma configuração inicial arbitrária
     <i>
      x
     </i>
     <sub>
      0
     </sub>
     , com 0 &lt; x
     <sub>
      0
     </sub>
     &lt; 1, amostrava a distribuição de probabilidade dada pela Eq. (13) utilizando o algoritmo de Metropolis. Com as amostras obtidas, formamos as médias da energia
     <i>
      E
      <sub>
       T
      </sub>
     </i>
     , de acordo com a Eq. (15).
    </p>
    <p>
    </p>
    <p>
     O algoritmo de Metropolis introduz correlações entre as configurações amostradas. Isso é conseqÉência direta do passo 2 do algoritmo. Uma maneira óbvia de resolver esse problema é utilizar no cálculo da energia apenas uma amostragem a cada
     <i>
      K
     </i>
     posições obtidas. Por exemplo, com
     <i>
      K
     </i>
     = 200, formaríamos a média da energia apenas com a seqÉência
     <i>
      X
     </i>
     <sub>
      0
     </sub>
     ,
     <i>
      X
     </i>
     <sub>
      200
     </sub>
     ,
     <i>
      X
     </i>
     <sub>
      400
     </sub>
     , ....
    </p>
    <p>
    </p>
    <p>
     Com isso teríamos eliminado o problema de correlações. Uma maneira mais eficiente de tratar este problema envolve o que chamamos de média por blocos. Utilizamos um valor de
     <i>
      K
     </i>
     pequeno, obtendo uma seqüência
     <i>
      X
     </i>
     <sub>
      0
     </sub>
     ,
     <i>
      X
      <sub>
       K
      </sub>
     </i>
     ,
     <i>
      X
     </i>
     <sub>
      2
      <i>
       K
      </i>
     </sub>
     ,
     <i>
      X
     </i>
     <sub>
      3
      <i>
       K
      </i>
     </sub>
     , .... Calculamos as médias parciais das energias a cada grupo de
     <i>
      N
      <sub>
       E
      </sub>
     </i>
     dessas posições. Após obtermos as energias de
     <i>
      N
      <sub>
       b
      </sub>
     </i>
     blocos, fazemos a média final, com o desvio padrão referente a essa média com
     <i>
      N
      <sub>
       b
      </sub>
     </i>
     valores.
    </p>
    <p>
    </p>
    <p>
     Assim, por exemplo, para
     <i>
      K
     </i>
     = 5 e
     <i>
      N
      <sub>
       E
      </sub>
     </i>
     = 40, obtemos
     <i>
      X
     </i>
     <sub>
      0
     </sub>
     ,
     <i>
      X
     </i>
     <sub>
      5
     </sub>
     ,
     <i>
      X
     </i>
     <sub>
      10
     </sub>
     , .... E a cada 40 dessas posições, agrupamos numa média parcial
     <i>
      E
      <sub>
       b
      </sub>
     </i>
     . A média final
     <i>
      E
      <sub>
       T
      </sub>
     </i>
     e o seu erro padrão são calculados assumindo que cada energia de bloco (
     <i>
      E
      <sub>
       b
      </sub>
     </i>
     ) seja estatisticamente independente das demais.
    </p>
    <p>
    </p>
    <p>
     Esse procedimento resolve o problema de correlação entre as configurações amostradas, com maior eficiência no tempo de uso da máquina.
    </p>
    <p>
    </p>
    <p>
     <b>
      VII Resultados obtidos
     </b>
    </p>
    <p>
    </p>
    <p>
     O primeiro passo é escolher o valor do parâmetro   D, que controla a amplitude do movimento da partícula. Para determinarmos o melhor valor para o parâmetro, consideramos a fração de movimentos aceitos como medida, isto é, a razão entre o número de vezes em que uma nova configuração é aceita pelo número total de tentativas. Os resultados podem ser vistos na
     <a class="open-asset-modal" data-target="#ModalTabletab01" data-toggle="modal" href="">
      <span class="sci-ico-fileTable">
      </span>
      Tabela 1
     </a>
     .
    </p>
    <div class="row table" id="tab01">
     <a name="tab01">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalTabletab01" data-toggle="modal">
       <div class="thumbOff">
        Thumbnail
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <br/>
     </div>
    </div>
    <p>
    </p>
    <p>
     Observamos que quanto menor o valor de   D, maior é a fração de aceitação. Quando D é pequeno, a partícula se move muito pouco a cada passo. Para valores maiores de  D, a razão das probabilidades (passo 3 do algoritmo) pode ser pequena e, além disto, o algoritmo tenta mover a partícula para fora do intervalo com muita freqÉência, resultando em rejeitarmos a configuração proposta. Uma regra empírica sugere que a fração de aceitação ideal deve ser aproximadamente 0,5. Note que tanto para o maior como para o menor valor de D apresentados na tabela, os cálculos perdem muito de sua eficiência; nestas situações o número de amostras utilizado deixa de ser suficiente. Fato este, que se reflete no valor irrealista do erro padrão.
    </p>
    <p>
    </p>
    <p>
     Em seguida, realizamos a implementação de média por blocos. Mostramos na
     <a class="open-asset-modal" data-target="#ModalTabletab02" data-toggle="modal" href="">
      <span class="sci-ico-fileTable">
      </span>
      Tabela 2
     </a>
     alguns resultados. Esses testes foram realizados sempre com 2000 passos, que eram divididos igualmente num certo número de blocos. Cada um dos testes foi realizado usando-se a mesma sequência de configurações dos outros, de forma que obtivemos o mesmo valor de energia média em todos os casos. Assim, podemos ver mais diretamente a influência do número de blocos no valor do erro.
    </p>
    <div class="row table" id="tab02">
     <a name="tab02">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalTabletab02" data-toggle="modal">
       <div class="thumbOff">
        Thumbnail
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <br/>
     </div>
    </div>
    <p>
    </p>
    <p>
     Conforme esperávamos, os valores de desvio padrão apresentam um máximo em função do número de blocos (
     <i>
      N
      <sub>
       b
      </sub>
     </i>
     ). Como o número de passos total é sempre o mesmo, quanto maior for o número de blocos, menor será o número de passos por bloco (
     <i>
      N
      <sub>
       E
      </sub>
     </i>
     ). Por conseqüência, menor será a variância.
    </p>
    <p>
    </p>
    <p>
     De fato, estaremos tratando como avaliações independentes da energia resultados que, na realidade, não são independentes. Como já mencionamos, esta é uma decorrência do algoritmo de Metropolis. No outro extremo, a medida que diminuirmos excessivamente o número de blocos, a variância volta a diminuir.
    </p>
    <p>
    </p>
    <p>
     A escolha do número de blocos mais adequado nem sempre é fácil[4]. Neste problema, 10 a 20 blocos dão uma boa idéia do erro do valor calculado.
    </p>
    <p>
    </p>
    <p>
     <b>
      VIII Conclusão
     </b>
    </p>
    <p>
    </p>
    <p>
     Neste artigo, apresentamos o método variacional de Monte Carlo. Esse método é muito útil em simulações de sistemas físicos em computadores, pois a equação de Schrödinger desses sistemas muitas vezes não permitem soluções analíticas.
    </p>
    <p>
    </p>
    <p>
     De forma a exemplificar o uso desse método, utilizamos um modelo muito simples, que tem solução analítica fácil, de forma que podemos comparar o resultado obtido na simulação com a solução da equação de Schrödinger.
    </p>
    <p>
    </p>
    <p>
     Além da discussão teórica, também analisamos aspectos de implementação do método variacional de Monte Carlo. Exemplificamos o algoritmo de Metropolis como um dos possíveis algoritmos que fazem a amostragem de configurações neste problema. Analisamos o problema de correlação entre as configurações, e mostramos uma maneira de se resolver esse problema.
    </p>
    <p>
    </p>
    <p>
     Os resultados obtidos com a nossa função variacional são muito bons, quando comparados ao resultado exato da Eq. (7). O método variacional de Monte Carlo é de fácil implementação e fornece a energia variacional em excelente acordo com o resultado analítico. Este valor está sujeito apenas a incertezas de natureza estatística, as quais podem ser sistematicamente reduzidas pelo aumento do número de amostras.
    </p>
    <p>
    </p>
    <p>
     <b>
      Agradecimentos
     </b>
    </p>
    <p>
    </p>
    <p>
     Agradecemos ao Centro Nacional de Processamento de Alto Desempenho em São Paulo (CENAPAD-SP) na Unicamp pelo uso de suas facilidades de processamento em paralelo.
    </p>
    <p>
    </p>
    <p>
     Agradecemos também à Fundação de Amparo à Pesquisa no Estado de São Paulo (FAPESP) por financiar a pesquisa com bolsa de Iniciação Científica.
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
     Silvio A. Vitiello
    </p>
    <p>
    </p>
    <p>
     E-mail:
     <a href="mailto:vitiello@ifi.unicamp.br">
      vitiello@ifi.unicamp.br
     </a>
    </p>
    <p>
    </p>
    <p>
     Recebido em 9 de julho, 2001
    </p>
    <p>
    </p>
    <p>
     Manuscrito revisado recebido em 16 de dezembro, 2002
    </p>
    <p>
    </p>
    <p>
     Aceito em 13 de janeiro, 2003
    </p>
   </div>
   <div class="articleSection">
    <div class="ref-list">
     <ul class="refList">
      <li>
       <div>
        <b>
         Referęncias
        </b>
        [1] N. Metropolis
        <i>
         et al.
        </i>
        , J. Chem. Phys.
        <b>
         21
        </b>
        , 1087 (1953).
       </div>
      </li>
      <li>
       <div>
        [2] D. Griffiths, Introduction to Quantum    Mechanics, Prentice Hall, New Jersey, 1995.
       </div>
      </li>
      <li>
       <div>
        [3] G. Marsaglia e A. Zaman, Comp. Phys.
        <b>
         8
        </b>
        , 117 (1994).
       </div>
      </li>
      <li>
       <div>
        [4] M. P. Allen e D. J. Tildesley, Computer    Simulation of Liquids, Oxford, 1989.
       </div>
      </li>
     </ul>
    </div>
   </div>
   <li>
    <div>
     Endereço para correspondência
    </div>
    <div>
     Rodrigo Canabrava
    </div>
    <div>
     E-mail:
    </div>
    <div>
     <a href="mailto:rodrigo.canabrava@ic.unicamp.br">
      rodrigo.canabrava@ic.unicamp.br
     </a>
    </div>
   </li>
   <div class="articleSection" data-anchor="Datas de Publicação ">
    <h1 class="articleSectionTitle">
     Datas de Publicação
    </h1>
    <div class="row">
     <div class="col-md-12 col-sm-12">
      <ul class="articleTimeline">
       <li>
        <strong>
         Publicação nesta coleção
        </strong>
        <br/>
        20 Maio 2003
       </li>
       <li>
        <strong>
         Data do Fascículo
        </strong>
        <br/>
        2003
       </li>
      </ul>
     </div>
    </div>
   </div>
   <div class="articleSection" data-anchor="Histórico">
    <h1 class="articleSectionTitle">
     Histórico
    </h1>
    <div class="row">
     <div class="col-md-12 col-sm-12">
      <ul class="articleTimeline">
       <li>
        <strong>
         Revisado
        </strong>
        <br/>
        16 Dez 2002
       </li>
       <li>
        <strong>
         Recebido
        </strong>
        <br/>
        09 Jul 2001
       </li>
       <li>
        <strong>
         Aceito
        </strong>
        <br/>
        13 Jan 2003
       </li>
      </ul>
     </div>
    </div>
   </div>
   <section class="documentLicense">
    <div class="container-license">
     <div class="row">
      <div class="col-sm-3 col-md-2">
       <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" title="">
        <img alt="Creative Common - by-nc 4.0 " src="https://licensebuttons.net/l/by-nc/4.0//88x31.png"/>
       </a>
      </div>
      <div class="col-sm-9 col-md-10">
       <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" title="">
        This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.
       </a>
      </div>
     </div>
    </div>
   </section>
  </article>
 </div>
</div>