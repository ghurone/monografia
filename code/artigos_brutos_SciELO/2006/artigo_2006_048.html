<!DOCTYPE html>
<div class="articleTxt">
 <div class="articleBadge-editionMeta-doi-copyLink">
  <span class="_articleBadge">
   Notas e Discussões
  </span>
  <span class="_separator">
   •
  </span>
  <span class="_editionMeta">
   Rev. Bras. Ensino Fís. 28 
                (3)
   <span class="_separator">
    •
   </span>
   2006
  </span>
  <span class="_separator">
   •
  </span>
  <span class="group-doi">
   <a class="_doi" href="https://doi.org/10.1590/S1806-11172006000300017" target="_blank">
    https://doi.org/10.1590/S1806-11172006000300017
   </a>
   <a class="copyLink" data-clipboard-text="https://doi.org/10.1590/S1806-11172006000300017">
    <span class="sci-ico-link">
    </span>
    copiar
   </a>
  </span>
 </div>
 <h1 class="article-title">
  <span class="sci-ico-openAccess showTooltip" data-original-title="by-nc 4.0 " data-toggle="tooltip">
  </span>
  Polinômio dos quadrados mínimos condicionado
  <a class="short-link" href="#" id="shorten">
   <span class="sci-ico-link">
   </span>
  </a>
 </h1>
 <h2 class="article-title">
  The constrained least squares polynomial
 </h2>
 <div class="articleMeta">
 </div>
 <div class="contribGroup">
  <span class="dropdown">
   <a class="dropdown-toggle" data-toggle="dropdown" id="contribGroupTutor1">
    <span>
     Oclide J. Dotto
    </span>
   </a>
   <ul aria-labelledby="contribGrupoTutor1" class="dropdown-menu" role="menu">
    <strong>
    </strong>
    ,  Caxias do Sul,  
          ,  
        ,  Universidade de Caxias do Sul,  Departamento de Matemática e Estatística ,  Brazil
   </ul>
  </span>
  <span class="dropdown">
   <a class="dropdown-toggle" data-toggle="dropdown" id="contribGroupTutor2">
    <span>
     Adalberto A. Dornelles Filho
    </span>
   </a>
   <ul aria-labelledby="contribGrupoTutor2" class="dropdown-menu" role="menu">
    <strong>
    </strong>
    ,  Caxias do Sul,  
          ,  
        ,  Universidade de Caxias do Sul,  Departamento de Matemática e Estatística ,  Brazil
   </ul>
  </span>
  <a class="outlineFadeLink" data-target="#ModalTutors" data-toggle="modal" href="">
   Sobre os autores
  </a>
 </div>
 <div class="row">
  <ul class="col-md-2 hidden-sm articleMenu">
  </ul>
  <article class="col-md-10 col-md-offset-2 col-sm-12 col-sm-offset-0" id="articleText">
   <div class="articleSection" data-anchor="Resumos">
    <h1 class="articleSectionTitle">
     Resumos
    </h1>
   </div>
   <div>
    <p>
     O ajustamento polinomial a dados experimentais pelo método de quadrados mínimos é muito usado, e aqui estudamos a introdução de uma simples modificação, que, em certos casos, é mais adequada, isto é, condicionamos o polinômio a conter um dado ponto. Incluímos uma implementação do correspondente algoritmo em MATLAB.
    </p>
    <p>
     ajustamento; quadrados mínimos; condicionamento
    </p>
   </div>
   <hr/>
   <div>
    <p>
     Since the least-squares polynomial fit is used very often, we study here a simple modification that is more suitable for some cases, that is, we constrain the polynomial to pass through a given point, besides satisfying the least-squares property. We include an implementation of the corresponding algorithm in MATLAB.
    </p>
    <p>
     data fitting; least squares; constraint
    </p>
   </div>
   <hr/>
   <div class="articleSection" data-anchor="Text">
    <p>
    </p>
    <p>
     <b>
      NOTAS E DISCUSSÃO
     </b>
    </p>
    <p>
    </p>
    <p>
     Polinômio dos quadrados mínimos condicionado
    </p>
    <p>
    </p>
    <p>
     <b>
      The constrained least squares polynomial
     </b>
    </p>
    <p>
    </p>
    <p>
     Oclide J. Dotto
     <span class="ref footnote">
      <sup class="xref">
       <b>
        1
       </b>
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        <strong class="fn-title">
         1
        </strong>
        E-mail: 
        ojdotto@ucs.br.
       </span>
      </span>
     </span>
     ; Adalberto A. Dornelles Filho
    </p>
    <p>
    </p>
    <p>
     Departamento de Matemática e Estatística, Universidade de Caxias do Sul, Caxias do Sul, RS, Brasil
    </p>
    <p>
    </p>
    <p>
     <b>
      RESUMO
     </b>
    </p>
    <p>
    </p>
    <p>
     O ajustamento polinomial a dados experimentais pelo método de quadrados mínimos é muito usado, e aqui estudamos a introdução de uma simples modificação, que, em certos casos, é mais adequada, isto é, condicionamos o polinômio a conter um dado ponto. Incluímos uma implementação do correspondente algoritmo em MATLAB.
    </p>
    <p>
    </p>
    <p>
     <b>
      Palavras-chave:
     </b>
     ajustamento, quadrados mínimos, condicionamento.
    </p>
    <p>
    </p>
    <p>
     <b>
      ABSTRACT
     </b>
    </p>
    <p>
    </p>
    <p>
     Since the least-squares polynomial fit is used very often, we study here a simple modification that is more suitable for some cases, that is, we constrain the polynomial to pass through a given point, besides satisfying the least-squares property. We include an implementation of the corresponding algorithm in MATLAB.
    </p>
    <p>
    </p>
    <p>
     <b>
      Keywords:
     </b>
     data fitting, least squares, constraint.
    </p>
    <p>
    </p>
    <p>
     <b>
      1. Introdução
     </b>
    </p>
    <p>
    </p>
    <p>
     É popular o ajustamento polinomial discreto dos quadrados mínimos (q. m.). Para evocar o processo desse ajustamento, consideremos os dados da
     <a class="open-asset-modal" data-target="#ModalTabletab01" data-toggle="modal" href="">
      <span class="sci-ico-fileTable">
      </span>
      Tabela 1
     </a>
     , onde a primeira linha forma uma seqüência finita crescente.
    </p>
    <div class="row table" id="tab01">
     <a name="tab01">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalTabletab01" data-toggle="modal">
       <div class="thumbOff">
        Thumbnail
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <br/>
     </div>
    </div>
    <p>
    </p>
    <p>
     Suponhamos que queiramos ajustar a esses dados o polinômio
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm01">
     <a name="frm01">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/584d66855be6167ed38ca7b2b3bc7af1f14b1fdc.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     de ordem
     <i>
      k
     </i>
     &lt;
     <i>
      n
     </i>
     dos q. m. A melhor maneira de obter a solução é o uso da álgebra linear como segue. Começamos gerando a matriz de planejamento (
     <i>
      design matrix
     </i>
     [1])
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm02">
     <a name="frm02">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/833f97b14dfbedf20a3496a5654a86afa401e3a8.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     de ordem (
     <i>
      n
     </i>
     +1)×(
     <i>
      k
     </i>
     +1), determinada pelo vetor
     <b>
      x
     </b>
     = [
     <i>
      x
     </i>
     <sub>
      0
     </sub>
     <i>
      x
     </i>
     <sub>
      1
     </sub>
     ...
     <i>
      x
      <sub>
       n
      </sub>
     </i>
     ]
     <sup>
      <i>
       t
      </i>
     </sup>
     . A solução única (porque
     <b>
      X
     </b>
     é não-singular) da equação normal
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm03">
     <a name="frm03">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/d3f3e5f439339f542f2e08516579a546436411ad.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     é o vetor
     <b>
      a
     </b>
     dos coeficientes do polinômio dos q. m. (1).
    </p>
    <p>
    </p>
    <p>
     Do ponto de vista dos métodos de resolução numérica de (3), o uso da matriz de planejamento pode levar a imprecisões uma vez que
     <b>
      X
     </b>
     se torna mal-condicionada quando sua ordem é alta. No entanto, isso não é relevante na maioria dos casos práticos, onde dificilmente a ordem do polinômio ajustado é maior que 3.
    </p>
    <p>
    </p>
    <p>
     O desenvolvimento mais completo da teoria e solução numérica dos quadrados mínimos foi feita por Åke Björck em [2], mas pode ser encontrado em muitos bons livros de álgebra linear, como [3, 4, 5]. Uma introdução rápida sobre a solução dos q. m. encontra-se em [6].
    </p>
    <p>
    </p>
    <p>
     Façamos aqui uma pequena digressão útil. Na estimativa da solução
     <b>
      Xa
     </b>
     =
     <b>
      y
     </b>
     mediante o método dos q. m., é conveniente às vezes ponderar essa estimativa, isto é, usar e
     <i>
      equação normal ponderada
     </i>
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm04">
     <a name="frm04">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/54cbd68455117709c0c4684b379227186fc76e0e.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     em vez da equação normal ordinária (3), escolhendo, para matriz de ponderação
     <b>
      W
     </b>
     , uma conveniente matriz simétrica definida positiva, que minimize o vetor residual
     <b>
      r
     </b>
     : =
     <b>
      Xa
     </b>
     -
     <b>
      y
     </b>
     no sentido dos q. m. associados ao produto interno definido por
     <b>
      W
     </b>
     , o que significa simplesmente minimizar
     <b>
      r
     </b>
     <sup>
      <i>
       t
      </i>
     </sup>
     <b>
      Wr
     </b>
     . É conhecido [7] que a escolha
     <i>
      ótima
     </i>
     é a inversa da matriz
     <b>
      V
     </b>
     = [
     <i>
      v
      <sub>
       ij
      </sub>
     </i>
     ] das variâncias-covariâncias dos vetores aleatórios das observações,
     <b>
      y
     </b>
     <sub>
      <i>
       i
      </i>
     </sub>
     = [
     <i>
      y
     </i>
     <sub>
      1
      <i>
       i
      </i>
     </sub>
     <i>
      y
     </i>
     <sub>
      2
      <i>
       i
      </i>
     </sub>
     ...
     <i>
      y
      <sub>
       mi
      </sub>
     </i>
     ]
     <sup>
      <i>
       t
      </i>
     </sup>
     ,
     <i>
      i
     </i>
     = 0, 1, ...,
     <i>
      n
     </i>
     , isto é,
     <b>
      W
     </b>
     =
     <b>
      V
     </b>
     <sup>
      -1
     </sup>
     (cf. também [2, 8]). Ainda, caso os desvios possam ser supostos não-correlacionados, todas as covariâncias são nulas e
     <b>
      V
     </b>
     se reduz a uma matriz diagonal, cujos elementos diagonais são as variâncias, que medem a dispersão dos desvios em torno da média, e, nesse caso, para inverter
     <b>
      V
     </b>
     , basta inverter esses elementos diagonais (que são não-nulos). O efeito do uso de
     <b>
      V
     </b>
     <sup>
      -1
     </sup>
     para ponderação é terem menor peso os desvios maiores.
    </p>
    <p>
    </p>
    <p>
     Voltemos agora ao assunto central do artigo. A curva que representa geometricamente o polinômio dos q. m. não passa pelos pontos definidos pelos dados na
     <a class="open-asset-modal" data-target="#ModalTabletab01" data-toggle="modal" href="">
      <span class="sci-ico-fileTable">
      </span>
      Tabela 1
     </a>
     , a não ser que coincida com a do polinômio de interpolação, o que ocorre quando
     <i>
      k = n
     </i>
     . No entanto, em certos casos, pela natureza do problema, sabemos de antemão que deve passar por determinado ponto, mesmo que esse ponto não figure entre os dados.
    </p>
    <p>
    </p>
    <p>
     A um polinômio dos q. m., forçado a passar por um ponto
     <i>
      P
     </i>
     <sub>
      0
     </sub>
     escolhido previamente, chamamos de
     <i>
      polinômio dos q. m. condicionado
     </i>
     , ou polinômio dos q. m. ancorado no ponto P
     <sub>
      0
     </sub>
     .
    </p>
    <p>
    </p>
    <p>
     <b>
      2. Reta dos quadrados mínimos ancorada na origem
     </b>
    </p>
    <p>
    </p>
    <p>
     A lei de Hooke estabelece que, quando uma força
     <i>
      F
     </i>
     é aplicada a uma mola homogênea, o alongamento
     <i>
      x
     </i>
     da mola varia linearmente com essa força, dentro de limites, isto é,
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm05">
     <a name="frm05">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/177d0a41e624c1dc1db3df7345fed9867a4b594b.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     onde
     <i>
      a
     </i>
     é dita a constante de Hooke da mola. Para determinar
     <i>
      a
     </i>
     , executamos experimentos que fornecem uma tabela de duas linhas com os valores de
     <i>
      F
     </i>
     dados e os valores de
     <i>
      x
     </i>
     resultantes. Em seguida ajustamos a reta dos q. m. aos dados e a declividade dessa reta é uma estimativa da constante de Hooke da mola. Essa reta quase certamente não passa pela origem, mesmo que a origem se inclua nos dados. No entanto, idealmente, deveria passar pela origem, pois o alongamento é nulo para uma força aplicada nula.
    </p>
    <p>
    </p>
    <p>
     Para forçar a reta dos q. m. a passar pela origem, basta achar a solução dos q. m. do sistema linear
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm06">
     <a name="frm06">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/b18d0197e55f60341773ad3d131d0a0a90429df0.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     Uma relação de proporcionalidade direta entre duas grandezas, como em (5), ocorre com freqüência. Outros exemplos são: a intensidade
     <i>
      i
     </i>
     e a tensão
     <i>
      v
     </i>
     de uma corrente elétrica aplicada a um resistor, a força
     <i>
      F
     </i>
     e aceleração resultante
     <i>
      a
     </i>
     aplicada a um móvel, etc.
    </p>
    <p>
    </p>
    <p>
     <b>
      Exemplo 1
     </b>
    </p>
    <p>
    </p>
    <p>
     Vejamos um caso específico. A
     <a class="open-asset-modal" data-target="#ModalTabletab02" data-toggle="modal" href="">
      <span class="sci-ico-fileTable">
      </span>
      Tabela 2
     </a>
     mostra os valores do alongamento
     <i>
      x
     </i>
     (em centímetros) de uma mola
     <i>
      vs
     </i>
     . força de tração
     <i>
      F
     </i>
     (em Newtons) aplicada, ambos em módulo.
    </p>
    <div class="row table" id="tab02">
     <a name="tab02">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalTabletab02" data-toggle="modal">
       <div class="thumbOff">
        Thumbnail
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <br/>
     </div>
    </div>
    <p>
    </p>
    <p>
     Aqui a reta dos q. m. tem por equação
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm07">
     <a name="frm07">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/d67dd67b53806faf46c9b3f22f7fa2260f19be42.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     e a reta dos q. m. ancorada na origem
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm08">
     <a name="frm08">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/55432e7890779fe8ffccc0c958e2db4f48eab48c.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     A
     <a class="open-asset-modal" data-target="#ModalFigfig01" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      Fig. 1
     </a>
     mostra ambas as retas. A primeira não contém a origem. Vemos que as declividades, em unidades coerentes, não coincidem, embora sejam próximas, e é razoável dizer que o valor
     <i>
      a
     </i>
     = 0,76 é uma estimativa melhor que
     <i>
      a
     </i>
     = 0,78 para a constante da mola.
    </p>
    <div class="row fig" id="fig01">
     <a name="fig01">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigfig01" data-toggle="modal" href="">
       <div class="thumbOff">
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <br/>
     </div>
    </div>
    <p>
    </p>
    <p>
     Para a reta dos q. m. ancorada na origem, a equação matricial (3) pode ser reescrita como
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm09">
     <a name="frm09">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/f28780c5d44c9d54900ac6543b296f29488a8065.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     De (9) deduzimos que
     <i>
      a
     </i>
     declividade a dessa reta é dada por
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm10">
     <a name="frm10">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/ed0d94de028751738f809daeda21e172911eb0c1.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     Em laboratórios de ensino, em vez da fórmula (10), é usada comumente a fórmula
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm11">
     <a name="frm11">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/caad1281b589f8d92561f7bd413ed668db639ebe.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     que expressa a média aritmética
     <i>
      a
     </i>
     das declividades
     <i>
      y
      <sub>
       i
      </sub>
      /x
      <sub>
       i
      </sub>
     </i>
     das retas, cada uma das quais contendo a origem e um ponto (
     <i>
      x
      <sub>
       i
      </sub>
      ,y
      <sub>
       i
      </sub>
     </i>
     ). A expressão (11) é bastante intuitiva e produz um resultado levemente diferente (
     <i>
      a
     </i>
     = 0,73, no caso) e, por outro lado, parece não ter nenhuma relação com (10). De fato, elas não são equivalentes. Mas é interessante observar o que segue.
    </p>
    <p>
    </p>
    <p>
     Primeiro, adotando a equação normal ponderada (4) e a inversa
     <b>
      V
     </b>
     <sup>
      -1
     </sup>
     da matriz das variâncias-covariâncias para matriz de ponderação, a fórmula (9) passa a escrever-se
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm12">
     <a name="frm12">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/3a1a70230c5a59b42df7f2ba23a6bb98d80f1ecd.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     Segundo, suponhamos que, para cada
     <i>
      i
     </i>
     Î {0, 1, 2, ...,
     <i>
      n
     </i>
     }, tenhamos feito um conjunto de
     <i>
      m
     </i>
     observações
     <i>
      y
     </i>
     <sub>
      1
      <i>
       i
      </i>
     </sub>
     <i>
      , y
     </i>
     <sub>
      2
      <i>
       i
      </i>
     </sub>
     <i>
      , ..., y
      <sub>
       mi
      </sub>
     </i>
     ; então podemos falar da matriz das variâncias-covariâncias dos vetores aleatórios dessas observações,
     <b>
      y
     </b>
     <sub>
      <i>
       i
      </i>
     </sub>
     = [
     <i>
      y
     </i>
     <sub>
      1
      <i>
       i
      </i>
     </sub>
     <i>
      y
     </i>
     <sub>
      2
      <i>
       i
      </i>
     </sub>
     <i>
      ... y
      <sub>
       mi
      </sub>
     </i>
     ]
     <sup>
      <i>
       t
      </i>
     </sup>
     <i>
      , i
     </i>
     = 0, 1, 2, ...,
     <i>
      n
     </i>
     . Usando a fórmula normal (12), ponderada pela inversa da matriz
     <b>
      V
     </b>
     = [
     <i>
      v
      <sub>
       ij
      </sub>
     </i>
     ] das variâncias-covariâncias, ou ponderando as declividades
     <i>
      y
      <sub>
       i
      </sub>
      /x
      <sub>
       i
      </sub>
     </i>
     em (11) pelos inversos das correspondentes variâncias dessas declividades (ao invés de tomar a média aritmética), obtemos por ambos os caminhos a fórmula
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm13">
     <a name="frm13">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/666bacf6b6f6420d9cd08882a42e3bc1280e96d2.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     onde pusemos
     <i>
      v
      <sub>
       i
      </sub>
     </i>
     : =
     <i>
      v
      <sub>
       ii
      </sub>
     </i>
     (variâncias) e admitimos
     <i>
      v
      <sub>
       ij
      </sub>
     </i>
     = 0, se
     <i>
      i ¹ j
     </i>
     (covariâncias nulas). Com relação a ponderação em (13), lembramos que, por uma propriedade da variância, temos:
    </p>
    <p>
    </p>
    <p>
     var
     <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/3c9f1013d05f9bec107fd5fa1533f494a8bb7237.gif" style="max-width:100%"/>
     ,
    </p>
    <p>
    </p>
    <p>
     e o denominador principal em (13) é a soma dos inversos dessas variâncias.
    </p>
    <p>
    </p>
    <p>
     Notamos que a fórmula (10) é recuperada de (13) supondo
     <i>
      v
     </i>
     <sub>
      0
     </sub>
     =
     <i>
      v
     </i>
     <sub>
      1
     </sub>
     = ... =
     <i>
      v
      <sub>
       n
      </sub>
     </i>
     , e, com uma simplificação maior, que a fórmula (11) segue de (13), usando as correspondentes variâncias do vetor das declividades
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm14">
     <a name="frm14">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/c53e7a601c664eda4ab659a889a461206e89155e.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     todas iguais a 1/(
     <i>
      n
     </i>
     +1), isto é, para
     <i>
      i
     </i>
     = 0, 1, 2 ...,
     <i>
      n
     </i>
     . Isso explica porque as fórmulas (10) e (11) não são equivalentes.
    </p>
    <p>
    </p>
    <p>
     <b>
      3. Polinômio dos quadrados mínimos condicionado
     </b>
    </p>
    <p>
    </p>
    <p>
     Em vez de ancorar na origem a reta dos q. m., podemos ancorá-la num ponto qualquer. Mas tratemos do caso geral: mostremos como ancorar o polinômio de ordem
     <i>
      k
     </i>
     dos q. m. num ponto escolhido (
     <i>
      x
     </i>
     <sub>
      0
     </sub>
     ,
     <i>
      y
     </i>
     <sub>
      0
     </sub>
     ). O procedimento é feito em três etapas:
    </p>
    <div>
     <blockquote>
      <p>
       1. operamos uma translação de eixos de maneira que a nova origem seja o ponto (
       <i>
        x
       </i>
       <sub>
        0
       </sub>
       ,
       <i>
        y
       </i>
       <sub>
        0
       </sub>
       ); para isso basta subtrair
       <i>
        x
       </i>
       <sub>
        0
       </sub>
       das abscissas e
       <i>
        y
       </i>
       <sub>
        0
       </sub>
       das ordenadas dos dados;
      </p>
      <p>
       2. ajustamos aos dados transformados o polinômio
       <i>
        q
       </i>
       dos q. m. ancorado na origem, como no Exemplo 1;
      </p>
      <p>
       3. fazemos, por último, a transformação inversa da executada na etapa 1, obtendo o polinômio final dos q. m.,
       <i>
        p
       </i>
       (
       <i>
        x
       </i>
       ) =
       <i>
        q
       </i>
       (
       <i>
        x - x
       </i>
       <sub>
        0
       </sub>
       ), ancorado em (
       <i>
        x
       </i>
       <sub>
        0
       </sub>
       ,
       <i>
        y
       </i>
       <sub>
        0
       </sub>
       ).
      </p>
     </blockquote>
    </div>
    <p>
    </p>
    <p>
     Suponhamos que os dados na
     <a class="open-asset-modal" data-target="#ModalTabletab01" data-toggle="modal" href="">
      <span class="sci-ico-fileTable">
      </span>
      Tabela 1
     </a>
     já tenham sofrido a alteração descrita na etapa 1. Para operacionalizar a etapa 2, suprimimos a última coluna da matriz de planejamento (2), obtendo uma matriz que indicaremos com
     <b>
      U
     </b>
     , e achamos a solução a dos q. m. do sistema linear
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm15">
     <a name="frm15">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/af271928f852f328607fc3db3115e49198ac7190.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     O vetor-solução
     <b>
      a
     </b>
     será formado pelos coeficientes do polinômio
     <i>
      q
     </i>
     ancorado na origem, descrito na etapa 2. Para o caso de uma reta, a equação matricial (15) torna-se uma equação escalar, da forma (9), onde
     <b>
      x
     </b>
     e
     <b>
      y
     </b>
     são os vetores dos dados.
    </p>
    <p>
    </p>
    <p>
     No
     <span class="ref footnote">
      <sup class="xref">
       apêndice
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        apêndice
       </span>
      </span>
     </span>
     implementamos esse algoritmo em MATLAB, com o nome polqmcond. O programa produz também a correspondente visualização geométrica.
    </p>
    <p>
    </p>
    <p>
     <b>
      Exemplo 2
     </b>
    </p>
    <p>
    </p>
    <p>
     Consideremos a integral elíptica completa
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm16">
     <a name="frm16">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/3d8c1f934d9dea6ca6f53c7a6500be2da028ae28.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     Mediante integração numérica, obtemos os valores de
     <i>
      E
     </i>
     (
     <i>
      x
     </i>
     ) (com
     <i>
      x
     </i>
     dado em graus) e construímos a
     <a class="open-asset-modal" data-target="#ModalTabletab03" data-toggle="modal" href="">
      <span class="sci-ico-fileTable">
      </span>
      Tabela 3
     </a>
     .
    </p>
    <div class="row table" id="tab03">
     <a name="tab03">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalTabletab03" data-toggle="modal">
       <div class="thumbOff">
        Thumbnail
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <br/>
     </div>
    </div>
    <p>
    </p>
    <p>
     Se olharmos para a distribuição desses dados, veremos que um ajustamento parabólico é adequado. Além disso, é óbvio que
     <i>
      E
     </i>
     (0) = p/2. Então é indicado ancorar a parábola dos q. m. no ponto (0, p/2). Utilizando o programa polqmcond, obtemos essa parábola
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm17">
     <a name="frm17">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/e8686864a764586ae48e38d1ad972ff42121cbb4.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     A parábola ''livre'' dos q. m. é dada por
    </p>
    <p>
    </p>
    <p>
    </p>
    <div class="row formula" id="efrm18">
     <a name="frm18">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/ddbac7ece271644d91430cc62c4a012ef888225f.gif" style="max-width:100%"/>
      </div>
     </div>
    </div>
    <p>
    </p>
    <p>
     A
     <a class="open-asset-modal" data-target="#ModalFigfig02" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      Fig. 2
     </a>
     exibe ambas as parábolas. Visualmente elas se superpõem em quase todo o trajeto.
    </p>
    <div class="row fig" id="fig02">
     <a name="fig02">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigfig02" data-toggle="modal" href="">
       <div class="thumbOff">
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <br/>
     </div>
    </div>
    <p>
    </p>
    <p>
     Para compararmos os dois ajustamentos, os testamos nos pontos
     <i>
      x
     </i>
     = 2, 12, 17, 27. Obtivemos a
     <a class="open-asset-modal" data-target="#ModalTabletab04" data-toggle="modal" href="">
      <span class="sci-ico-fileTable">
      </span>
      Tabela 4
     </a>
     na qual a segunda linha contém os valores de
     <i>
      E
     </i>
     (
     <i>
      x
     </i>
     ) obtidos por integração numérica aqui considerados exatos, a terceira linha os valores de
     <i>
      P
     </i>
     (
     <i>
      x
     </i>
     ) do ajustamento dos q. m. ancorado, e a quarta linha os valores de
     <i>
      Q
     </i>
     (
     <i>
      x
     </i>
     ) do ajustamento livre.
    </p>
    <div class="row table" id="tab04">
     <a name="tab04">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalTabletab04" data-toggle="modal">
       <div class="thumbOff">
        Thumbnail
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <br/>
     </div>
    </div>
    <p>
    </p>
    <p>
     Vemos que, nesse exemplo, o ajustamento ancorado é melhor para os pontos próximos ao ponto ancorador, como era esperado, e longe dele os ajustamentos tendem a ser equivalentes. Claramente, para um ajustamento linear, por exemplo, a situação longe da âncora é outra, como mostra a
     <a class="open-asset-modal" data-target="#ModalFigfig01" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      Fig. 1
     </a>
     .
    </p>
    <p>
    </p>
    <p>
     <b>
      4. Comentários finais
     </b>
    </p>
    <p>
    </p>
    <p>
     Nos laboratórios de ensino, é bastante comum realizar experimentos para obter o coeficiente de proporcionalidade entre duas grandezas diretamente proporcionais. Se for usado o recurso do ajuste linear dos q. m., disponível em algumas calculadoras científicas, dificilmente obteremos uma reta que passe exatamente pela origem. Uma elegante solução para essa dificuldade é usar a fórmula (10) que decorre do ajustamento dos q. m. ancorado na origem.
    </p>
    <p>
    </p>
    <p>
     Mais geral, mostramos que é possível e relativamente fácil, ao ajustarmos um polinômio dos quadrados mínimos, condicioná-lo a conter um ponto de interesse. Poder-se-ia tentar desenvolver um algoritmo que o condicione a conter mais de um ponto, contanto que ainda retenha um número de graus de liberdade suficientemente elevado. Por exemplo, um caso extremo oposto é condicionar uma reta dos q. m. a conter dois pontos, o que corresponde a ela ficar com zero graus de liberdade e equivale ao problema trivial de achar a equação da reta que passa por esses dois pontos. Não temos certeza se há interesse prático nessa generalização de ancoragem. De qualquer maneira, parece-nos que o caso interessante, exeqüível e útil, é a ancoragem em um ponto apenas.
    </p>
    <p>
    </p>
    <p>
     <b>
      Agradecimento
     </b>
    </p>
    <p>
    </p>
    <p>
     Os autores agradecem ao parecerista a gentil apreciação do artigo, assim como as sugestões.
    </p>
    <p>
    </p>
    <p>
     Recebido em 20/2/2006; Revisado em 15/5/2006; Aceito em 29/5/2006
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
   </div>
   <div class="articleSection">
    <div class="ref-list">
     <ul class="refList">
      <li>
       <div>
        [1] Richard A. Johnson and Dean W. Wichern,
        <i>
         Applied    Multivariate Analysis
        </i>
        (Prentice Hall, Nova York, 2002)
       </div>
      </li>
      <li>
       <div>
        [2] Ĺke Björck,
        <i>
         Numerical Methods for Least    Squares Problems
        </i>
        (SIAM, Philadelphia, 1966).
       </div>
      </li>
      <li>
       <div>
        [3] James W. Demmel,
        <i>
         Applied Numerical Linear    Algebra
        </i>
        (SIAM, Philadelphia, 1997).
       </div>
      </li>
      <li>
       <div>
        [4] Gene H. Golub and Charles F. Van Loan,
        <i>
         Matrix    Computations
        </i>
        (The John Hopkins University Press, London, 1996).
       </div>
      </li>
      <li>
       <div>
        [5] Lloyd N. Trefethen and David Bau III,
        <i>
         Numerical    Linear Algebra
        </i>
        (SIAM, Philadelphia, 1997).
       </div>
      </li>
      <li>
       <div>
        [6] Mário Barone Júnior,
        <i>
         Álgebra Linear
        </i>
        (IME-USP, Săo Paulo, 2005), 3Ş ed.
       </div>
      </li>
      <li>
       <div>
        [7] Gilbert Strang and Kay Borre,
        <i>
         Linear    Algebra, Geodesy and GPS
        </i>
        (Wellesley-Cambridge Press, Wellesley, 1997).
       </div>
      </li>
      <li>
       <div>
        [8] José Henrique Vuolo,
        <i>
         Fundamentos da Teoria    de Erros
        </i>
        (Ed. Edgard Blücher Ltda., Săo Paulo, 2005), 2Ş ed.
       </div>
      </li>
     </ul>
    </div>
   </div>
   <div class="articleSection" data-anchor="apêndice">
    <h1 class="articleSectionTitle">
     apêndice
    </h1>
    <img src="https://minio.scielo.br/documentstore/1806-9126/kdJTs4xk85B7s4QCLL8Fwwy/672d2d0524c17706f5860950dc9dd31543977e44.gif" style="max-width:100%"/>
   </div>
   <li>
    <span class="xref big">
     1
    </span>
    <div>
     E-mail:
    </div>
    <div>
     <a href="mailto:ojdotto@ucs.br">
      ojdotto@ucs.br
     </a>
     .
    </div>
   </li>
   <div class="articleSection" data-anchor="Datas de Publicação ">
    <h1 class="articleSectionTitle">
     Datas de Publicação
    </h1>
    <div class="row">
     <div class="col-md-12 col-sm-12">
      <ul class="articleTimeline">
       <li>
        <strong>
         Publicação nesta coleção
        </strong>
        <br/>
        06 Nov 2006
       </li>
       <li>
        <strong>
         Data do Fascículo
        </strong>
        <br/>
        2006
       </li>
      </ul>
     </div>
    </div>
   </div>
   <div class="articleSection" data-anchor="Histórico">
    <h1 class="articleSectionTitle">
     Histórico
    </h1>
    <div class="row">
     <div class="col-md-12 col-sm-12">
      <ul class="articleTimeline">
       <li>
        <strong>
         Aceito
        </strong>
        <br/>
        29 Maio 2006
       </li>
       <li>
        <strong>
         Revisado
        </strong>
        <br/>
        15 Maio 2006
       </li>
       <li>
        <strong>
         Recebido
        </strong>
        <br/>
        20 Fev 2006
       </li>
      </ul>
     </div>
    </div>
   </div>
   <section class="documentLicense">
    <div class="container-license">
     <div class="row">
      <div class="col-sm-3 col-md-2">
       <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" title="">
        <img alt="Creative Common - by-nc 4.0 " src="https://licensebuttons.net/l/by-nc/4.0//88x31.png"/>
       </a>
      </div>
      <div class="col-sm-9 col-md-10">
       <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" title="">
        This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.
       </a>
      </div>
     </div>
    </div>
   </section>
  </article>
 </div>
</div>