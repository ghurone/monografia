<!DOCTYPE html>
<div class="articleTxt">
 <div class="articleBadge-editionMeta-doi-copyLink">
  <span class="_articleBadge">
   Artigos Gerais
  </span>
  <span class="_separator">
   •
  </span>
  <span class="_editionMeta">
   Rev. Bras. Ensino Fís. 43
   <span class="_separator">
    •
   </span>
   2021
  </span>
  <span class="_separator">
   •
  </span>
  <span class="group-doi">
   <a class="_doi" href="https://doi.org/10.1590/1806-9126-RBEF-2021-0204" target="_blank">
    https://doi.org/10.1590/1806-9126-RBEF-2021-0204
   </a>
   <a class="copyLink" data-clipboard-text="https://doi.org/10.1590/1806-9126-RBEF-2021-0204">
    <span class="sci-ico-link">
    </span>
    copiar
   </a>
  </span>
 </div>
 <h1 class="article-title">
  <span class="sci-ico-openAccess showTooltip" data-original-title="by 4.0 deed.en" data-toggle="tooltip">
  </span>
  Propagação de ondas aplicadas ao mapeamento geológico: formulação acústica
  <a class="short-link" href="#" id="shorten">
   <span class="sci-ico-link">
   </span>
  </a>
 </h1>
 <h2 class="article-title">
  Wave propagation applied to geologic imaging: acoustics
 </h2>
 <div class="articleMeta">
 </div>
 <div class="contribGroup">
  <span class="dropdown">
   <a class="dropdown-toggle" data-toggle="dropdown" id="contribGroupTutor1">
    <span>
     Leandro Di Bartolo
    </span>
   </a>
   <ul aria-labelledby="contribGrupoTutor1" class="dropdown-menu" role="menu">
    <strong>
    </strong>
    <div class="corresp">
     * Endereço de correspondência:
     <a href="mailto:dibartolo@on.br">
      dibartolo@on.br
     </a>
    </div>
    Observatorio Nacional, Rio de Janeiro, RJ, Brasil.
    <a class="btnContribLinks orcid" href="http://orcid.org/0000-0002-0168-1579">
     http://orcid.org/0000-0002-0168-1579
    </a>
   </ul>
  </span>
  <a class="outlineFadeLink" data-target="#ModalTutors" data-toggle="modal" href="">
   Sobre o autor
  </a>
 </div>
 <div class="row">
  <ul class="col-md-2 hidden-sm articleMenu">
  </ul>
  <article class="col-md-10 col-md-offset-2 col-sm-12 col-sm-offset-0" id="articleText">
   <div class="articleSection" data-anchor="Resumos">
    <h1 class="articleSectionTitle">
     Resumos
    </h1>
   </div>
   <div>
    <p>
     O conceito de onda é recorrente nas ciências pura e aplicada, servindo de base para compreender desde terremotos, passando pelas telecomunicações e eletromagnetismo, até a difração de nêutrons, e.g., para citar um caso quântico. Assim, tal conceito desempenha um papel central em ramos tão diversos como Geofísica e Física Quântica, bem como em suas aplicações. A equação da onda é comumente estudada nos cursos de Física eminentemente utilizando soluções analíticas, não sendo possível obter respostas em domínios complexos e portanto estudar diversas aplicações. Este artigo objetiva apresentar detalhadamente, de forma simples e acessível, ricamente ilustrada, as ferramentas necessárias para obter soluções numéricas da equação da onda, dentro do escopo da Sismologia Aplicada, visando utilizá-las como base para um algoritmo de geração de imagens de estruturas geológicas em bacias sedimentares. Esta é uma bonita aplicação da Física, constituindo-se na base da exploração de hidrocarbonetos. A aplicação aqui descrita, conhecida na literatura especializada como Migração Reversa no Tempo, é aplicada a um modelo sintético, porém realístico. Os resultados demonstram a excelente qualidade da imagem obtida, sendo a técnica aplicada o estado da arte em termos de método de migração (mapeamento sísmico), atualmente muito em voga e utilizada pela indústria no pré-sal.
    </p>
    <p>
     <strong>
      Palavras-chave
     </strong>
     <br/>
     ondas acústicas; Métodos das Diferenças Finitas; Migração Reversa no Tempo; mapeamento de estruturas geológicas
    </p>
   </div>
   <hr/>
   <div>
    <p>
     The concept of wave is recurrent in pure and applied sciences, serving as a basis to understand and describe from earthquakes, through telecommunications and electromagnetic waves, to neutron diffraction, for instance, to cite a case involving Quantum Mechanics. Thus, this concept plays a central role in fields as diverse as Geophysics and Quantum Physics, as well as in their applications. On the other hand, the wave equation is commonly studied in Physics courses, eminently using analytical solutions, where it is not possible to obtain answers in complex domains and therefore study several applications, such as Applied Geophysics and Seismic Method. This article aims to present in detail, in a simple and accessible way, the necessary tools to obtain numerical solutions of the acoustic wave equation, within the scope of Applied Seismology, using them as the basis for an image generation algorithm (reflector mapping) of geological structures in sedimentary basins. This is a beautiful and elegant application of physics, forming the basis of hydrocarbon exploration nowadays, in which huge areas of the Earth’s surface are mapped with the objective of finding configurations in which there will be a potential commercial accumulation of oil. The application described here, known in the specialized literature as Reverse-Time Migration, is applied to a realistic synthetic model. The results demonstrate an excellent quality of the image obtained. In fact, the applied technique is state-of-the-art in terms of migration method (seismic mapping), currently very in vogue and used by industry, especially in pre-salt targets.
    </p>
    <p>
     <strong>
      Keywords
     </strong>
     <br/>
     acoustic waves; finite-diference method; reverse-time migration; geologic structure imaging
    </p>
   </div>
   <hr/>
   <div class="articleSection" data-anchor="Text">
    <h1 class="articleSectionTitle">
     1. Introdução
    </h1>
    <p>
     O conceito de onda é recorrente em diversas áreas da Física e ciências afins, servindo de base para compreender e descrever fenômenos que vão desde a propagação de simples perturbações na superfície de um lago ou a propagação de terremotos através da Terra, até a propagação de luz, a difração de nêutrons entre outros fenômenos quânticos. Neste sentido, tal conceito desempenhou um papel central na nossa compreensão sobre a estrutura interna da Terra, de um lado, e sobre a estrutura da matéria, de outro. Desempenha ainda um papel importante em diversas aplicações científicas e tecnológicas no mundo contemporâneo.
    </p>
    <p>
     Embora de importância inquestionável, a propagação de ondas é vista nos cursos de Bacharelado e Licenciatura em Física com uma abordagem estritamente analítica: apenas situações bastante simplificadas do ponto de vista prático são estudadas e perde-se a oportunidade de utilizar a equação da onda para uma abordagem introdutória de métodos numéricos, algo desejável na formação do cientista contemporâneo. Esta formação numérica é muito comum em áreas mais aplicadas como é o caso das engenharias e da Geofísica, embora infelizmente este não seja o caso da maioria dos cursos de Física pelo país; as cadeiras de física computacional ou similares raramente chegam a abordar métodos numéricos para resolução de equações diferenciais, especialmente EDPs.
    </p>
    <p>
     Este trabalho visa justamente abordar o tema da resolução numérica da equação da onda, de forma introdutória mas cuidadosa – onde se discute a construção de algoritmos de modelagem e a aplicação deste ao mapeamento de estrutura utilizando ondas sísmicas – com o objetivo de contribuir para a disseminação de conceitos e técnicas numéricas entre professores.
    </p>
    <p>
     Entre as inúmeras aplicações possíveis, este artigo escolheu abordar o mapeamento de estruturas utilizando a equação da onda, por ser uma aplicação muito atual e difundida em Geofísica, embora também apareça em Engenharia e Medicina e, potencialmente, em Física. Neste sentido, este trabalho tem como inspiração o método conhecido como Migração Reversa no Tempo (RTM, do inglês, reverse-time migration)[
     <span class="ref">
      <sup class="xref xrefblue">
       1
      </sup>
      <span class="refCtt closed">
       <span>
        1. E. Baysal, D.D. Kosloff e J.W.C. Sherwood, Geophysics 48 , 1514 (1983).
       </span>
      </span>
     </span>
     ,
     <span class="ref">
      <sup class="xref xrefblue">
       2
      </sup>
      <span class="refCtt closed">
       <span>
        2. G.A. Mcmechan, Geophysical Prospecting 31 , 413 (1983).
       </span>
      </span>
     </span>
     ,
     <span class="ref">
      <sup class="xref xrefblue">
       3
      </sup>
      <span class="refCtt closed">
       <span>
        3. N.D. Whitmore, Iterative depth migration by backward time propagation , disponível em: https://doi.org/10.1190/1.1893867.
       </span>
       <br/>
       <a href="https://doi.org/10.1190/1.1893867" target="_blank">
        https://doi.org/10.1190/1.1893867...
       </a>
      </span>
     </span>
     ], um dos métodos de mapeamento de estruturas geológicas mais poderosos utilizados em geofísica aplicada à exploração de hidrocarbonetos atualmente. Na RTM e em qualquer outro método de
     <i>
      migração sísmica
     </i>
     , como será discutido em detalhes, busca-se desfazer o efeito da propagação de ondas, reposicionando-se a energia sísmica proveniente de reflexões e difrações em interfaces onde existe contraste de impedância acústica.
    </p>
    <p>
     A estrutura deste artigo é descrita a seguir. Na seção
     <span class="ref footnote">
      <sup class="xref">
       2
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        2. Conceitos fundamentais de Sísmica
      Nesta seção, são discutidos alguns conceitos importantes sobre o Método Sísmico (ou, simplesmente, Sísmica) de forma bem direcionada aos nossos objetivos, ou seja, modelagem de propagação de ondas e sua a aplicação ao mapeamento de estruturas. Para uma abordagem completa e ainda introdutória, indicamos a Ref. [4]. Para uma abordagem mais detalhada e especializada, a Ref. [5] é a mais indicada.
      O método sísmico de reflexão é o principal método da geofísica aplicada, no caso específico de exploração e caracterização de reservatórios de hidrocarbonetos (petróleo e gás natural), no sentido de que é o que recebe maiores investimentos por parte da indústria do petróleo. Por esta razão é também o método mais desenvolvido. Ele constitui-se de 3 etapas principais: aquisição, processamento e interpretação.
      Na primeira, realizam-se in situ experimentos sísmicos cujo objetivo é fazer propagar ondas sísmicas na região de interesse, captando, em seguida, as ondas refletidas provenientes do meio ao longo do tempo. Na etapa de processamento, realizam-se procedimentos com o intuito de extrair as informações geológicas contidas nos dados coletados, gerando imagens da conformação geológica. De forma simplificada, pode-se dizer que o objetivo final desta etapa é obter uma imagem. Por fim, na terceira etapa, a imagem é interpretada (seja ela 2D ou 3D, como nas modernas aquisições e processamentos sísmicos), em conjunto com todas as informações geológicas e petrofísicas aferidas, visando identificar possíveis reservatórios.
      As ondas que se propagam no interior de materiais sólidos em geral – como as camadas de rochas sedimentares que compõe as bacias sedimentares que abrigam os reservatórios de hidrocarbonetos – podem ser de dois tipos (Fig. 1): além das ondas longitudinais, acústicas, na sismologia chamadas de ondas principais (ou simplesmente ondas P), tratadas neste artigo, ocorrem também ondas cisalhantes (ondas secundárias ou ondas S), conversões entre estes tipos de onda e ondas de superfície. Claramente, as ondas S não se propagam em fluidos, uma vez que estes meios não apresentam resistência ao cisalhamento, como ocorre em material sólido.
      
        Figura 1
        
          Ondas de corpo: (a) onda P e (b) onda S.
        
        
          
          
        
      
      Para descrever de forma mais detalhada a propagação de ondas em sólidos, é necessário lançar mão da chamada teoria da elasticidade (ou ainda de teorias mais sofisticadas), onde são corretamente tratadas tanto as ondas P quanto as ondas S, bem como as conversões de energia entre estes modos de onda quando da passagem das ondas através de interface onde há descontinuidade das propriedade físicas. Além disso, são corretamente descritas também as ondas de superfície, ondas que se propagam apenas próximo à superfície ou interfaces. As ondas P são mais rápidas que as S e ambos os modos de onda obedecem às leis usuais da refração e reflexão de ondas [6] (Lei de Snell):
      
        
          (1)
          
            
              
                
                  c
                  1
                
                ⁢
                sen
                ⁢
                
                  θ
                  1
                
              
              =
              
                
                  c
                  2
                
                ⁢
                sen
                ⁢
                
                  θ
                  2
                
              
            
          
        
      
      onde c1 e c2 são as velocidades de propagação da onda nos respectivos meios e θ1 e θ2 são os ângulos de incidência e transmissão (ou reflexão).
      É importante mencionar que a teoria acústica, que será utilizada neste trabalho, descreve corretamente a propagação de ondas P na Terra, mesmo não sendo capaz de descrever as ondas S e as conversões. Assim, tal teoria, de fato, pode ser utilizada para o imageamento de estruturas geológicas desde que aplicada apenas à energia associada a ondas P medidas em campo, aplicação em que é empregada mais comumente na indústria, devido a maior eficiência computacional dos algoritmos acústicos.
      Em relação aos tipos de levantamento realizados dentro do escopo do Método Sísmico, a chamada sísmica de reflexão é a mais comum. Ela objetiva coletar a energia de reflexões da onda sísmica que retornam à superfície após atingir regiões em subsuperfície com contraste de impedância acústica (I = ρc, sendo ρ e c, respectivamente a densidade e a velocidade de propagação da onda no meio). Outro tipo de aquisição é a chamada sísmica de refração, onde se objetiva captar a energia que sofre reflexão total (quando θ2 = π/2, refração no jargão da área) em uma interface.
      Em uma aquisição típica de sísmica de reflexão, uma fonte de ondas sísmicas é aplicada (usualmente próxima à superfície, em terra ou em mar), de forma que estas se propagam para o interior da área de interesse, ou seja, é gerado um sismo artificial de magnitude pequena. Quando encontra descontinuidades, a onda gerada pela fonte é refletida (como mencionado, proporcionalmente ao contraste de impedância acústica) e se dirige em direção à superfície, onde pode ser registrada e gravada para posteriormente ser processada e transformada em informação útil, especialmente para exploração de hidrocarbonetos. A fonte é detonada diversas vezes, varrendo, desta forma, imensas áreas e coletando grandes volumes de dados. A geometria de disposição das fontes e dos receptores influencia diretamente a qualidade final da imagem que poderá ser obtida. Outro aspecto fundamental é a redundância de informações, que possibilitará, no final das contas, aumentar a razão sinal-ruído e extrair informações sobre as velocidades de propagação do meio.
      As aquisições feitas em mar aberto são operações realizadas de forma muito eficiente por navios próprios de aquisição sísmica. Os navios sísmicos atuais tem o tamanho de um campo de futebol e podem arrastar cabos de mais de 10 km. Nestas aquisições, são empregados arranjos de canhões de ar, dispostos próximos ao navio, como geradores de energia símica. Em navios de última geração, é possível utilizar 20 cabos ou um pouco mais (chamados de streamer), com distância entre eles de 50 m e comprimento de até 12 km. Nestes cabos estão dispostos os arranjos de hidrofones (receptores). Para se ter uma ideia de valores, se a distância entre tiros consecutivos em uma determinada aquisição é de 50 m, a velocidade do navio é de 5 nós (cerca de 2,5 m/s) e o tempo total de registro é de 6–10 s. Tipicamente, é possível varrer 100 km2 ou mais em um turno de operação em águas livres. Uma aquisição de novos dados pode custar milhões de dólares.
      As ondas registradas em superfície contém informações preciosas sobre a geologia em subsuperfície. Neste sentido, o conjunto de dados como um todo contém informações sobre as reflexões, refrações e difrações dos diversos modos de onda e de conversões destes modos de onda ao se propagarem na região de interesse. Mesmo em aquisições marítimas, onde são medidas as respostas apenas da componente compressional das ondas, há informações sobre as diversas conversões ocorridas em subsuperfície. Toda estas informações podem ser divididas em duas componentes, sendo a primeira relativa aos tempos de trânsito e a segunda relativa às amplitudes das ondas sísmicas. Os tempos de trânsito são utilizados para extrair informações chamadas de cinemáticas (no jargão geofísico), ou seja, informações relativas à posição dos refletores, as quais são influenciadas apenas pelo perfil de velocidades (de acordo com a Lei de Snell). Já as amplitudes podem ser utilizadas para obter informações de outra natureza (dinâmicas), relacionadas com os coeficientes de reflexão entre as camadas rochosas e consequentemente com diversas propriedades do meio, como a densidade do meio de propagação.
      Em relação ao registro sísmico, após a geração artificial da perturbação pela fonte sísmica, o mesmo é feito por arranjos de equipamentos semelhantes a microfones, conhecidos como geofones (medido em terra) ou hidrofones (medido na água), dispostos, em geral, na superfície – no caso da chamada sísmica de superfície. Os geofones podem coletar dados multicomponentes enquanto os hidrofones coletam apenas informação da variação da pressão na água. Cada uma das medidas, coletada por um equipamento, é denominada de traço sísmico. Ao conjunto de dados obtidos dá-se o nome de sismogramas. Os sismogramas associados a cada tiro são denominados de painéis de tiro comum (common shot gathers). Tais registros contém informações da variação da pressão (no caso da água) ao longo do tempo para cada hidrofone que, por sua vez, são arranjados a diferentes distâncias da fonte (offset), como já mencionado.
      Na segunda etapa, após a aquisição, os dados sísmicos são processados digitalmente com o objetivo final de se gerar uma imagem da região de interesse. Nesta etapa, são realizados procedimentos com o intuito de atenuar sinais não desejados e aumentar a razão sinal-ruído. Ao final, são realizados procedimentos objetivando fazer uma imagem dos refletores, colapsando as reflexões e difrações presentes nos sismogramas para suas corretas posições em profundidade (ou mesmo em tempo), processo chamado de migração sísmica.
      O termo migração está associado às antigas técnicas geométricas (baseadas em traçado de raio, utilizando princípios como a Lei de Snell), baseadas em registros sísmicos feitos em papel. Buscava-se migrar as posições dos eventos observados nos sismogramas analógicos para suas corretas posições em tempo usando instrumentos típicos de desenho. Tais métodos de migração manual foram utilizados durante grande parte da primeira metade do séc. XX, sendo baseados em princípios geométricos simples, válidos apenas para configurações geológicas bem comportadas, como exemplificado para o caso de refletor plano (Fig. 2).
      
        Figura 2
        
          Migração de um refletor inclinado: em (a), é mostrada uma configuração geológica, formada por um trecho de refletor plano inclinado, sendo mostradas em fi e ri, respectivamente, as posições iniciais e finais das fontes e receptores e, em (b), mostra-se a “migração” dos eventos A e B para suas corretas posições em tempo (A e B).
       </span>
      </span>
     </span>
     , são discutidos conceitos importantes de sísmica de reflexão com o objetivo de tornar o texto o mais autoconsistente possível para físicos. Na seção
     <span class="ref footnote">
      <sup class="xref">
       3
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        3. A equação acústica da onda
      Para desenvolver uma teoria que descreva o movimento longitudinal das partículas quando uma onda acústica se propaga no meio sob consideração, deve-se evocar os princípios fundamentais da conservação da massa e da conservação do momento linear, como por exemplo no texto de Wapenaar e Berkout [7]. Aqui, a dedução não será reproduzida, podendo o leitor se referir ao texto mencionado para a obtenção rigorosa ou mesmo a textos básicos de física, e.g., em [8]. As equações em termos do campo vetorial de velocidade de deslocamento de partículas v→ e do campo acústico de pressão p são dadas por:
      
        (2)
        
          
            
              
                
                  
                    1
                    
                      κ
                      ⁢
                      
                        (
                        
                          r
                          →
                        
                        )
                      
                    
                  
                
                ⁢
                
                  
                    
                      
                        ∂
                        ⁡
                        p
                      
                      ⁢
                      
                        (
                        
                          r
                          →
                        
                        ,
                        t
                        )
                      
                    
                    
                      ∂
                      ⁡
                      t
                    
                  
                
              
              +
              
                ∇
                →
              
            
            .
            
              
                
                  v
                  →
                
                ⁢
                
                  (
                  
                    r
                    →
                  
                  ,
                  t
                  )
                
              
              =
              
                
                  
                    
                      ∂
                      ⁡
                      
                        i
                        V
                      
                    
                    ⁢
                    
                      (
                      
                        r
                        →
                      
                      ,
                      t
                      )
                    
                  
                  
                    ∂
                    ⁡
                    t
                  
                
              
            
          
        
      
      
        (3)
        
          
            
              
                
                  ρ
                  ⁢
                  
                    (
                    
                      r
                      →
                    
                    )
                  
                  ⁢
                  
                    
                      
                        
                          ∂
                          ⁡
                          
                            v
                            →
                          
                        
                        ⁢
                        
                          (
                          
                            r
                            →
                          
                          ,
                          t
                          )
                        
                      
                      
                        ∂
                        ⁡
                        t
                      
                    
                  
                
                +
                
                  
                    ∇
                    →
                  
                  ⁢
                  p
                  ⁢
                  
                    (
                    
                      r
                      →
                    
                    ,
                    t
                    )
                  
                
              
              =
              
                
                  f
                  →
                
                ⁢
                
                  (
                  
                    r
                    →
                  
                  ,
                  t
                  )
                
              
            
            ,
          
        
      
      onde κ⁢(r→) e ρ⁢(r→) são, respectivamente o módulo de compressibilidade e a densidade do meio, f→ é uma força aplicada por unidade de volume e iV é um parâmetro de injeção de massa utilizado em aplicações da Geofísica para gerar a fonte sísmica na água (meios offshore), descrito em [7] – ele representa a injeção de massa por unidade de volume do meio.
      As equações (2)–(3) descrevem a propagação da onda acústica no regime linear, sendo o campo de onda completamente representado através das variáveis p⁢(r→,t) e v→⁢(r→,t), enquanto o meio de propagação é totalmente representado por ρ⁢(r→) e κ⁢(r→), sendo a velocidade de propagação da onda dada por
      
        
          (4)
          
            
              
                c
                =
                
                  
                    κ
                    ρ
                  
                
              
              .
            
          
        
      
      Pode-se manipular matematicamente as equação acima para obter uma que seja escrita apenas em termos do campo de pressão. Para tal, deriva-se temporalmente a Eq. 2 e divide-se por ρ⁢(r→) a Eq. 3, tomando-se em seguida seu divergente, i.e.,
      
        (5)
        
          
            
              
                
                  
                    1
                    κ
                  
                
                ⁢
                
                  
                    
                      
                        ∂
                        2
                      
                      ⁡
                      p
                    
                    
                      ∂
                      ⁡
                      
                        t
                        2
                      
                    
                  
                
              
              +
              
                ∇
                →
              
            
            .
            
              
                
                  
                    ∂
                    ⁡
                    
                      v
                      →
                    
                  
                  
                    ∂
                    ⁡
                    t
                  
                
              
              =
              
                
                  
                    
                      
                        
                          ∂
                          2
                        
                        ⁡
                        
                          i
                          V
                        
                      
                      
                        ∂
                        ⁡
                        
                          t
                          2
                        
                      
                    
                  
                
                ⁢
                e
              
            
          
        
      
      
        (6)
        
          
            
              
                ∇
                →
              
              .
              
                
                  
                    
                      ∂
                      ⁡
                      
                        v
                        →
                      
                    
                    
                      ∂
                      ⁡
                      t
                    
                  
                
                +
                
                  ∇
                  →
                
              
              .
              
                
                  (
                  
                    
                      
                        1
                        ρ
                      
                    
                    ⁢
                    
                      ∇
                      →
                    
                    ⁢
                    p
                  
                  )
                
                =
                
                  ∇
                  →
                
              
              .
              
                (
                
                  
                    
                      1
                      ρ
                    
                  
                  ⁢
                  
                    f
                    →
                  
                
                )
              
            
            .
          
        
      
      Subtraindo a segunda equação na primeira, chega-se à
      
        
          
            
              
                ∇
                →
              
              .
              
                
                  
                    (
                    
                      
                        
                          1
                          ρ
                        
                      
                      ⁢
                      
                        ∇
                        →
                      
                      ⁢
                      p
                    
                    )
                  
                  -
                  
                    
                      
                        1
                        κ
                      
                    
                    ⁢
                    
                      
                        
                          
                            ∂
                            2
                          
                          ⁡
                          p
                        
                        
                          ∂
                          ⁡
                          
                            t
                            2
                          
                        
                      
                    
                  
                
                =
                
                  -
                  
                    F
                    ⁢
                    
                      (
                      t
                      )
                    
                  
                
              
            
            ,
          
        
      
      ou, multiplicando-se a equação acima por ρ,
      
        (7)
        
          
            
              
                ρ
                ⁢
                
                  ∇
                  →
                
              
              .
              
                
                  
                    (
                    
                      
                        
                          1
                          ρ
                        
                      
                      ⁢
                      
                        ∇
                        →
                      
                      ⁢
                      p
                    
                    )
                  
                  -
                  
                    
                      
                        1
                        
                          c
                          2
                        
                      
                    
                    ⁢
                    
                      
                        
                          
                            ∂
                            2
                          
                          ⁡
                          p
                        
                        
                          ∂
                          ⁡
                          
                            t
                            2
                          
                        
                      
                    
                  
                
                =
                
                  -
                  
                    ρ
                    ⁢
                    F
                    ⁢
                    
                      (
                      t
                      )
                    
                  
                
              
            
            ,
          
        
      
      onde F representa a fonte sísmica, dada por
      
        
          (8)
          
            
              
                
                  
                    F
                    ⁢
                    
                      (
                      t
                      )
                    
                  
                  =
                  
                    
                      
                        
                          ∂
                          2
                        
                        ⁡
                        
                          i
                          V
                        
                      
                      
                        ∂
                        ⁡
                        
                          t
                          2
                        
                      
                    
                    -
                    
                      ∇
                      →
                    
                  
                
                .
                
                  (
                  
                    
                      1
                      ρ
                    
                    ⁢
                    
                      f
                      →
                    
                  
                  )
                
              
              .
            
          
        
      
      A equação (7) pode ser simplificada considerando-se meios em que o gradiente de densidades é desprezável. Primeiro, utilizando a identidade ∇→.(h⁢∇→⁢g)=∇→⁢h.∇→⁢g+h⁢∇2⁡g, pode-se reescrever a equação na seguinte forma
      
        
          
            
              
                
                  
                    ∇
                    2
                  
                  ⁡
                  p
                
                +
                
                  ρ
                  ⁢
                  
                    ∇
                    →
                  
                  ⁢
                  
                    (
                    
                      
                        1
                        ρ
                      
                    
                    )
                  
                
              
              .
              
                
                  
                    
                      ∇
                      →
                    
                    ⁢
                    p
                  
                  -
                  
                    
                      
                        1
                        
                          c
                          2
                        
                      
                    
                    ⁢
                    
                      
                        
                          
                            ∂
                            2
                          
                          ⁡
                          p
                        
                        
                          ∂
                          ⁡
                          
                            t
                            2
                          
                        
                      
                    
                  
                
                =
                
                  -
                  
                    ρ
                    ⁢
                    F
                    ⁢
                    
                      (
                      t
                      )
                    
                  
                
              
            
            .
          
        
      
      Logo, derivando o inverso da densidade, chega-se à
      
        
          (9)
          
            
              
                
                  
                    
                      ∇
                      2
                    
                    ⁡
                    p
                  
                  -
                  
                    
                      1
                      
                        c
                        2
                      
                    
                    ⁢
                    
                      
                        
                          ∂
                          2
                        
                        ⁡
                        p
                      
                      
                        ∂
                        ⁡
                        
                          t
                          2
                        
                      
                    
                  
                  -
                  
                    
                      1
                      ρ
                    
                    ⁢
                    
                      ∇
                      →
                    
                    ⁢
                    ρ
                  
                
                .
                
                  
                    
                      ∇
                      →
                    
                    ⁢
                    p
                  
                  =
                  
                    -
                    
                      ρ
                      ⁢
                      F
                      ⁢
                      
                        (
                        t
                        )
                      
                    
                  
                
              
              .
            
          
        
      
      Consequentemente, em regiões onde o gradiente de ρ é negligenciável, é válida a conhecida equação da onda
      
        
          (10)
          
            
              
                
                  
                    
                      ∇
                      2
                    
                    ⁡
                    p
                  
                  -
                  
                    
                      1
                      
                        c
                        2
                      
                    
                    ⁢
                    
                      
                        
                          ∂
                          2
                        
                        ⁡
                        p
                      
                      
                        ∂
                        ⁡
                        
                          t
                          2
                        
                      
                    
                  
                
                =
                
                  -
                  
                    ρ
                    ⁢
                    F
                    ⁢
                    
                      (
                      t
                      )
                    
                  
                
              
              .
            
          
        
      
      Em regiões onde o gradiente de densidade não seja desprezável, esta equação não é uma boa aproximação. Um caso típico onde isto ocorre é no fundo do mar, quando a onda passa da água para as primeiras camadas de sedimentos. Neste caso, embora, a princípio, a direção de propagação e os tempos de trânsito sejam bem descritos pela equação, o mesmo não se verifica com a amplitude. No jargão da área, a equação honra a cinemática da propagação, mas não a dinâmica.
      
        3.1. Fonte sísmica
        De forma geral, uma fonte sísmica é qualquer aparato utilizado para gerar ondas sísmicas que irão se propagar através do meio que se deseja estudar. Exemplos de possíveis fontes sísmicas para levantamentos terrestres em geofísica são: detonação de dinamites enterradas, queda de pesos e emprego de caminhões vibratórios.
        No caso dos levantamentos marítimos, em geral, a fonte é um canhão de ar comprimido (airgun). Esta injeção de ar ocorre ao longo de um curto intervalo de tempo, tipicamente da ordem de um décimo de segundo (o que fornece frequências típicas de algumas dezenas de Hertz). Ela gera uma frente de onda esférica que se propaga pela água até atingir as primeiras camadas de rocha no fundo oceânico e continua a se propagar pelas rochas que compõe a subsuperfície. Ao atingir regiões com forte variação das propriedades físicas (contrastes de impedância), sofre reflexões, refrações e difrações, sendo uma parte desta energia enviada novamente para a superfície, onde podem ser medidas pelos hidrofones
        A onda gerada por um airgun é de tipo P, isto é, puramente longitudinal, o único tipo de onda que se propaga em fluídos (como é o caso da água). Logicamente, isto não significa que inexistam ondas S em aquisições marítimas, uma vez que há conversão da onda P gerada pela fonte para onda S ao atingir as primeiras camadas rochosas em subsuperfície. Entretanto, neste trabalho apenas as ondas P serão modeladas, uma vez que a teoria acústica é utilizada.
        A fonte deve ter certas características desejáveis: primeiro, é fundamental que tenham um espectro específico, onde se verifica a existência de uma frequência máxima presente, em segundo lugar, elas deve possuir uma frequência adequada para se verificar as feições na escala de interesse e que, por outro lado, permita que a onda se propague por distâncias da escala de cerca de uma dezena de quilômetros.
        No formalismo utilizado neste trabalho, uma fonte geral é caracterizada pela distribuição f→ de densidade de força (forças de volumes) e pelo parâmetro iV de injeção de massa. Como feito tradicionalmente na geofísica, será utilizada uma fonte dada pelo pulso de Ricker, o que corresponde a uma injeção de massa gaussiana [9], como será visto. O temo fonte utilizado na Eq. 10 é, desta forma, dado pela seguinte função
        
          (11)
          
            
              
                
                  F
                  ⁢
                  
                    (
                    t
                    )
                  
                
                =
                
                  
                    [
                    
                      
                        2
                        ⁢
                        
                          π
                          3
                        
                        ⁢
                        
                          
                            (
                            
                              
                                f
                                c
                              
                              ⁢
                              
                                t
                                d
                              
                            
                            )
                          
                          2
                        
                      
                      -
                      1
                    
                    ]
                  
                  ⁢
                  
                    exp
                    ⁡
                    
                      [
                      
                        -
                        
                          
                            π
                            3
                          
                          ⁢
                          
                            
                              (
                              
                                
                                  f
                                  c
                                
                                ⁢
                                
                                  t
                                  d
                                
                              
                              )
                            
                            2
                          
                        
                      
                      ]
                    
                  
                
              
              ,
            
          
        
        onde fc é um parâmetro relacionado com a frequência de corte fcorte e td é o tempo defasado, utilizado para deslocar o início da aplicação da fonte, para que o máximo (ou mínimo, no caso) da função seja deslocado de zero para um tempo t0 positivo de forma que a expressão seja praticamente zero no início da análise (em t = 0) e cresça suavemente (sem descontinuidade), conforme mostra a Fig. 3. As expressões para os parâmetros descritos acima são dadas por
        
          Figura 3
          
            (a) Fonte de Ricker, com fcorte = 60Hz, e (b) sua transformada de Fourier.
          
          
            
            
          
        
        
          (12)
          
            
              
                f
                c
              
              =
              
                
                  
                    f
                    
                      c
                      ⁢
                      o
                      ⁢
                      r
                      ⁢
                      t
                      ⁢
                      e
                    
                  
                  
                    3
                    ⁢
                    
                      π
                    
                  
                
              
            
          
        
        
          (13)
          
            
              
                t
                d
              
              =
              
                t
                -
                
                  t
                  0
                
              
            
          
        
        
          (14)
          
            
              
                
                  t
                  0
                
                =
                
                  
                    
                      2
                      ⁢
                      
                        π
                      
                    
                    
                      f
                      
                        c
                        ⁢
                        o
                        ⁢
                        r
                        ⁢
                        t
                        ⁢
                        e
                      
                    
                  
                
              
              .
            
          
        
        Como a Eq. 11 vai a zero apenas no infinito, na prática, utiliza-se tal expressão truncada no tempo, ou seja, a seguinte expressão é utilizada para o temo fonte:
        
          (15)
          
            
              
                
                  
                    
                      
                        F
                        ⁢
                        
                          (
                          t
                          )
                        
                      
                      =
                      
                        [
                        
                          
                            2
                            ⁢
                            
                              π
                              3
                            
                            ⁢
                            
                              
                                (
                                
                                  
                                    f
                                    c
                                  
                                  ⁢
                                  
                                    t
                                    d
                                  
                                
                                )
                              
                              2
                            
                          
                          -
                          1
                        
                        ]
                      
                    
                     
                  
                
                
                  
                    t
                    ∈
                    
                      [
                      0
                      ,
                      
                        t
                        M
                      
                      ]
                    
                  
                
              
              
                
                  
                    
                      
                        exp
                      
                      ⁡
                      
                        [
                        
                          -
                          
                            
                              π
                              3
                            
                            ⁢
                            
                              
                                (
                                
                                  
                                    f
                                    c
                                  
                                  ⁢
                                  
                                    t
                                    d
                                  
                                
                                )
                              
                              2
                            
                          
                        
                        ]
                      
                    
                    ,
                  
                
                
              
              
                
                  
                    
                      
                        F
                        ⁢
                        
                          (
                          t
                          )
                        
                      
                      =
                      0
                    
                    ,
                  
                
                
                  
                    
                      t
                      ∈
                      
                        (
                        
                          t
                          M
                        
                        ,
                        ∞
                        )
                      
                    
                    ,
                  
                
              
            
          
        
        onde
        
          (16)
          
            
              
                
                  t
                  M
                
                =
                
                  2
                  ⁢
                  
                    t
                    0
                  
                
                =
                
                  
                    
                      4
                      ⁢
                      
                        π
                      
                    
                    
                      f
                      
                        c
                        ⁢
                        o
                        ⁢
                        r
                        ⁢
                        t
                        ⁢
                        e
                      
                    
                  
                
              
              .
            
          
        
        Definindo o parâmetros iV como (Gaussiana)
        
          (17)
          
            
              
                
                  
                    i
                    V
                  
                  ⁢
                  
                    (
                    t
                    )
                  
                
                =
                
                  
                    
                      A
                      
                        2
                        ⁢
                        π
                        ⁢
                        
                          
                            (
                            
                              π
                              ⁢
                              
                                f
                                c
                              
                            
                            )
                          
                          2
                        
                      
                    
                  
                  ⁢
                  
                    exp
                    ⁡
                    
                      [
                      
                        -
                        
                          π
                          ⁢
                          
                            
                              (
                              
                                π
                                ⁢
                                
                                  f
                                  c
                                
                                ⁢
                                
                                  t
                                  d
                                
                              
                              )
                            
                            2
                          
                        
                      
                      ]
                    
                  
                
              
              ,
            
          
        
        onde A é uma amplitude, introduzida por conveniência e, além disso, considerando a densidade de forças externas nula, ou seja,
        
          (18)
          
            
              
                
                  f
                  →
                
                =
                
                  0
                  →
                
              
              ,
            
          
        
        obtém-se o termo fonte visto acima. Com isto todos os termos fonte nas equações da acústica podem ser obtidos a partir das derivadas primeira e segunda de iV, que por sua vez podem são dadas por
        
          (19)
          
            
              
                
                  
                    ∂
                    ⁡
                    
                      i
                      V
                    
                  
                  
                    ∂
                    ⁡
                    t
                  
                
              
              =
              
                -
                
                  A
                  ⁢
                  
                    t
                    d
                  
                  ⁢
                  
                    exp
                    ⁡
                    
                      [
                      
                        -
                        
                          π
                          ⁢
                          
                            
                              (
                              
                                π
                                ⁢
                                
                                  f
                                  c
                                
                                ⁢
                                
                                  t
                                  d
                                
                              
                              )
                            
                            2
                          
                        
                      
                      ]
                    
                  
                
              
            
          
        
        
          (20)
          
            
              
                
                  
                    
                      
                        ∂
                        2
                      
                      ⁡
                      
                        i
                        V
                      
                    
                    
                      ∂
                      ⁡
                      
                        t
                        2
                      
                    
                  
                
                =
                
                  A
                  ⁢
                  
                    [
                    
                      
                        2
                        ⁢
                        π
                        ⁢
                        
                          
                            (
                            
                              π
                              ⁢
                              
                                f
                                c
                              
                              ⁢
                              
                                t
                                d
                              
                            
                            )
                          
                          2
                        
                      
                      -
                      1
                    
                    ]
                  
                  ⁢
                  
                    exp
                    ⁡
                    
                      [
                      
                        -
                        
                          π
                          ⁢
                          
                            
                              (
                              
                                π
                                ⁢
                                
                                  f
                                  c
                                
                                ⁢
                                
                                  t
                                  d
                                
                              
                              )
                            
                            2
                          
                        
                      
                      ]
                    
                  
                
              
              .
            
          
        
        Na Figura 4, são mostrados os gráficos do parâmetro de injeção de massa iV e de sua derivada primeira para A = 1. Repare que este parâmetro é adimensional, por representar um volume de injeção de massa por volume do meio.
        
          Figura 4
          
            (a) Parâmetro iV injeção de massa (função de Gauss) e (b) derivada primeira de iV.
          
          
            
            
          
        
        A transformada de Fourier da fonte é dada por
        
          (21)
          
            
              
                
                  s
                  ⁢
                  
                    (
                    f
                    )
                  
                
                =
                
                  
                    
                      
                        2
                        ⁢
                        
                          f
                          2
                        
                      
                      
                        
                          π
                          2
                        
                        ⁢
                        
                          f
                          c
                          3
                        
                      
                    
                  
                  ⁢
                  
                    exp
                    ⁡
                    
                      [
                      
                        
                          
                            -
                            
                              f
                              2
                            
                          
                          
                            π
                            ⁢
                            
                              f
                              c
                              2
                            
                          
                        
                      
                      ]
                    
                  
                
              
              ,
            
          
        
        o que fornece o conteúdo de frequências associados. Com isto, vê-se que a fonte é de banda limitada, sendo fcorte a máxima frequência presente (Fig. 3(b)).
        O fato da fonte ser de banda limitada é importantíssimo pois, em primeiro lugar, as camadas rochosas por onde a onda se propaga funcionam como um filtro de altas frequências, dissipando energia nesta faixa. Em segundo lugar, para representar o sinal da fonte em termos discretos, existe uma frequência limite que pode ser representada dependendo do tempo de amostragem tA utilizado na gravação do registro sísmico (como estabelecido pelo Teorema da Amostragem). Em terceiro lugar, o método das diferenças finitas sofre restrições em relação à máxima frequência que ele consegue aproximar sem que ocorra dispersão numérica, como será discutido posteriormente.
      
      
        3.2. Condições iniciais e de contorno
        Como é bem conhecido da teoria de equações diferenciais parciais, é necessário considerar-se condições de contorno e condições iniciais adequadas para que o problema tenha solução bem definida. Ou seja, trata-se de um problema de valor inicial e de valor de contorno.
        Em relação às condições iniciais, nos problemas de Sísmica necessita-se apenas de condições triviais. Desta forma, as condições iniciais adequadas e utilizada aqui são de campos de pressão nulo, bem como de derivada temporal nula. Em relação às condições de contorno, classicamente dois tipos de condições de contorno são comumente utilizadas, nomeadamente as condições essenciais (de Dirichlet), com valor do campo prescrito, e as condições naturais (de Neumann), com valor da derivada do campo prescrita. Aqui utilizamos condições essenciais triviais (p = 0) em todas as bordas.
        No contexto da Sísmica, onde o domínio seria melhor representado por um meio semi-infinito, aplicar p = 0 em todos os bordos do domínio numérico não é adequado, uma que que isto faz com que toda a onda incidente sobre as interfaces seja refletida. Apenas o topo do modelo deveria ter este comportamento, uma vez que se trata da superfície do mar nas simulações aqui realizadas. Nos demais bordos (nas laterais e na borda inferior), deve-se recorrer a estratégias especiais, chamadas de condições de contorno não-reflexivas, para que as ondas que as atinjam sejam atenuadas e não gerem artefatos numéricos em virtude do truncamento do domínio físico em um domínio computacional de dimensões adequadas.
        Dito de outra forma, a necessidade de utilização de condições de contorno não-reflexivas se deve ao fato de os problemas que se deseja modelar serem na verdade problemas de domínios semi-infinitos, onde as bordas laterais e inferior devem ser simuladas como “transparentes”, evitando a degradação das soluções pelas reflexões nas bordas numéricas.
        Uma estratégia simples e muito utilizada para atenuar as reflexões indesejadas nas bordas do modelo constitui-se na aplicação de camadas de absorção [10]. Esta zona de amortecimento é criada nos pontos próximos a borda do modelo, como mostrado na Fig. 5, sendo a função de amortecimento para o lado esquerdo, em função do ponto espacial n, dada por
        
          Figura 5
          
            A figura da esquerda mostra a exponencial aplicada em 100 pontos na região próxima à borda esquerda e a figura da direita representa a região de amortecimento.
          
          
            
            
          
        
        
          
            (22)
            
              
                
                  
                    
                      f
                      a
                    
                    ⁢
                    
                      (
                      n
                      )
                    
                  
                  =
                  
                    E
                    ⁢
                    x
                    ⁢
                    p
                    ⁢
                    
                      {
                      
                        -
                        
                          
                            [
                            
                              a
                              ⁢
                              
                                (
                                
                                  
                                    N
                                    P
                                  
                                  -
                                  n
                                
                                )
                              
                            
                            ]
                          
                          2
                        
                      
                      }
                    
                  
                
                ,
              
            
          
        
        onde a é o fator de amortecimento, NP é o número de pontos total da camada de amortecimento (em cada um dos lados) e n é o ponto espacial. No exemplo apresentado, utilizou-se a = 2,5×10−4 e NP = 100. Como mostrado, em tais pontos o campo é multiplicado por um fator de decaimento exponencial ponto a ponto, o que reduz gradativamente a amplitude da onda ao se aproximar da borda do modelo. É importante chamar a atenção para o fato de que esta exponencial deve ser aplicada em pontos suficientes (da ordem de 80 a 100 pontos) e deve ser suave, como ilustrado. Outro métodos muito popular na área é denominado de PML (perfectly matched layers) [11], método que modifica as equações na região próxima às bordas para que seja contemplada absorção de energia de forma perfeita (embora, após discretizadas as equações, a absorção não seja perfeita).
        Outra estratégia que pode ser combinada com as camadas de amortecimento é a utilização de equações de onda de sentido único (one-way equations). Neste sentido pomos escrever a equação unidimensional da onda podemos fazer:
        
          
            (23)
            
              
                
                  
                    
                      
                        
                          ∂
                          2
                        
                        ⁡
                        p
                      
                      
                        ∂
                        ⁡
                        
                          x
                          2
                        
                      
                    
                    -
                    
                      
                        1
                        
                          c
                          2
                        
                      
                      ⁢
                      
                        
                          
                            ∂
                            2
                          
                          ⁡
                          p
                        
                        
                          ∂
                          ⁡
                          
                            t
                            2
                          
                        
                      
                    
                  
                  =
                  
                    
                      
                        
                          (
                          
                            
                              ∂
                              
                                ∂
                                ⁡
                                x
                              
                            
                            +
                            
                              
                                1
                                c
                              
                              ⁢
                              
                                ∂
                                
                                  ∂
                                  ⁡
                                  t
                                
                              
                            
                          
                          )
                        
                        ⏟
                      
                      
                        p
                        ⁢
                        a
                        ⁢
                        r
                        ⁢
                        
                          a
                        
                        ⁢
                        d
                        ⁢
                        i
                        ⁢
                        r
                        ⁢
                        e
                        ⁢
                        i
                        ⁢
                        t
                        ⁢
                        a
                      
                    
                    ⁢
                    
                      
                        
                          (
                          
                            
                              ∂
                              
                                ∂
                                ⁡
                                x
                              
                            
                            -
                            
                              
                                1
                                c
                              
                              ⁢
                              
                                ∂
                                
                                  ∂
                                  ⁡
                                  t
                                
                              
                            
                          
                          )
                        
                        ⏟
                      
                      
                        p
                        ⁢
                        a
                        ⁢
                        r
                        ⁢
                        
                          a
                        
                        ⁢
                        e
                        ⁢
                        s
                        ⁢
                        q
                        ⁢
                        u
                        ⁢
                        e
                        ⁢
                        r
                        ⁢
                        d
                        ⁢
                        a
                      
                    
                    ⁢
                    p
                  
                  =
                  0
                
                ,
              
            
          
        
        onde identificamos cada um dos operadores diferenciais como responsável por fazer a onda pra pagar para cada um dos sentidos (direita ou esquerda), que dão origem a solução completa da equação da onda, a conhecida solução de D’Alembert. A partir da fatoração acima, podemos escrever as equações unidirecionais da onda:
        
          (24)
          
            
              
                
                  
                    
                      ∂
                      ⁡
                      p
                    
                    
                      ∂
                      ⁡
                      x
                    
                  
                
                +
                
                  
                    
                      1
                      c
                    
                  
                  ⁢
                  
                    
                      
                        ∂
                        ⁡
                        p
                      
                      
                        ∂
                        ⁡
                        t
                      
                    
                  
                
              
              =
              0
            
          
        
        
          (25)
          
            
              
                
                  
                    
                      
                        ∂
                        ⁡
                        p
                      
                      
                        ∂
                        ⁡
                        x
                      
                    
                  
                  -
                  
                    
                      
                        1
                        c
                      
                    
                    ⁢
                    
                      
                        
                          ∂
                          ⁡
                          p
                        
                        
                          ∂
                          ⁡
                          t
                        
                      
                    
                  
                
                =
                0
              
              .
            
          
        
        A segunda equação é aplicada nos pontos da borda esquerda, o que tem o efeito de reduzir a reflexão da onda que atinge esta borda enquanto se propaga no meio 2D. A primeira equação é aplicada na borda direita e uma equação similar para a componente z é aplicada na borda inferior.
        Para exemplificar a eficácia destas estratégias, é apresentada uma modelagem acústica para um meio de três camadas planas horizontais e homogêneas (Fig. 6). O efeito da aplicação isolada da equação one-way [12] é mostrada na Fig. 6(a) e o efeito combinado da aplicação desta e das camadas de Cerjan é mostrado na Fig. 6(b). Pode-se ver, que as reflexões nas bordas não são mais visíveis, uma vez que apresentam amplitude consideravelmente menor que as demais amplitudes presentes. Pode-se obter bons resultados aplicando-se apenas as camadas de Cerjan, como feito neste trabalho.
        
          Figura 6
          
            Condições de contorno simulando meios semi-infinitos, aplicando-se: (a) a equação one-way da onda isoladamente e (b) esta em conjunto com as camadas de amortecimento de Cerjan. Apenas na borda superior utilizou-se p = 0.
       </span>
      </span>
     </span>
     , serão apresentadas as equações gerais que descrevem a propagação de ondas acústicas em meios materiais. Na seção
     <span class="ref footnote">
      <sup class="xref">
       4
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        4. Soluções numéricas
      Neste seção, primeiro serão apresentadas as ideias básicas do Método das Diferenças Finitas (MDF), com o objetivo de descrever em detalhes a formulação numérica explícita que será adotada. Para um aprofundamento do tema, reporta-se à vasta bibliografia especializada sobre o tema, em especial, ao excelente livro texto [13]. Outros livros sobre o MDF contém informação adicional e introdutória são [14, 15], podendo ser consultados outros bons livros textos mais gerais de métodos numéricos [16, 17, 18, 19].
      
        4.1. O Método das Diferenças Finitas
        O Método das Diferenças Finitas (MDF) é um dos métodos numéricos mais simples e intuitivos utilizados para resolução de equações diferenciais, podendo ser utilizado para obter soluções numéricas de uma vasta gama de equações.
        O seu princípio básico é o de que as equações diferenciais são válidas ponto a ponto do domínio, podendo ser empregadas aproximações de diferenças finitas ponto a ponto desta malha para obter equações algébricas que irão fornecer soluções numéricas das equações. A Fig. 7 mostra a malha, com espaçamentos fixos Δx e Δz, respectivamente, nas direções x e z. No MDF, usualmente, também é adotado um incremento temporal fixo para a solução de equações dependentes do tempo. Desta forma, as funções e propriedades de interesse são consideradas apenas nestes pontos discretos P(xi,zj,tn) = P(iΔx,kΔz,nΔt). Repare que o eixo z é apontado para baixo e será considerado o zero na superfície da Terra.
        
          Figura 7
          
            Malha simples de Diferenças Finitas.
          
          
            
            
          
        
        São obtidas então expressões aproximadas para as derivadas nestes pontos discretos, sendo elas denominadas aproximações de diferenças finitas ou simplesmente diferenças finitas, podendo estas serem de diferentes ordens de precisão, dependendo do número de pontos utilizados, como será visto a seguir.
        
          4.1.1. Operadores de diferenças finitas
          Considere f(x) então uma função contínua, bem como suas derivadas. Pode-se desenvolver esta função em série de Taylor em torno do ponto x0:
          
            
              (26)
              
                
                  
                    
                      f
                      ⁢
                      
                        (
                        x
                        )
                      
                    
                    =
                    
                      
                        
                          
                            
                              ∑
                              
                                n
                                =
                                0
                              
                              ∞
                            
                            
                              
                                1
                                
                                  n
                                  !
                                
                              
                              ⁢
                              
                                
                                  
                                    d
                                    n
                                  
                                  ⁢
                                  f
                                  ⁢
                                  
                                    (
                                    x
                                    )
                                  
                                
                                
                                  d
                                  ⁢
                                  
                                    x
                                    n
                                  
                                
                              
                            
                          
                          |
                        
                        
                          x
                          =
                          
                            x
                            0
                          
                        
                      
                      ⁢
                      
                        
                          (
                          
                            x
                            -
                            
                              x
                              0
                            
                          
                          )
                        
                        n
                      
                    
                  
                  .
                
              
            
          
          Para obter as diferenças finitas que serão utilizadas nas formulações numéricas deste trabalho, o valor da função deve ser desenvolvido em série de Taylor em diferentes pontos x = xi + lΔx, onde l ∈ Z, em torno de xi, isto é,
          
            
              (27)
              
                
                  
                    
                      
                        f
                      
                      
                        i
                        ±
                        l
                      
                    
                    =
                    
                      f
                      ⁢
                      
                        (
                        
                          
                            x
                            i
                          
                          ±
                          
                            l
                            ⁢
                            Δ
                            ⁢
                            x
                          
                        
                        )
                      
                    
                    =
                    
                      
                        
                          
                            
                              ∑
                              
                                n
                                =
                                0
                              
                              ∞
                            
                            
                              
                                1
                                
                                  n
                                  !
                                
                              
                              ⁢
                              
                                
                                  
                                    d
                                    n
                                  
                                  ⁢
                                  f
                                  ⁢
                                  
                                    (
                                    x
                                    )
                                  
                                
                                
                                  d
                                  ⁢
                                  
                                    x
                                    n
                                  
                                
                              
                            
                          
                          |
                        
                        
                          x
                          =
                          
                            x
                            i
                          
                        
                      
                      ⁢
                      
                        
                          (
                          
                            ±
                            
                              l
                              ⁢
                              Δ
                              ⁢
                              x
                            
                          
                          )
                        
                        n
                      
                    
                  
                  .
                
              
            
          
          Soma-se, então, as diferentes expressões obtidas a fim de cancelar os termos até a ordem de interesse da derivada em questão. Como será visto, quanto maior a ordem de aproximação, mais pontos precisam ser considerados. A seguir, serão obtidos os operadores de diferenças finitas em segunda e quarta ordens1 de aproximação em Δx.
          Assim, considere os seguintes desenvolvimentos (l = ±1):
          
            (28)
            
              
                
                  f
                  
                    i
                    +
                    1
                  
                
                =
                
                  
                    f
                    i
                  
                  +
                  
                    
                      
                        
                          Δ
                          ⁢
                          x
                        
                        
                          1
                          !
                        
                      
                    
                    ⁢
                    
                      
                        
                          d
                          ⁢
                          
                            f
                            i
                          
                        
                        
                          d
                          ⁢
                          x
                        
                      
                    
                  
                  +
                  
                    
                      
                        
                          Δ
                          ⁢
                          
                            x
                            2
                          
                        
                        
                          2
                          !
                        
                      
                    
                    ⁢
                    
                      
                        
                          
                            d
                            2
                          
                          ⁢
                          
                            f
                            i
                          
                        
                        
                          d
                          ⁢
                          
                            x
                            2
                          
                        
                      
                    
                  
                  +
                  
                    
                      
                        
                          Δ
                          ⁢
                          
                            x
                            3
                          
                        
                        
                          3
                          !
                        
                      
                    
                    ⁢
                    
                      
                        
                          
                            d
                            3
                          
                          ⁢
                          
                            f
                            i
                          
                        
                        
                          d
                          ⁢
                          
                            x
                            3
                          
                        
                      
                    
                  
                
              
            
            
              
                 
                +
                
                  
                    
                      
                        Δ
                        ⁢
                        
                          x
                          4
                        
                      
                      
                        4
                        !
                      
                    
                  
                  ⁢
                  
                    
                      
                        
                          d
                          4
                        
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        
                          x
                          4
                        
                      
                    
                  
                
                +
                
                  
                    
                      
                        Δ
                        ⁢
                        
                          x
                          5
                        
                      
                      
                        5
                        !
                      
                    
                  
                  ⁢
                  
                    
                      
                        
                          d
                          5
                        
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        
                          x
                          5
                        
                      
                    
                  
                
                +
                …
              
            
          
          
            (29)
            
              
                
                  f
                  
                    i
                    -
                    1
                  
                
                =
                
                  
                    
                      
                        f
                        i
                      
                      -
                      
                        
                          
                            
                              Δ
                              ⁢
                              x
                            
                            
                              1
                              !
                            
                          
                        
                        ⁢
                        
                          
                            
                              d
                              ⁢
                              
                                f
                                i
                              
                            
                            
                              d
                              ⁢
                              x
                            
                          
                        
                      
                    
                    +
                    
                      
                        
                          
                            Δ
                            ⁢
                            
                              x
                              2
                            
                          
                          
                            2
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              2
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              2
                            
                          
                        
                      
                    
                  
                  -
                  
                    
                      
                        
                          Δ
                          ⁢
                          
                            x
                            3
                          
                        
                        
                          3
                          !
                        
                      
                    
                    ⁢
                    
                      
                        
                          
                            d
                            3
                          
                          ⁢
                          
                            f
                            i
                          
                        
                        
                          d
                          ⁢
                          
                            x
                            3
                          
                        
                      
                    
                  
                
              
            
            
              
                
                  
                    
                       
                      +
                      
                        
                          
                            
                              Δ
                              ⁢
                              
                                x
                                4
                              
                            
                            
                              4
                              !
                            
                          
                        
                        ⁢
                        
                          
                            
                              
                                d
                                4
                              
                              ⁢
                              
                                f
                                i
                              
                            
                            
                              d
                              ⁢
                              
                                x
                                4
                              
                            
                          
                        
                      
                    
                    -
                    
                      
                        
                          
                            Δ
                            ⁢
                            
                              x
                              5
                            
                          
                          
                            5
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              5
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              5
                            
                          
                        
                      
                    
                  
                  +
                  …
                
                ,
              
            
          
          onde dfi/dx é a derivada considerada no ponto x = xi.
          Fazendo-se a Eq. 29 menos a Eq. 28, obtém-se a expressão em segunda ordem de aproximação:
          
            (30)
            
              
                
                  
                    
                      
                        d
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        x
                      
                    
                  
                  =
                  
                    
                      
                        
                          
                            f
                            
                              i
                              +
                              1
                            
                          
                          -
                          
                            f
                            
                              i
                              -
                              1
                            
                          
                        
                        
                          2
                          ⁢
                          Δ
                          ⁢
                          x
                        
                      
                    
                    -
                    
                      
                        
                          
                            Δ
                            ⁢
                            
                              x
                              2
                            
                          
                          
                            3
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              3
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              3
                            
                          
                        
                      
                    
                    -
                    
                      
                        
                          
                            Δ
                            ⁢
                            
                              x
                              4
                            
                          
                          
                            5
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              5
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              5
                            
                          
                        
                      
                    
                    -
                    …
                  
                
                ,
              
            
          
          sendo o erro de truncamento da ordem de Δx2, ou seja, é uma aproximação de segunda ordem.
          Para obter aproximações de quarta ordem, é necessário considerar, além dos pontos xi±1, os pontos xi±2, utilizando procedimento similar. Primeiro, considera-se a Eq. 27 nos pontos l = ±2 e subtrai-se uma equação da outra, isolando a derivada, obtendo-se:
          
            (31)
            
              
                
                  
                    
                      
                        d
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        x
                      
                    
                  
                  =
                  
                    
                      
                        
                          
                            f
                            
                              i
                              +
                              2
                            
                          
                          -
                          
                            f
                            
                              i
                              -
                              2
                            
                          
                        
                        
                          4
                          ⁢
                          Δ
                          ⁢
                          x
                        
                      
                    
                    -
                    
                      
                        
                          
                            4
                            ⁢
                            Δ
                            ⁢
                            
                              x
                              2
                            
                          
                          
                            3
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              3
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              3
                            
                          
                        
                      
                    
                    -
                    
                      
                        
                          
                            16
                            ⁢
                            Δ
                            ⁢
                            
                              x
                              4
                            
                          
                          
                            5
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              5
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              5
                            
                          
                        
                      
                    
                    -
                    …
                  
                
                ,
              
            
          
          que inclusive pode ser obtida diretamente da Eq. 30 tomando os pontos i±2 (e fazendo-se Δx→2Δx). Para obter o operador com erro em Δx4, é necessário cancelar o termo em Δx2 na expressão acima. Isto é obtido multiplicando a Eq. 30 por 4 e subtraindo a Eq. 31 dela, de onde segue
          
            (32)
            
              
                
                  
                    
                      d
                      ⁢
                      
                        f
                        i
                      
                    
                    
                      d
                      ⁢
                      x
                    
                  
                
                =
                
                  
                    
                      
                        4
                        3
                      
                    
                    ⁢
                    
                      (
                      
                        
                          
                            
                              f
                              
                                i
                                +
                                1
                              
                            
                            -
                            
                              f
                              
                                i
                                -
                                1
                              
                            
                          
                          
                            2
                            ⁢
                            Δ
                            ⁢
                            x
                          
                        
                      
                      )
                    
                  
                  -
                  
                    
                      
                        1
                        3
                      
                    
                    ⁢
                    
                      
                        
                          
                            f
                            
                              i
                              +
                              2
                            
                          
                          -
                          
                            f
                            
                              i
                              -
                              2
                            
                          
                        
                        
                          4
                          ⁢
                          Δ
                          ⁢
                          x
                        
                      
                    
                  
                
              
            
            
              
                
                   
                  +
                  
                    
                      
                        
                          4
                          ⁢
                          Δ
                          ⁢
                          
                            x
                            4
                          
                        
                        
                          5
                          !
                        
                      
                    
                    ⁢
                    
                      
                        
                          
                            d
                            5
                          
                          ⁢
                          
                            f
                            i
                          
                        
                        
                          d
                          ⁢
                          
                            x
                            5
                          
                        
                      
                    
                  
                
                -
                …
              
            
          
          ou, de maneira compacta,
          
            (33)
            
              
                
                  
                    
                      
                        d
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        x
                      
                    
                  
                  =
                  
                    
                      
                        
                          
                            
                              
                                -
                                
                                  f
                                  
                                    i
                                    +
                                    2
                                  
                                
                              
                              +
                              
                                8
                                ⁢
                                
                                  f
                                  
                                    i
                                    +
                                    1
                                  
                                
                              
                            
                            -
                            
                              8
                              ⁢
                              
                                f
                                
                                  i
                                  -
                                  1
                                
                              
                            
                          
                          +
                          
                            f
                            
                              i
                              -
                              2
                            
                          
                        
                        
                          12
                          ⁢
                          Δ
                          ⁢
                          x
                        
                      
                    
                    +
                    
                      O
                      ⁢
                      
                        (
                        
                          Δ
                          ⁢
                          
                            x
                            4
                          
                        
                        )
                      
                    
                  
                
                .
              
            
          
          Por outro lado, somando as Eq. 28 e Eq. 29 e isolando a derivada segunda, obtém-se
          
            (34)
            
              
                
                  
                    
                      
                        
                          d
                          2
                        
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        
                          x
                          2
                        
                      
                    
                  
                  =
                  
                    
                      
                        
                          
                            
                              
                                f
                                
                                  i
                                  +
                                  1
                                
                              
                              -
                              
                                2
                                ⁢
                                
                                  f
                                  i
                                
                              
                            
                            +
                            
                              f
                              
                                i
                                -
                                1
                              
                            
                          
                          
                            Δ
                            ⁢
                            
                              x
                              2
                            
                          
                        
                      
                      -
                      
                        
                          
                            
                              2
                              ⁢
                              Δ
                              ⁢
                              
                                x
                                2
                              
                            
                            
                              4
                              !
                            
                          
                        
                        ⁢
                        
                          
                            
                              
                                d
                                4
                              
                              ⁢
                              
                                f
                                i
                              
                            
                            
                              d
                              ⁢
                              
                                x
                                4
                              
                            
                          
                        
                      
                    
                    +
                    …
                  
                
                ,
              
            
          
          que é uma aproximação de segunda ordem para a derivada segunda. A aproximação de quarta ordem é obtida pelo mesmo processo visto para a derivada primeira, resultando em
          
            (35)
            
              
                
                  
                    
                      
                        d
                        2
                      
                      ⁢
                      
                        f
                        i
                      
                    
                    
                      d
                      ⁢
                      
                        x
                        2
                      
                    
                  
                
                =
                
                  
                    
                      
                        4
                        3
                      
                    
                    ⁢
                    
                      
                        
                          
                            
                              f
                              
                                i
                                +
                                1
                              
                            
                            -
                            
                              2
                              ⁢
                              
                                f
                                i
                              
                            
                          
                          +
                          
                            f
                            
                              i
                              -
                              1
                            
                          
                        
                        
                          Δ
                          ⁢
                          
                            x
                            2
                          
                        
                      
                    
                  
                  -
                  
                    
                      
                        1
                        3
                      
                    
                    ⁢
                    
                      
                        
                          
                            
                              f
                              
                                i
                                +
                                2
                              
                            
                            -
                            
                              2
                              ⁢
                              
                                f
                                i
                              
                            
                          
                          +
                          
                            f
                            
                              i
                              -
                              2
                            
                          
                        
                        
                          4
                          ⁢
                          Δ
                          ⁢
                          
                            x
                            2
                          
                        
                      
                    
                  
                
              
            
            
              
                
                  
                  =
                  
                    
                      
                        
                          
                            
                              
                                -
                                
                                  f
                                  
                                    i
                                    -
                                    2
                                  
                                
                              
                              +
                              
                                16
                                ⁢
                                
                                  f
                                  
                                    i
                                    -
                                    1
                                  
                                
                              
                            
                            -
                            
                              30
                              ⁢
                              
                                f
                                i
                              
                            
                          
                          +
                          
                            16
                            ⁢
                            
                              f
                              
                                i
                                +
                                1
                              
                            
                          
                        
                        -
                        
                          f
                          
                            i
                            +
                            2
                          
                        
                      
                      
                        12
                        ⁢
                        Δ
                        ⁢
                        
                          x
                          2
                        
                      
                    
                  
                
                .
              
            
          
        
        
          4.1.2. Propriedades das formulações de MDF
          O MDF permite resolver equações diferenciais parciais (EDP), como é o caso da equação da onda, através da aplicação de diferenças finitas na equação que se deseja resolver numericamente. A equação algébrica (sistema linear) advinda deste processo de discretização é denominada de equação de diferenças finitas. Para que a resposta da equação de diferenças finitas (EDF) represente de forma satisfatória a solução da EDP original, é necessário que exigir que algumas propriedades sejam satisfeitas para que se possa de fato obter soluções numéricas limitadas (não infinitas) e uteis. A seguir, são discutidas estas propriedades de forma qualitativa e, na seção 4.2.1, são apresentados critérios quantitativos para garantir respostas acuradas na formulação para a equação da onda adotada aqui.
        
        
          Consistência
          Uma EDF é consistente com uma EDP se a diferença entre a EDF e a EDP (o erro de truncamento da série de Taylor) vai a zero quando o espaçamento da malha e o incremento de tempo vão a zero independentemente, ou seja,
          
            
              (36)
              
                
                  
                    
                      
                        |
                        
                          EDP
                          -
                          EDF
                        
                        |
                      
                      →
                      
                        0
                         
                        se
                      
                    
                     
                    
                      
                        
                          Δ
                          ⁢
                          t
                        
                        →
                        0
                      
                      ,
                      
                        h
                        →
                        0
                      
                    
                  
                  .
                
              
            
          
          Pode acontecer da condição acima ser verdadeira somente quando uma certa relação entre o espaçamento da malha e o passo de tempo é satisfeita. Neste caso, o esquema é dito condicionalmente consistente. É claro que, se o erro de truncamento das aproximações da aproximação é conhecido e proporcional aos espaçamentos e incremento temporal (ou uma potência destes), como ocorre em todos os esquemas derivados com MDF, então a prova de consistência é direta, sendo os esquemas sempre consistente.
        
        
          Estabilidade
          Tal propriedade relaciona-se com o fato de que uma formulação numérica não pode amplificar artificialmente os erros numéricos da solução, o que degradaria completamente a solução numérica do problema ao longo do tempo. Neste sentido, se a solução de uma EDP é limitada, então a solução numérica deve ser limitada também. Como na maioria das vezes a solução de problemas físicos de interesse é limitada, pode-se definir estabilidade numérica como a seguir:
          
            Um esquema de diferenças finitas é estável se produz uma solução limitada quando a solução exata é limitada, e, reversamente, é instável se produz uma solução ilimitada, sendo a solução exata limitada.
          
          Há casos em que a estabilidade do esquema depende do espaçamento da malha e do incremento de tempo, sendo tais esquemas chamados de condicionalmente estáveis. Este é o caso do esquema numérico utilizado neste artigo e de grande parte dos esquemas de diferenças finitas. Na verdade, é o caso dos esquemas de diferenças finitas explícitos. Neste casos, é necessário que o espaçamento da malha e o incremento temporal estejam relacionados entre si de forma adequada, chamada de condição de estabilidade. O pior dos casos ocorre quando o esquema apresenta soluções numéricas ilimitadas para quaisquer valores de espaçamento da malha e incremento temporal, sendo em tais situações chamados de incondicionalmente instáveis. A chamada análise de estabilidade de von Neumann, uma aplicação da análise de Fourier, é o procedimento mais largamente empregado para provar a estabilidade de esquemas de diferenças finitas. Maiores detalhes sobre esta análise podem ser encontrados na Ref. [13].
        
        
          Convergência
          Isoladamente, é a propriedade mais importante. Ela exige que a solução numérica deve convergir para a solução do problema original (regido pela EDP) quando o espaçamento da malha e o incremento temporal tenderem a zero. Infelizmente, provar que um esquema é convergente é bem mais complicado do que provar a consistência e a estabilidade. Por este motivo, um teorema de importância prática imensa é conhecido como Teorema da Equivalência de Lax-Richtmyer [13, 14]. Tal teorema estabelece que um esquema é convergente se ele é estável e consistente. Assim, a tarefa de provar a convergência é substituída pelas tarefas mais simples de provar a consistência e a estabilidade.
        
      
      
        4.2. Formulação explícita adotada
        Nesta seção, será apresentada uma discretização simples da Eq. (10). Além disso, serão abordados critérios práticos para que tais soluções sejam adequadas.
        O esquema abordado aqui utiliza expressões de quarta ordem no espaço (Eq. 35) e de segunda ordem no tempo (utilizando expressão análoga à Eq. 34 para o tempo). Em 2D, a equação de diferenças (que fornece a solução numérica) é obtida substituindo-se as aproximações e isolando no primeiro membro o termo do tempo mais avançando dado por Pi,kn+1, obtendo-se:
        
          (37)
          
            
              
                P
                
                  i
                  ,
                  j
                
                
                  n
                  +
                  1
                
              
              =
              
                δ
                
                  i
                  ,
                  j
                
              
              
                [
                -
                
                  (
                  
                    P
                    
                      
                        i
                        +
                        2
                      
                      ,
                      j
                    
                    n
                  
                  +
                  
                    P
                    
                      i
                      ,
                      
                        j
                        +
                        2
                      
                    
                    n
                  
                  +
                  
                    P
                    
                      
                        i
                        -
                        2
                      
                      ,
                      j
                    
                    n
                  
                  +
                  
                    P
                    
                      i
                      ,
                      
                        j
                        -
                        2
                      
                    
                    n
                  
                  )
                
              
            
          
          
            
               
              +
              16
              
                (
                
                  P
                  
                    
                      i
                      +
                      1
                    
                    ,
                    j
                  
                  n
                
                +
                
                  P
                  
                    i
                    ,
                    
                      j
                      +
                      1
                    
                  
                  n
                
                +
                
                  P
                  
                    
                      i
                      -
                      1
                    
                    ,
                    j
                  
                  n
                
                +
                
                  P
                  
                    i
                    ,
                    
                      j
                      -
                      1
                    
                  
                  n
                
                )
              
              -
              60
              
                P
                
                  i
                  ,
                  j
                
                n
              
              ]
            
          
          
            
              
                
                   
                  +
                  
                    2
                    ⁢
                    
                      P
                      
                        i
                        ,
                        j
                      
                      n
                    
                  
                
                -
                
                  P
                  
                    i
                    ,
                    j
                  
                  
                    n
                    -
                    1
                  
                
              
              ,
            
          
        
        onde o parâmetro numérico definido acima é dado por
        
          
            (38)
            
              
                
                  
                    δ
                    
                      i
                      ,
                      j
                    
                  
                  =
                  
                    
                      Δ
                      ⁢
                      
                        t
                        2
                      
                      ⁢
                      
                        C
                        
                          i
                          ,
                          j
                        
                        2
                      
                    
                    
                      12
                      ⁢
                      h
                    
                  
                
                .
              
            
          
        
        Um fato importante em relação à discretização no tempo é que esquemas em quarta ordem (utilizando expressão análoga à Eq. 35 para o tempo) são incondicionalmente instáveis [20]. Por outro lado, as derivadas espaciais podem ser aproximadas em ordens mais elevadas sem problemas, o que é feito para minimizar a dispersão numérica (ver seção 4.2.1).
        Observa-se que, na formulação numérica apresentada, somente a velocidade c de propagação da onda é considerada, sendo este o único parâmetro que descreve o meio. Embora a densidade ρ apareça multiplicando a fonte, ela é considerada apenas no ponto onde ela é aplicada. Já a velocidade deve ser fornecida ponto a ponto no esquema, sendo este chamado de esquema heterogêneo (como definido na Ref. [21]).
        A formulação de diferenças finitas definida pela Eq. 37 é uma formulação explícita, uma vez que a resposta pode ser calculada explicitamente nos tempos futuros em função de tempos anteriores. Dadas condições iniciais conhecidas (em n = 0), isto permite que a solução seja calculada de forma explicita no passo de tempo seguinte (em n = 1) em função de valores de Pi,k0 conhecidos no tempo nulo e de valores Pi,k-1 no passo anterior (todos iguais a zero, pois são tempos anteriores ao da aplicação da fonte, no qual o meio encontra-se em equilíbrio). De forma geral, conhecendo-se Pi,kn e Pi,kn-1, pode-se calcular todos os valores de pressão no passo de tempo n + 1 e este processo continua iterativamente por Nt passos até que se atinja um determinado tempo final tf = NtΔt de análise. Esquemas explícitos têm a vantagem de não necessitarem de solução de sistemas lineares a cada passo de tempo, um processo bem mais dispendioso computacionalmente se comparado à marcha explícita.
        Os pontos de pressão discretos (sobre a malha de diferenças finitas) necessários para o cômputo de um ponto de pressão no tempo futuro definem o que se chama de estêncil do operador de diferenças finitas, conforme mostrado na Fig. 8.
        
          Figura 8
          
            Estêncil do esquema de diferenças finitas.
          
          
            
            
          
        
        A seguir, será tratada a implementação computacional. Além da simplicidade mostrada acima para a obtenção de esquemas de diferenças finitas e da simplicidade conceitual do MDF, outra grande vantagem do método reside na simplicidade da programação de esquemas explícitos. Além disso, a solução numérica numérica é de boa qualidade, em especial para problemas de propagação de ondas, desde que sejam satisfeitas as condições discutidas na seção 4.2.1, i.e., desde que se satisfaça o critério de estabilidade e se utilize espaçamentos da malha e incremento temporal pequeno o suficiente para que e se tenha uma boa precisão numérica.
        No código computacional, em primeiro lugar, deve-se definir os parâmetros físicos associados ao problema. Estes são: o domínio de propagação da onda, ou seja, o tamanho X e Z do modelo 2D (em metros, por exemplo); as velocidades de propagação de onda no meio, definidas ponto a ponto no domínio; e a frequência de corte da fonte. Os parâmetros numéricos também precisam ser definidos de forma adequada, como será detalhado na seção 4.2.1. Os principais parâmetros numéricos são: os espaçamentos da malha Δx e Δz, que define os números de pontos Nz×Nx, e o incremento temporal Δt, que define o número de passos Nt.
        Um algoritmo básico é apresentado (Algoritmo 8) e explicado na sequência. Primeiro, deve-se declarar as variáveis necessárias para a solução do problema, definir os parâmetros físicos e numérico associados ou lê-los de arquivo. Caso sejam lidos de arquivo durante a execução do programa, as matrizes de Nz×Nx posições devem ser alocadas dinamicamente, após tais parâmetros terem sido lidos e alternativamente, de forma mais simples, tais matrizes podem ser declaradas se Nz e Nx são declarados como parâmetros. Na linha 8, o modelo de velocidade é lido para a matriz de velocidades. Na linha 8, deve-se realizar alguns cálculos iniciais, como: (1) zerar as matrizes P1 e P2 que irão guardar os valores de pressão na malha em instantes de tempo consecutivos, respectivamente em n−1 e n, necessários para a marcha explícita no tempo (cálculo de P3 em n + 1), (2) calcular parâmetros da fonte, como os dados pelas Eq. 12–14 e (3) a matriz δ é calculada (Eq. 38).
        
          Algoritmo 1
          
            Propagação de onda
          
          
            
            
          
        
        A linha 8 dá início à marcha no tempo propriamente dita (laço sobre o número de passos de tempo n). Na linha 10, a fonte sísmica é aplicada no ponto kf×if da malha, utilizando-se uma função definida pelo usuário, com base na Eq. 11. A fonte é aplicada por meio da introdução do valor da fonte na posição correta da malha, por meio da matriz P1. Assim, ela será corretamente considerada quando executada a linha 14 na posição da fonte. Repare que a fonte só será aplicada se o passo de tempo for menor ou igual que a variável inteira Nfonte que especifica o número de passos de tempo onde a fonte é não nula, conforme definido pela Eq. 15. Deve-se utilizar Nfonte como o inteiro de valor mais próximo de tM/Δt (tM dado pela Eq. 16). Entre as linha 12–16, o operador de diferença finita, dado pela Eq. 37, é calculado em cada ponto da malha através de um laço duplo. Na linha 14, F(P2) representa todos os valores de P2 necessários para o cômputo de P3, dados pelos pontos entre colchetes na Eq.37 (Fig. 8).
        Na linha 17, foram agrupadas em uma subrotina todo o tratamento das bordas, ou seja, a aplicação de segunda ordem nos pontos próximos ao contorno, a aplicação de p = 0 na superfície, das equações one-way da onda nas demais bordas, bem como as camadas de Cerjan. Detalhamento sobre esta subrotina é deixado como exercício para o leitor interessado em implementar o código utilizando uma linguagem de programação. As linhas 18–22 escrevem os snapshots em arquivos a cada Nsnap passos, onde MOD(a,b) retorna o resto da divisão inteira a/b. As linhas 22–24 salvam o sismograma na matriz Sismo (cada um dos NR receptores em (z,x) = iprof,xk), posteriormente escrita em arquivo. Na linha 25, os campos de pressão são atualizados para continuar a marcha. Dentro de um laço duplo sob toda a malha, utiliza-se as atribuições: P1(i, k)←P2(i, k), P2(i, k)←P3(i, k).
        
          4.2.1. Critérios práticos para acurácia
          Um esquema numérico pode satisfazer todas as propriedades discutidas acima (seção 4.1.2) e ainda assim apresentar respostas numéricas com acurácia insuficiente para uma determinada aplicação. Intuitivamente, vê-se que a precisão da solução numérica depende dos parâmetros h e Δt adotados e, a princípio, quanto menores forem, melhor a resposta. Na realidade, o assunto é mais complexo como o leitor mais atento deve ter notado da discussão acima sobre estabilidade, em especial, do fato do nosso esquema ser condicionalmente estável.
          Como dito, tais esquemas requerem a utilização de parâmetros h e Δt relacionados entre si, respeitando a condição de estabilidade. Entretanto, mesmo satisfazendo esta condição – que a rigor só garante que os erros numéricos não se tornem incontroláveis durante a marcha no tempo –, as soluções podem se desviar bastante da solução esperada, sendo necessário impor valores h e Δt ainda menores para garantir um determinado grau de acurácia da solução.
          Um estudo detalhado relativo à obtenção do critério de estabilidade ou sobre a acurácia de formulações de diferenças finitas está fora do escopo deste trabalho. Ao leitor interessado em aprofundar-se no assunto, indica-se os mesmos livros de referência citados no início da seção 4. Aqui, apresenta-se, em lugar disso, alguns critérios práticos que, uma vez aplicados, garantem que as soluções numéricas vistas acima possuam estabilidade e precisão suficiente para inúmeras aplicações. Assim, frente aos parâmetros físicos do problema em questão (e.g., velocidade do meio, frequência da fonte), impõe-se a necessidade de os parâmetros numéricos satisfazerem os critérios apresentados abaixo.
          Antes de apresentar os critérios, entretanto, faz-se necessário algumas explicações adicionais. As soluções numéricas de problemas ondulatórios estão sujeitas ao problema conhecido como dispersão numérica. Isto é, no caso de meios não dispersivos e isotrópicos, como os regidos pela equação acústica da onda, as velocidades de fase e de grupo (ver conceito na Ref. [8, 22]) coincidem e são independentes da frequência e do ângulo de propagação. Quando discretiza-se o domínio do problema através do MDF, estas velocidades passam a ser função do espaçamento utilizado para a malha, além da velocidade de propagação do meio, da frequência e do ângulo de propagação. Para minimizar o nível de dispersão numérica a um patamar adequado (e imperceptível nas escala de tempo que será adotada) basta impor o seguinte critério:
          
            
              (39)
              
                
                  
                    h
                    ≤
                    
                      
                        c
                        
                          m
                          ⁢
                          i
                          ⁢
                          n
                        
                      
                      
                        α
                        ⁢
                        
                          f
                          
                            c
                            ⁢
                            o
                            ⁢
                            r
                            ⁢
                            t
                            ⁢
                            e
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde h é o espaçamento da malha, fcorte é a frequência de corte da fonte, isto é, a frequência máxima presente, cmin é a velocidade mínima presente no modelo de velocidades e α é um parâmetro que varia de acordo com a aproximação numérica utilizada. Assim definido, o parâmetro α representa o número de pontos discretos por comprimento de onda, onde se considera o menor comprimento de onda presente (referente à menor velocidade e à maior frequência).
          Em esquemas de diferenças finitas utilizando operador de segunda ordem no tempo e quarta ordem no espaço, como o discutido aqui, valores de α = 5 são suficientes para um boa precisão. Utilizando operadores de segunda ordem no espaço, é necessário utilizar α = 10. Enfatiza-se, ainda, que estes valores dependem do esquema numérico considerado, podendo variar para outras formulações.
          Para que a solução tenha estabilidade numérica, por outro lado, garantindo ainda um alto grau de precisão numérica, o seguinte critério deve ser satisfeito pelos parâmetros numéricos:
          
            
              (40)
              
                
                  
                    
                      Δ
                      ⁢
                      t
                    
                    ≤
                    
                      h
                      
                        β
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde Δt é o intervalo de tempo, h é espaçamento da malha, cmax é a velocidade máxima presente no modelo e β é um parâmetro obtido de forma empírica.
          A relação acima é similar ao critério de Courant-Friedrich-Levy (CFL). Ela expressa a necessidade do intervalo de tempo considerado ter de ser menor que o menor tempo que a onda leva pra atravessar uma célula de diferenças finitas (ou seja, considerando-se a maior velocidade no meio). Assim, β pode ser interpretado como o número de iterações necessárias para levar esta informação de um ponto a outro. Valores de β = 4 são suficientes para garantir a estabilidade da resposta numérica e um bom grau de precisão.
       </span>
      </span>
     </span>
     , aborda-se a formulação numérica desenvolvida utilizando o método das diferenças finitas. Na seção
     <span class="ref footnote">
      <sup class="xref">
       5
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        5. Aplicação ao “imageamento” sísmico
      Esta seção discute como a equação acústica da onda e as soluções numéricas obtidas anteriormente podem ser utilizadas para construção de um método que é capaz de gerar imagens associadas a descontinuidades de propriedades físicas do meio, no caso em questão, à velocidade de propagação.
      
        5.1. Aquisição sísmica
        A seguir, apresenta-se uma aquisição sísmica sintética realizada com um programa escrito em Fortran 90 seguindo o algoritmo explicado anteriormente. O modelo rodado está representado na Fig. 9. Ele foi derivado do modelo desenvolvido pela Hess Corporation e disponibilizado por cortesia pela empresa, sendo mantido na Internet pela Society of Exploration Geophysicists (SEG) para que interessados possam utilizar. Trata-se de uma modelo offshore (em mar) interessante do ponto de vista geológico, uma vez que contém um corpo salino de alta velocidade (c = 4500 m/s) à esquerda e uma grande falha à direita. Originalmente ele é um modelo anisotrópico, como simetria vertical transversa (ver artigo II), embora seja utilizado aqui neste primeiro artigo da série considerando-se os parâmetros de anisotropia iguais a zero.
        
          Figura 9
          
            Modelo de velocidades acústico utilizado, baseado no modelo Hess.
          
          
            
            
          
        
        O modelo Hess é composto originalmente por 3617×1501 pontos e uma lâmina d’água pouco profunda. O modelo utilizado aqui teve sua camada de água expandida e foi reamostrado para 2001×601 pontos, de modo a ser factível rodar os exemplos deste trabalho com a máquina disponível em tempo razoável. Como o espaçamento utilizado foi de h = 7 m, o tamanho total do modelo ficou em 14,0×4,2 km. A fonte empregada foi um pulso de Ricker de frequência fcorte = 40 Hz e o incremento temporal adotado foi de Δt = 3,8×10−4 s, sendo o número de passos no tempo adotado de Nt = 9000, totalizando um tempo de análise total de tf = 3,42 s. Com isto, os parâmetros numéricos ficaram de acordo com o recomendado no tópico 4.2.1, ou seja, o número α (pontos por comprimento de onda mínimo) não inferior a 5 e o número de passos de tempo β (iterações necessárias para levar a informação mais rápida de um ponto a outro da malha) não inferior a 4:
        
          (41)
          
            
              
                α
                =
                
                  
                    
                      c
                      
                        m
                        ⁢
                        i
                        ⁢
                        n
                      
                    
                    
                      h
                      ⁢
                      
                        f
                        
                          c
                          ⁢
                          o
                          ⁢
                          r
                          ⁢
                          t
                          ⁢
                          e
                        
                      
                    
                  
                
                =
                
                  
                    1500
                    
                      7
                      ×
                      40
                    
                  
                
                ≈
                5
              
              ,
              4
            
          
        
        
          (42)
          
            
              
                
                  β
                  =
                  
                    
                      h
                      
                        Δ
                        ⁢
                        t
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  =
                  
                    
                      7
                      
                        3
                        ,
                        
                          8
                          ×
                          
                            10
                            
                              -
                              4
                            
                          
                          ×
                          4500
                        
                      
                    
                  
                  ≈
                  4
                
                ,
                1
              
              .
            
          
        
        Tais valores garantem uma precisão numérica adequada. Como os valores estão próximos dos ideais estipulados, garante-se que a modelagem não utilize mais recursos computacionais que o necessário para o problema em questão. Por exemplo, rodar um modelo com as mesmas dimensões físicas e pelo mesmo tempo total de análise utilizando α = 10 (o que equivale a reduzir o h pela metade) implicaria, no caso 2D, em quadruplicar o número de pontos da malha, multiplicando o tempo de processamento pelo mesmo fator. Além disso, ao reduzir o h pela metade, o Δt também precisa ser reduzido pela metade para satisfazer a Eq. 40, implicando na necessidade de dar o dobro do número de passos de tempo. No total, o tempo de processamento teria aumentado 8 vezes, além do maior gasto de memória.
        Na aquisição sintética rodada, um navio arrasta os receptores atrás de si, andando para a direita com a geometria de aquisição descrita a seguir. A cobertura do cabo de receptores é de 2,1 km, onde os receptores estão espaçados de 70 m (sendo 70 m o offset mínimo), totalizando 30 receptores localizados a esquerda da fonte sísmica (como mostrado esquematicamente na Fig. 9): a linha tracejada R representa os receptores e os asteriscos representam a fonte nas posições em que foram aplicadas. A distância entre os tiros foi também de 70 m e, no total, foram dados 165 tiros, com a posição inicial de x = 2,1 km. Somente as posições do primeiro tiro e dos tiros 10, 60, 110 e 160 são apresentadas na Fig. 9. Cada tiro demorou cerca de 7 minutos para roda em uma máquina com processador Intel i7 de 3.4 GHz.
        Alguns instantâneos mostrando a distribuição do campo de pressão no domínio para um determinado tempo, para diferentes tempos, referente ao tiro 60, são apresentados na Fig. 10.
        
          Figura 10
          
            Snapshots da propagação da onda para o tiro 60 nos tempos (a) t = 1,33s, (b) t = 1,90s, (c) t = 2,47s e (d) t = 3,04s.
          
          
            
            
          
        
        Na Figura 11, são apresentados os sismogramas dos tiros 10, 60, 110 e 160 (mostrados na Fig. 9), ou seja, as respostas ao longo do tempo (no eixo vertical) para cada receptor (no eixo horizontal), dispostos em ordem crescente de offset (distância entre fonte e receptor).
        
          Figura 11
          
            Sismogramas adquiridos nas posições indicadas na Fig. 9, referentes aos tiros de número (a) 10, (b) 60, (c) 110, (d) 160.
          
          
            
            
          
        
        Através dos snapshots (instantâneos do campo de propagação em termos de pressão acústica), pode-se acompanhar a propagação da onda, desde a fonte até ser refletida e retornar aos receptores. Assim, pode-se identificar os diversos eventos coerentes presentes em um sismograma (que seja apresentado posteriormente). É fácil mostrar que as reflexões em interfaces planas são caracterizadas por hipérboles no sismograma, as chamadas hipérboles de reflexão. Quando os receptores não são planos, pode haver desvios da forma hiperbólica. Mesmo não sendo planos, eles podem ser aproximadamente planos localmente (como é o caso deste exemplo), dependendo do tamanho do cabo de receptores em comparação com a curvatura do refletor.
        Em geral, sismogramas contém inúmeras hipérboles que podem ser facilmente identificadas em meio aos mais variados ruídos coerentes (que são eventos assim considerados uma vez que não se tratam de reflexões, como, por exemplo, as refrações). Neste exemplo, não foram inseridos ruídos adicionais (há, entretanto, ruídos numéricos, imperceptíveis nos instantâneos), e sismogramas representam as respostas puras das simulações de propagação, contendo todos os eventos associados a esta propagação, como por exemplo as múltiplas (eventos que ocorrem quando a onda atinge a superfície do modelo, sendo refletiva e retornando para baixo em direção aos refletores novamente, atingindo por fim os receptores mais uma vez).
        O primeiro evento hiperbólico que aparece em cada um dos sismogramas sintéticos da Fig. 11 caracteriza a reflexão no fundo do mar, sendo as demais curvas associadas à reflexão nas demais interfaces e no sal, bem como reflexões múltiplas. A reta inclinada que aparece sempre na mesma posição em todos os sismogramas é a onda direta que se propaga na água, desde a fonte até os receptores. Quanto mais longe o receptor está da fonte (maior o offset), mais tempo a onda irá levar para chegar ao receptor. No tiro 60 (Fig. 11(b)), como exemplo de identificação de eventos nos sismograma sintético, chama-se a atenção para o sexto evento de reflexão, com amplitude acentuada, aproximadamente entre os tempos 2,25 e 2,5 s. Pode-se ver claramente através dos snapshots (em especial, da Fig. 10(a)) que ele caracteriza a reflexão no corpo de sal.
      
      
        5.2. Mapeamentos dos refletores
        Nesta seção, dentro do escopo do método sísmico, serão apresentadas as ideais fundamentais sobre o “imageamento” (mapeamento dos refletores) utilizando a equação da onda aplicada no sentido inverso do tempo, denominado de Migração Reversa no Tempo pré-empilhamento na literatura especializada da área de Geofísica Aplicada. Posteriormente, são descritas em detalhes as etapas do algoritmo de mapeamento e, na sequência, as alterações necessárias no algoritmo de modelagem direta para a sua programação em computador utilizando uma linguagem de programação de alto nível (neste trabalho, foi utilizada a linguagem Fortran, como já mencionado).
        Neste artigo, diferente do procedimento padrão realizado rotineiramente na indústria, o algoritmo será aplicado a dados sintéticos, gerados com o algoritmo de modelagem direta. Enfatiza-se que este tipo de migração (sintética) é muito utilizado para verifica a eficácia de um determinado método, por exemplo, frente a uma configuração geológica de interesse.
        Matematicamente, o problema do imageamento é um problema inverso, em contraposição ao problema direto da propagação da onda. No problema direto, as propriedade do meio são conhecidas e se deseja obter as respostas relativas à propagação da onda neste meio. No problema inverso, a resposta da propagação da onda no meio é conhecida e queremos utilizá-la, de forma inversa, para obter informações sobre o meio.
        Contudo, o problema do imageamento dentro do escopo do método sísmico abordado neste trabalho é um problema inverso aproximado, uma vez que ele utiliza o que se chama de macromodelo de velocidades como informação a priori (input do algoritmo). Como discutido anteriormente na seção 2, o objetivo principal dos diferentes métodos aplicados para o imageamento em sísmica de reflexão, conhecidos genericamente como métodos de migração, é o reposicionamento da energia sísmica medida para a suas corretas posições em subsuperfície, retirando as distorções introduzidas pela propagação da onda. Ou seja, objetiva-se obter uma imagem dos refletores e difratores em subsuperfície, relacionados com a geologia local.
        Dentro do longo fluxo de processamento utilizado rotineiramente pela indústria nestes problemas, é realizado previamente ao imageamento um procedimento chamado de análise de velocidades, onde se objetiva estimar o macromodelo que será utilizado na etapa de migração. Ele poderá ser utilizado para a migração ou, o que é mais comum, servirá de base para algum procedimento mais avançado para geração do macromodelo final, e.g., tomografia ou inversão da forma de onda completa (full waveform inversion, um procedimento de inversão não linear). É importante mencionar que a imagem gerada com a utilização do macromodelo, ou seja, o resultado da migração, fornece indícios sobre a qualidade do macromodelo. Quando o “foco” das imagens é ruim ou existem refletores se cruzando, por exemplo, sabe-se que há problemas. Quando isto ocorre, é comum que o processo de imageamento, quando aplicado em campo, seja feito mais de uma vez, até se chegar a uma solução considerada de qualidade suficiente pelo interprete (o geofísico responsável pela interpretação da imagem com o objetivo final de decidir a locação de um poço exploratório que irá comprovar ou não a existência de hidrocarbonetos no alvo previamente selecionado).
        Existem muitos métodos de migração diferentes, sendo um dos mais populares a chamada migração Kirchhoff, uma técnica que utiliza uma solução integral do problema de propagação de ondas para imagear estruturas. Ela é muito utilizada porque é uma técnica extremamente rápida onde as soluções integrais são implementadas de forma muito eficiente através de somatórios, sem marcha no tempo. Esta técnica, entretanto, não é adequada para utilização em modelos com algo grau de complexidade, como aqueles associados a regiões envolvendo tectônica salina, por exemplo. Nestes casos, em que o modelo de velocidade é complexo, os métodos de migração sísmica baseados na equação da onda vêm ganhando destaque. Não somente os crescentes desafios exploratórios, mas também o desenvolvimento de computadores mais rápidos (clusters) e com maior capacidade de armazenamento, tonaram este um ramo importante. Estes métodos são conhecidos genericamente por métodos de migração baseados na equação da onda. Nestes métodos, os algoritmos de modelagem e de migração são utilizados em conjunto, apresentando as mesmas características.
        O que eles têm em comum é o fato de resolverem alguma aproximação da equação diferencial da onda (ou mesmo a equação completa), através da propagação direta do campo, diferentemente do método de migração Kirchhoff, que é baseado em soluções integrais desta equação, nas quais o campo de onda não é propagado. Tais métodos podem diferir quanto ao domínio utilizado (tempo ou frequência), quanto ao tipo de equação da onda utilizada (acústica ou elástica) e quanto à aproximação utilizada para resolver numericamente a equação da onda, como por exemplo a aproximação unidirecional que considera apenas o campo de onda descendente.
        Neste trabalho, será utilizada a equação acústica completa da onda, resolvida no domínio do tempo, o que caracteriza a Migração Reversa no Tempo. Especificamente, se utilizará a técnica que migra tiros separados e empilha as imagens resultantes de cada tiro ao final para obter a imagem completa, ou seja, a técnica pré-empilhamento. A migração pré-empilhamento apresenta resultados muito melhores do que a técnica pós-empilhamento, onde os dados são empilhados antes da realização da migração. O processo de empilhamento antes da migração sofre de problemas sérios para “focar” a energia em regiões complexas, o que terminam por degradar a imagem final. Entretanto, como a técnica de migração pós-empilhamento é aplicada apenas uma vez (a toda a seção empilhada), ele demanda muitos menos tempo de computação que a migração pré-empilhamento, sendo escolhida em alguns casos práticos por esta vantagem.
        A seguir, serão abordadas as etapas do método de migração utilizando propagação do campo de ondas reversamente no tempo, ou seja, a Migração Reversa no Tempo pré-empilhamento que é a técnica que será aplicada neste artigo.
        Pode-se dizer que o método de imageamento discutido neste artigo é o mais simples e intuitivo do ponto de vista conceitual para o imageamento sísmico.
        Por simplicidade, aqui o método será discutido levando em conta a aplicação a um único tiro (sismograma de tiro), com ênfase nas ideias fundamentais. Para obter uma imagem completa da região de interesse, é necessário que se aplique o algoritmo a diversos tiros e posteriormente as imagens são somadas (processo chamado de empilhamento).
        Em primeiro lugar, como dito anteriormente, o algoritmo desenvolvido aqui será aplicado a um exemplo sintético, ou seja, os sismogramas que serão utilizados para imagear estruturas em subsuperfície vêm de uma modelagem numérica do problema direto. Isto evita a necessidade de pré-processar os dados antes de migrar, de forma a ser possível se concentrar na parte conceitual do método e ainda assim chegar a um resultado final de excelente qualidade.
        Tudo o que será explicado aqui se aplicada da mesma forma a dados reais. De uma forma ou de outra, a migração pressupõe a existência de um dado a ser migrado (no nosso caso, os sismogramas de tiro, como os mostrados no tópico 5.1). Além disso, é necessário o conhecimento prévio do macromodelo de velocidades, como discutido acima. Como irá se trabalhar com dados sintéticos, o modelo de velocidade é conhecido. Ao invés do modelo de velocidades conhecido (que possui descontinuidades de propriedades física), serão utilizados modelos suavizados, onde as reflexões serão bastante atenuadas. Isto é feito para evitar distorções nos tempos de trânsito, devendo ser suavizado o modelo de vagarosidade (inverso da velocidade), como discutido na Ref. [12].
        A primeira etapa da RTM consiste na propagação da onda no sentido direto do tempo, onde os tempos de chegada da onda direta em cada ponto do domínio são calculados e registrados na chamada Matriz de Tempo de Trânsito (MTT). Na segunda etapa, a energia do sismograma que se deseja imagear (seja um sismograma real, vindo de campo, ou um sintético) é reintroduzida no domínio, através da aplicação dos valores medidos pelos receptores como fonte (na posição em que foram medidos) e propagando-se no sentido inverso do tempo final de análise até o tempo inicial). Uma imagem para esta segunda etapa é a seguinte: considerando-se a onda que foi propagada da fonte até os receptores com um filme, a segunda etapa nada mais é do que voltar o filme para trás, até o início, de forma que os instantâneos vão ficando com o formato da fonte sísmica no exato local em que foi aplicada. Aplica-se, então, uma condição de imagem responsável por fazer com que a energia propagada no sentido inverso do tempo pare no local em que foi gerada através de uma reflexão ou difração. Em outras palavras, a condição de imagem é responsável por posicionar a energia na sua correta posição em subsuperfície.
        A condição de imagem estabelece que um ponto imagem P é todo aquele em que o tempo da onda depropagada é igual ao tempo da onda direta (dado pela MTT previamente calculada). Esta condição está representada esquematicamente na Fig. 12. Ela é chamada de condição e imagem por tempo de excitação.
        
          Figura 12
          
            Condição de imagem.
          
          
            
            
          
        
        A seguir, detalha-se cada uma das etapas citadas acima, com ênfase na sua aplicação computacional, sendo os respectivos algoritmos discutidos em detalhes. Posteriormente, com o objetivo de exemplificar e tornar claro todo o processo, os algoritmos serão aplicados aos dados sintéticos apresentados no tópico 5.1.
        
          5.2.1. Implementação computacional
          Cada uma das etapas mencionadas acima é implementada computacionalmente utilizando o código de diferenças finitas discutido na seção 4.2 com algumas modificações pontuais adequadas para a obtenção de matriz de tempo de trânsito (MTT) e da imagem, respectivamente, na primeira e na segunda etapa, como será detalhado a seguir.
        
        
          1a Etapa: propagação no sentido direto
          Nesta etapa, objetiva-se obter os tempos que a onda direta demora para chegar a cada ponto do domínio, ou seja, a chamada matriz de tempo de trânsito (MTT). Para tal, o algoritmo de propagação de ondas é utilizado. Porém, é necessária lançar mão de algum critério para identificação da onda direta no algoritmo.
          Um critério simples que pode ser utilizado com bons resultados, embora tenha os seus problemas inerentes, é o critério da amplitude máxima. Com este critério, considera-se o tempo de trânsito da onda com maior amplitude que passa em um determinado ponto do modelo durante o tempo de aquisição. Ou seja, a onda com maior amplitude é interpretada como a onda direta, embora se saiba que há situações em que isto não é verdade. Entretanto, este critério funciona bastante bem porque a amplitude da onda decai a medida que a onda se propaga (devido a divergência esférica) e, além disso, ao sofrer reflexões e refrações, a onda perde energia e, em geral, tem a sua amplitude diminuída. Com isto, a onda direta costuma ser a onda de maior amplitude se comparada às ondas que irão passar posteriormente no mesmo ponto de observação.
          No Algoritmo 2, é apresentado o pseudo-código para obtenção da MTT. A primeira modificação que deve ser feita no algoritmo original (Algoritmo 1), conforme mostrado na linha 5, se deve à utilização do modelo de velocidades suavizado, para evitar a interferência de ondas refletidas em determinados pontos do domínio que interfiram construtivamente e gerem uma onda com amplitude grande que pode ser erroneamente avaliada como uma onda direta.
          
            Figura 13
            
              Matriz de tempo de trânsito utilizando o modelo de velocidades (a) não suavizado e (b) suavizado.
            
            
              
              
            
          
          Na Figura 13 são mostradas, comparativamente, matrizes de tempo de trânsito com condição de máxima amplitude, com e sem a utilização do modelo de velocidades suavizado. Como pode ser visto, a MTT que utilizou o modelo de velocidades suavizado apresenta uma continuidade maior, caracterizando sua maior qualidade em comparação a que usa o modelo não suavizado.
          
            Algoritmo 2
            
              1a Etapa do imageamento
            
            
              
              
            
          
          Na migração, não se deseja obter sismogramas (e, em geral, nem instantâneos da propagação). Assim, as linhas correspondentes a estas tarefas são substituídas por um código para obter a MTT, mostrado entre as linhas 17–24. Repare que um matriz Amp(Nz,Nx) auxiliar é utilizada para armazenar as amplitudes atuais dos tempos registrados para cada posição da malha. Tais amplitudes são verificadas em cada ponto da malha (a cada passo de tempo) e, caso a amplitude atual no ponto seja maior que a armazenada, registra-se então o novo tempo associado a esta amplitude. Quando a maior amplitude passa pelo ponto, o tempo correspondente é armazenado. O processo deixa então de registrar novos tempos, uma vez que eles estarão associados a amplitudes menores. Ao final da marcha no tempo, a MTT é escrita em arquivo de forma a poder ser utilizada na etapa seguinte da migração.
          Mais uma vez, é importante lembrar que o procedimento descrito deve ser aplicado a cada um dos tiros da migração pré-empilhamento.
        
        
          2a Etapa: propagação no sentido inverso
          A seguir, a segunda parte da migração é apresentada no Algoritmo 3. Como na etapa anterior, um modelo de velocidades suavizado deve ser utilizado. Agora o objetivo é fazer com que as reflexões e difrações associadas à energia propagada reversamente no tempo sejam atenuadas, evitando que a condição de imagem produza artefatos advindos destas ondas.
          Nesta etapa, adicionalmente, é necessário ler os arquivos contendo a matriz de tempo de trânsito e sismograma (armazenadas nas matrizes MTT e SIS), relativo ao tiro a ser migrado, como mostrado na linha 7. Além disso, o laço da marcha no tempo é realizado no sentido de tempo inverso, do tempo final para o inicial, conforme apresentado na linha 8. O sismograma deve ser aplicada como fonte, como discutido anteriormente, para que a energia registrada seja reintroduzida no domínio. Assim, a cada passo de tempo, aplica-se o sismograma (armazenado na matriz SIS(Nt,Nx)), na posição em que foram medidos, referentes a cada um dos traços sísmicos, ou seja, na profundidade iprof e posição x1 até xk, com k = 1 até k = NR, como feito no laço entre as linhas 9–11.
          
            Algoritmo 3
            
              2a Etapa do imageamento&gt; 
            
            
              
              
            
          
          O laço duplo, varrendo toda malha, entre as linhas 18–23 é a condição de imagem. Como se vê, a cada passo de tempo, cada posição da malha é testada para verificar se o tempo (no caso dado pelo índice n de passo no tempo) é igual a MTT naquele ponto. Em caso afirmativo, a amplitude propagada inversamente no tempo (ou seja, P3) é salva na matriz imagem, na posição correspondente. Ao final da marcha no tempo, a matriz imagem é escrita em arquivo. Repare que esta imagem é referente a um único tiro, sendo, portanto, uma imagem parcial, capaz que imagear os refletores próximos à região do tiro. Da mesma forma, todos os demais tiros precisam ser migrados, devendo todas elas serem somadas para obter a imagem final.
        
      
      
        5.3. Resultados do imageamento
        Nesta seção, apresenta-se um exemplo completo de imageamento utilizando algoritmos escritos em Fortran 90 seguindo a lógica discutida acima. Como mencionado anteriormente, o método de imageamento utilizado é conhecido como Migração Reversa no Tempo pré-empilhamento. Neste exemplo serão migrados os 165 tiros do exemplo de aquisição apresentado no tópico 5.1. Por consistência, a mesma geometria de aquisição e os mesmos parâmetros são utilizados.
        Na Figura 14 são mostradas as imagens dos tiros 10, 60, 110 e 160, colocando-se o modelo de velocidades como fundo (para comparação). Como dito anteriormente, cada imagem é capaz de recuperar apenas as informações próximas aos receptores, sendo imagens parciais de toda a área em estudo. Somente após o empilhamento de todos o tiros é que obtém-se uma imagem satisfatória de toda seção. O processo de empilhamento é responsável também por melhorar a razão sinal-ruído da imagem final em relação às imagens individuais de cada trecho. Isto se deve ao fato dos tiros serem dados próximos uns aos outros, de forma a haver eventos redundantes.
        
          Figura 14
          
            Imagens de tiro único para cada um dos tiros mostrados na Fig. 9, ou seja, os tiros (a) 10, (b) 60, (c) 110 e (d) 160.
          
          
            
            
          
        
        Assim, os eventos associados a reflexões e difrações de fato são amplificados, uma vez que tendem a aparecer em todas as imagens próximas, enquanto os artefatos tendem a se cancelar. O resultado final da migração dos 165, após o empilhamento de todos os tiros, é mostrado na Fig 15. Enfatizamos que a imagem está apresentada como saída do algoritmo de empilhamento, no qual as matrizes de imagem dos diferentes tiros foram simplesmente somada e nenhum filtro para remover ruídos foi aplicado. A migração dos 165 tiros levou cerca de 20 horas no total, sendo que a primeira e a segunda etapas foram rodadas em paralelo em um processador multinúcleo de 3.4 GHz.
        
          Figura 15
          
            Imagem final do modelo Hess após o empilhamento dos 165 tiros.
       </span>
      </span>
     </span>
     , será abordada a aplicação do algoritmo descrito para o mapeamento de estruturas utilizando a propagação reversa de ondas, sendo o mesmo aplicado a um modelo sintético similar ao pré-sal brasileiro.
    </p>
    <h1 class="articleSectionTitle">
     2. Conceitos fundamentais de Sísmica
    </h1>
    <p>
     Nesta seção, são discutidos alguns conceitos importantes sobre o Método Sísmico (ou, simplesmente, Sísmica) de forma bem direcionada aos nossos objetivos, ou seja, modelagem de propagação de ondas e sua a aplicação ao mapeamento de estruturas. Para uma abordagem completa e ainda introdutória, indicamos a Ref. [
     <span class="ref">
      <sup class="xref xrefblue">
       4
      </sup>
      <span class="refCtt closed">
       <span>
        4. P. Kearey, M.l Brooks e I. Hill, Geofísica de exploração (Oficina de Textos, São Paulo, 2009).
       </span>
      </span>
     </span>
     ]. Para uma abordagem mais detalhada e especializada, a Ref. [
     <span class="ref">
      <sup class="xref xrefblue">
       5
      </sup>
      <span class="refCtt closed">
       <span>
        5. O. Yilmaz, Seismic Data Analysis. Processing, Inversion, and Interpretation of Seismica Data (Society of Exploration Geophysicists, Tulsa, 2008).
       </span>
      </span>
     </span>
     ] é a mais indicada.
    </p>
    <p>
     O método sísmico de reflexão é o principal método da geofísica aplicada, no caso específico de exploração e caracterização de reservatórios de hidrocarbonetos (petróleo e gás natural), no sentido de que é o que recebe maiores investimentos por parte da indústria do petróleo. Por esta razão é também o método mais desenvolvido. Ele constitui-se de 3 etapas principais: aquisição, processamento e interpretação.
    </p>
    <p>
     Na primeira, realizam-se
     <i>
      in situ
     </i>
     experimentos sísmicos cujo objetivo é fazer propagar ondas sísmicas na região de interesse, captando, em seguida, as ondas refletidas provenientes do meio ao longo do tempo. Na etapa de processamento, realizam-se procedimentos com o intuito de extrair as informações geológicas contidas nos dados coletados, gerando imagens da conformação geológica. De forma simplificada, pode-se dizer que o objetivo final desta etapa é obter uma imagem. Por fim, na terceira etapa, a imagem é interpretada (seja ela 2D ou 3D, como nas modernas aquisições e processamentos sísmicos), em conjunto com todas as informações geológicas e petrofísicas aferidas, visando identificar possíveis reservatórios.
    </p>
    <p>
     As ondas que se propagam no interior de materiais sólidos em geral – como as camadas de rochas sedimentares que compõe as bacias sedimentares que abrigam os reservatórios de hidrocarbonetos – podem ser de dois tipos (Fig.
     <a class="open-asset-modal" data-target="#ModalFigS2_F1" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      1
     </a>
     ): além das ondas longitudinais, acústicas, na sismologia chamadas de ondas principais (ou simplesmente ondas
     <i>
      P
     </i>
     ), tratadas neste artigo, ocorrem também ondas cisalhantes (ondas secundárias ou ondas
     <i>
      S
     </i>
     ), conversões entre estes tipos de onda e ondas de superfície. Claramente, as ondas
     <i>
      S
     </i>
     não se propagam em fluidos, uma vez que estes meios não apresentam resistência ao cisalhamento, como ocorre em material sólido.
    </p>
    <div class="row fig" id="S2_F1">
     <a name="S2_F1">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS2_F1" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/e20d618dfa5f7e6bbd6540eee3f56eeb1940e7ae.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 1
      </strong>
      <br/>
      Ondas de corpo: (a) onda
      <i>
       P
      </i>
      e (b) onda
      <i>
       S
      </i>
      .
      <br/>
     </div>
    </div>
    <p>
     Para descrever de forma mais detalhada a propagação de ondas em sólidos, é necessário lançar mão da chamada teoria da elasticidade (ou ainda de teorias mais sofisticadas), onde são corretamente tratadas tanto as ondas
     <i>
      P
     </i>
     quanto as ondas
     <i>
      S
     </i>
     , bem como as conversões de energia entre estes modos de onda quando da passagem das ondas através de interface onde há descontinuidade das propriedade físicas. Além disso, são corretamente descritas também as ondas de superfície, ondas que se propagam apenas próximo à superfície ou interfaces. As ondas
     <i>
      P
     </i>
     são mais rápidas que as
     <i>
      S
     </i>
     e ambos os modos de onda obedecem às leis usuais da refração e reflexão de ondas [
     <span class="ref">
      <sup class="xref xrefblue">
       6
      </sup>
      <span class="refCtt closed">
       <span>
        6. A.V. Andrade-Neto e D.D. Andrade, Revista Brasileira de Ensino de Física 43 , e20200350 (2021).
       </span>
      </span>
     </span>
     ] (Lei de Snell):
    </p>
    <p>
    </p>
    <div class="row formula" id="eS2_E1">
     <a name="S2_E1">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (1)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <msub>
           <mi>
            c
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           ⁢
          </mo>
          <mtext>
           sen
          </mtext>
          <mo>
           ⁢
          </mo>
          <msub>
           <mi>
            θ
           </mi>
           <mn>
            1
           </mn>
          </msub>
         </mrow>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            c
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo>
           ⁢
          </mo>
          <mtext>
           sen
          </mtext>
          <mo>
           ⁢
          </mo>
          <msub>
           <mi>
            θ
           </mi>
           <mn>
            2
           </mn>
          </msub>
         </mrow>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde
     <i>
      c
     </i>
     <sub>
      1
     </sub>
     e
     <i>
      c
     </i>
     <sub>
      2
     </sub>
     são as velocidades de propagação da onda nos respectivos meios e
     <i>
      θ
     </i>
     <sub>
      1
     </sub>
     e
     <i>
      θ
     </i>
     <sub>
      2
     </sub>
     são os ângulos de incidência e transmissão (ou reflexão).
    </p>
    <p>
     É importante mencionar que a teoria acústica, que será utilizada neste trabalho, descreve corretamente a propagação de ondas
     <i>
      P
     </i>
     na Terra, mesmo não sendo capaz de descrever as ondas
     <i>
      S
     </i>
     e as conversões. Assim, tal teoria, de fato, pode ser utilizada para o imageamento de estruturas geológicas desde que aplicada apenas à energia associada a ondas
     <i>
      P
     </i>
     medidas em campo, aplicação em que é empregada mais comumente na indústria, devido a maior eficiência computacional dos algoritmos acústicos.
    </p>
    <p>
     Em relação aos tipos de levantamento realizados dentro do escopo do Método Sísmico, a chamada sísmica de reflexão é a mais comum. Ela objetiva coletar a energia de reflexões da onda sísmica que retornam à superfície após atingir regiões em subsuperfície com contraste de impedância acústica (
     <i>
      I
     </i>
     =
     <i>
      ρc
     </i>
     , sendo ρ e
     <i>
      c
     </i>
     , respectivamente a densidade e a velocidade de propagação da onda no meio). Outro tipo de aquisição é a chamada sísmica de refração, onde se objetiva captar a energia que sofre reflexão total (quando
     <i>
      θ
     </i>
     <sub>
      2
     </sub>
     =
     <i>
      π
     </i>
     /2, refração no jargão da área) em uma interface.
    </p>
    <p>
     Em uma aquisição típica de sísmica de reflexão, uma fonte de ondas sísmicas é aplicada (usualmente próxima à superfície, em terra ou em mar), de forma que estas se propagam para o interior da área de interesse, ou seja, é gerado um sismo artificial de magnitude pequena. Quando encontra descontinuidades, a onda gerada pela fonte é refletida (como mencionado, proporcionalmente ao contraste de impedância acústica) e se dirige em direção à superfície, onde pode ser registrada e gravada para posteriormente ser processada e transformada em informação útil, especialmente para exploração de hidrocarbonetos. A fonte é detonada diversas vezes, varrendo, desta forma, imensas áreas e coletando grandes volumes de dados. A geometria de disposição das fontes e dos receptores influencia diretamente a qualidade final da imagem que poderá ser obtida. Outro aspecto fundamental é a redundância de informações, que possibilitará, no final das contas, aumentar a razão sinal-ruído e extrair informações sobre as velocidades de propagação do meio.
    </p>
    <p>
     As aquisições feitas em mar aberto são operações realizadas de forma muito eficiente por navios próprios de aquisição sísmica. Os navios sísmicos atuais tem o tamanho de um campo de futebol e podem arrastar cabos de mais de 10 km. Nestas aquisições, são empregados arranjos de canhões de ar, dispostos próximos ao navio, como geradores de energia símica. Em navios de última geração, é possível utilizar 20 cabos ou um pouco mais (chamados de
     <i>
      streamer
     </i>
     ), com distância entre eles de 50 m e comprimento de até 12 km. Nestes cabos estão dispostos os arranjos de hidrofones (receptores). Para se ter uma ideia de valores, se a distância entre tiros consecutivos em uma determinada aquisição é de 50 m, a velocidade do navio é de 5 nós (cerca de 2,5 m/s) e o tempo total de registro é de 6–10 s. Tipicamente, é possível varrer 100 km
     <sup>
      2
     </sup>
     ou mais em um turno de operação em águas livres. Uma aquisição de novos dados pode custar milhões de dólares.
    </p>
    <p>
     As ondas registradas em superfície contém informações preciosas sobre a geologia em subsuperfície. Neste sentido, o conjunto de dados como um todo contém informações sobre as reflexões, refrações e difrações dos diversos modos de onda e de conversões destes modos de onda ao se propagarem na região de interesse. Mesmo em aquisições marítimas, onde são medidas as respostas apenas da componente compressional das ondas, há informações sobre as diversas conversões ocorridas em subsuperfície. Toda estas informações podem ser divididas em duas componentes, sendo a primeira relativa aos tempos de trânsito e a segunda relativa às amplitudes das ondas sísmicas. Os tempos de trânsito são utilizados para extrair informações chamadas de cinemáticas (no jargão geofísico), ou seja, informações relativas à posição dos refletores, as quais são influenciadas apenas pelo perfil de velocidades (de acordo com a Lei de Snell). Já as amplitudes podem ser utilizadas para obter informações de outra natureza (dinâmicas), relacionadas com os coeficientes de reflexão entre as camadas rochosas e consequentemente com diversas propriedades do meio, como a densidade do meio de propagação.
    </p>
    <p>
     Em relação ao registro sísmico, após a geração artificial da perturbação pela fonte sísmica, o mesmo é feito por arranjos de equipamentos semelhantes a microfones, conhecidos como geofones (medido em terra) ou hidrofones (medido na água), dispostos, em geral, na superfície – no caso da chamada sísmica de superfície. Os geofones podem coletar dados multicomponentes enquanto os hidrofones coletam apenas informação da variação da pressão na água. Cada uma das medidas, coletada por um equipamento, é denominada de traço sísmico. Ao conjunto de dados obtidos dá-se o nome de sismogramas. Os sismogramas associados a cada tiro são denominados de painéis de tiro comum (
     <i>
      common shot gathers
     </i>
     ). Tais registros contém informações da variação da pressão (no caso da água) ao longo do tempo para cada hidrofone que, por sua vez, são arranjados a diferentes distâncias da fonte (
     <i>
      offset
     </i>
     ), como já mencionado.
    </p>
    <p>
     Na segunda etapa, após a aquisição, os dados sísmicos são processados digitalmente com o objetivo final de se gerar uma imagem da região de interesse. Nesta etapa, são realizados procedimentos com o intuito de atenuar sinais não desejados e aumentar a razão sinal-ruído. Ao final, são realizados procedimentos objetivando fazer uma imagem dos refletores, colapsando as reflexões e difrações presentes nos sismogramas para suas corretas posições em profundidade (ou mesmo em tempo), processo chamado de migração sísmica.
    </p>
    <p>
     O termo migração está associado às antigas técnicas geométricas (baseadas em traçado de raio, utilizando princípios como a Lei de Snell), baseadas em registros sísmicos feitos em papel. Buscava-se
     <i>
      migrar
     </i>
     as posições dos eventos observados nos sismogramas analógicos para suas corretas posições em tempo usando instrumentos típicos de desenho. Tais métodos de migração manual foram utilizados durante grande parte da primeira metade do séc. XX, sendo baseados em princípios geométricos simples, válidos apenas para configurações geológicas bem comportadas, como exemplificado para o caso de refletor plano (Fig.
     <a class="open-asset-modal" data-target="#ModalFigS2_F2" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      2
     </a>
     ).
    </p>
    <div class="row fig" id="S2_F2">
     <a name="S2_F2">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS2_F2" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/e46197b33608d4235bd21791010ff0f32efe4bb7.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 2
      </strong>
      <br/>
      Migração de um refletor inclinado: em (a), é mostrada uma configuração geológica, formada por um trecho de refletor plano inclinado, sendo mostradas em
      <i>
       f
      </i>
      <sub>
       <i>
        i
       </i>
      </sub>
      e
      <i>
       r
      </i>
      <sub>
       <i>
        i
       </i>
      </sub>
      , respectivamente, as posições iniciais e finais das fontes e receptores e, em (b), mostra-se a “migração” dos eventos
      <i>
       A
      </i>
      e
      <i>
       B
      </i>
      para suas corretas posições em tempo (
      <i>
       A
      </i>
      e
      <i>
       B
      </i>
      ).
      <br/>
     </div>
    </div>
    <h1 class="articleSectionTitle">
     3. A equação acústica da onda
    </h1>
    <p>
     Para desenvolver uma teoria que descreva o movimento longitudinal das partículas quando uma onda acústica se propaga no meio sob consideração, deve-se evocar os princípios fundamentais da conservação da massa e da conservação do momento linear, como por exemplo no texto de Wapenaar e Berkout [
     <span class="ref">
      <sup class="xref xrefblue">
       7
      </sup>
      <span class="refCtt closed">
       <span>
        7. C.P.A. Wapenaar e A.J. Berkhout, Elastic Wave Field Extrapolation: Redatuming of Single- and Multi-Component Seismic Data (Elsevier Science, New York, 1989), v. 2.
       </span>
      </span>
     </span>
     ]. Aqui, a dedução não será reproduzida, podendo o leitor se referir ao texto mencionado para a obtenção rigorosa ou mesmo a textos básicos de física, e.g., em [
     <span class="ref">
      <sup class="xref xrefblue">
       8
      </sup>
      <span class="refCtt closed">
       <span>
        8. M. Nussenzweig, Curso de Física Básica (Edgard Blücher, São Paulo, 1996), v. 2, 3ª ed.
       </span>
      </span>
     </span>
     ]. As equações em termos do campo vetorial de velocidade de deslocamento de partículas
     <math id="INEQ1">
      <mover accent="true">
       <mi>
        v
       </mi>
       <mo stretchy="false">
        →
       </mo>
      </mover>
     </math>
     e do campo acústico de pressão
     <i>
      p
     </i>
     são dadas por:
    </p>
    <div class="row formula" id="eS3_E2">
     <a name="S3_E2">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (2)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mn>
              1
             </mn>
             <mrow>
              <mi>
               κ
              </mi>
              <mo>
               ⁢
              </mo>
              <mrow>
               <mo stretchy="false">
                (
               </mo>
               <mover accent="true">
                <mi>
                 r
                </mi>
                <mo stretchy="false">
                 →
                </mo>
               </mover>
               <mo stretchy="false">
                )
               </mo>
              </mrow>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mrow>
               <mo>
                ∂
               </mo>
               <mo>
                ⁡
               </mo>
               <mi>
                p
               </mi>
              </mrow>
              <mo>
               ⁢
              </mo>
              <mrow>
               <mo stretchy="false">
                (
               </mo>
               <mover accent="true">
                <mi>
                 r
                </mi>
                <mo stretchy="false">
                 →
                </mo>
               </mover>
               <mo>
                ,
               </mo>
               <mi>
                t
               </mi>
               <mo stretchy="false">
                )
               </mo>
              </mrow>
             </mrow>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <mi>
               t
              </mi>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
          <mo>
           +
          </mo>
          <mover accent="true">
           <mo>
            ∇
           </mo>
           <mo stretchy="false">
            →
           </mo>
          </mover>
         </mrow>
         <mo>
          .
         </mo>
         <mrow>
          <mrow>
           <mover accent="true">
            <mi>
             v
            </mi>
            <mo stretchy="false">
             →
            </mo>
           </mover>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo stretchy="false">
             (
            </mo>
            <mover accent="true">
             <mi>
              r
             </mi>
             <mo stretchy="false">
              →
             </mo>
            </mover>
            <mo>
             ,
            </mo>
            <mi>
             t
            </mi>
            <mo stretchy="false">
             )
            </mo>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <msub>
               <mi>
                i
               </mi>
               <mi>
                V
               </mi>
              </msub>
             </mrow>
             <mo>
              ⁢
             </mo>
             <mrow>
              <mo stretchy="false">
               (
              </mo>
              <mover accent="true">
               <mi>
                r
               </mi>
               <mo stretchy="false">
                →
               </mo>
              </mover>
              <mo>
               ,
              </mo>
              <mi>
               t
              </mi>
              <mo stretchy="false">
               )
              </mo>
             </mrow>
            </mrow>
            <mrow>
             <mo>
              ∂
             </mo>
             <mo>
              ⁡
             </mo>
             <mi>
              t
             </mi>
            </mrow>
           </mfrac>
          </mstyle>
         </mrow>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <div class="row formula" id="eS3_E3">
     <a name="S3_E3">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (3)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <mi>
             ρ
            </mi>
            <mo>
             ⁢
            </mo>
            <mrow>
             <mo stretchy="false">
              (
             </mo>
             <mover accent="true">
              <mi>
               r
              </mi>
              <mo stretchy="false">
               →
              </mo>
             </mover>
             <mo stretchy="false">
              )
             </mo>
            </mrow>
            <mo>
             ⁢
            </mo>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <mrow>
                <mo>
                 ∂
                </mo>
                <mo>
                 ⁡
                </mo>
                <mover accent="true">
                 <mi>
                  v
                 </mi>
                 <mo stretchy="false">
                  →
                 </mo>
                </mover>
               </mrow>
               <mo>
                ⁢
               </mo>
               <mrow>
                <mo stretchy="false">
                 (
                </mo>
                <mover accent="true">
                 <mi>
                  r
                 </mi>
                 <mo stretchy="false">
                  →
                 </mo>
                </mover>
                <mo>
                 ,
                </mo>
                <mi>
                 t
                </mi>
                <mo stretchy="false">
                 )
                </mo>
               </mrow>
              </mrow>
              <mrow>
               <mo>
                ∂
               </mo>
               <mo>
                ⁡
               </mo>
               <mi>
                t
               </mi>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
           <mo>
            +
           </mo>
           <mrow>
            <mover accent="true">
             <mo>
              ∇
             </mo>
             <mo stretchy="false">
              →
             </mo>
            </mover>
            <mo>
             ⁢
            </mo>
            <mi>
             p
            </mi>
            <mo>
             ⁢
            </mo>
            <mrow>
             <mo stretchy="false">
              (
             </mo>
             <mover accent="true">
              <mi>
               r
              </mi>
              <mo stretchy="false">
               →
              </mo>
             </mover>
             <mo>
              ,
             </mo>
             <mi>
              t
             </mi>
             <mo stretchy="false">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <mover accent="true">
            <mi>
             f
            </mi>
            <mo stretchy="false">
             →
            </mo>
           </mover>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo stretchy="false">
             (
            </mo>
            <mover accent="true">
             <mi>
              r
             </mi>
             <mo stretchy="false">
              →
             </mo>
            </mover>
            <mo>
             ,
            </mo>
            <mi>
             t
            </mi>
            <mo stretchy="false">
             )
            </mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde
     <math id="INEQ2">
      <mrow>
       <mi>
        κ
       </mi>
       <mo>
        ⁢
       </mo>
       <mrow>
        <mo stretchy="false">
         (
        </mo>
        <mover accent="true">
         <mi>
          r
         </mi>
         <mo stretchy="false">
          →
         </mo>
        </mover>
        <mo stretchy="false">
         )
        </mo>
       </mrow>
      </mrow>
     </math>
     e
     <math id="INEQ3">
      <mrow>
       <mi>
        ρ
       </mi>
       <mo>
        ⁢
       </mo>
       <mrow>
        <mo stretchy="false">
         (
        </mo>
        <mover accent="true">
         <mi>
          r
         </mi>
         <mo stretchy="false">
          →
         </mo>
        </mover>
        <mo stretchy="false">
         )
        </mo>
       </mrow>
      </mrow>
     </math>
     são, respectivamente o módulo de compressibilidade e a densidade do meio,
     <math id="INEQ4">
      <mover accent="true">
       <mi>
        f
       </mi>
       <mo stretchy="false">
        →
       </mo>
      </mover>
     </math>
     é uma força aplicada por unidade de volume e
     <i>
      i
     </i>
     <sub>
      <i>
       V
      </i>
     </sub>
     é um parâmetro de injeção de massa utilizado em aplicações da Geofísica para gerar a fonte sísmica na água (meios
     <i>
      offshore
     </i>
     ), descrito em [
     <span class="ref">
      <sup class="xref xrefblue">
       7
      </sup>
      <span class="refCtt closed">
       <span>
        7. C.P.A. Wapenaar e A.J. Berkhout, Elastic Wave Field Extrapolation: Redatuming of Single- and Multi-Component Seismic Data (Elsevier Science, New York, 1989), v. 2.
       </span>
      </span>
     </span>
     ] – ele representa a injeção de massa por unidade de volume do meio.
    </p>
    <p>
     As equações (
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E2" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      2
     </a>
     )–(
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E3" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      3
     </a>
     ) descrevem a propagação da onda acústica no regime linear, sendo o campo de onda completamente representado através das variáveis
     <math id="INEQ5">
      <mrow>
       <mi>
        p
       </mi>
       <mo>
        ⁢
       </mo>
       <mrow>
        <mo stretchy="false">
         (
        </mo>
        <mover accent="true">
         <mi>
          r
         </mi>
         <mo stretchy="false">
          →
         </mo>
        </mover>
        <mo>
         ,
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mrow>
      </mrow>
     </math>
     e
     <math id="INEQ6">
      <mrow>
       <mover accent="true">
        <mi>
         v
        </mi>
        <mo stretchy="false">
         →
        </mo>
       </mover>
       <mo>
        ⁢
       </mo>
       <mrow>
        <mo stretchy="false">
         (
        </mo>
        <mover accent="true">
         <mi>
          r
         </mi>
         <mo stretchy="false">
          →
         </mo>
        </mover>
        <mo>
         ,
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mrow>
      </mrow>
     </math>
     , enquanto o meio de propagação é totalmente representado por
     <math id="INEQ7">
      <mrow>
       <mi>
        ρ
       </mi>
       <mo>
        ⁢
       </mo>
       <mrow>
        <mo stretchy="false">
         (
        </mo>
        <mover accent="true">
         <mi>
          r
         </mi>
         <mo stretchy="false">
          →
         </mo>
        </mover>
        <mo stretchy="false">
         )
        </mo>
       </mrow>
      </mrow>
     </math>
     e
     <math id="INEQ8">
      <mrow>
       <mi>
        κ
       </mi>
       <mo>
        ⁢
       </mo>
       <mrow>
        <mo stretchy="false">
         (
        </mo>
        <mover accent="true">
         <mi>
          r
         </mi>
         <mo stretchy="false">
          →
         </mo>
        </mover>
        <mo stretchy="false">
         )
        </mo>
       </mrow>
      </mrow>
     </math>
     , sendo a velocidade de propagação da onda dada por
    </p>
    <p>
    </p>
    <div class="row formula" id="eS3_E4">
     <a name="S3_E4">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (4)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mi>
           c
          </mi>
          <mo>
           =
          </mo>
          <msqrt>
           <mfrac>
            <mi>
             κ
            </mi>
            <mi>
             ρ
            </mi>
           </mfrac>
          </msqrt>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Pode-se manipular matematicamente as equação acima para obter uma que seja escrita apenas em termos do campo de pressão. Para tal, deriva-se temporalmente a Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E2" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      2
     </a>
     e divide-se por
     <math id="INEQ9">
      <mrow>
       <mi>
        ρ
       </mi>
       <mo>
        ⁢
       </mo>
       <mrow>
        <mo stretchy="false">
         (
        </mo>
        <mover accent="true">
         <mi>
          r
         </mi>
         <mo stretchy="false">
          →
         </mo>
        </mover>
        <mo stretchy="false">
         )
        </mo>
       </mrow>
      </mrow>
     </math>
     a Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E3" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      3
     </a>
     , tomando-se em seguida seu divergente, i.e.,
    </p>
    <div class="row formula" id="eS3_E5">
     <a name="S3_E5">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (5)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mn>
              1
             </mn>
             <mi>
              κ
             </mi>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <msup>
               <mo>
                ∂
               </mo>
               <mn>
                2
               </mn>
              </msup>
              <mo>
               ⁡
              </mo>
              <mi>
               p
              </mi>
             </mrow>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <msup>
               <mi>
                t
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
          <mo>
           +
          </mo>
          <mover accent="true">
           <mo>
            ∇
           </mo>
           <mo stretchy="false">
            →
           </mo>
          </mover>
         </mrow>
         <mo>
          .
         </mo>
         <mrow>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mo>
              ∂
             </mo>
             <mo>
              ⁡
             </mo>
             <mover accent="true">
              <mi>
               v
              </mi>
              <mo stretchy="false">
               →
              </mo>
             </mover>
            </mrow>
            <mrow>
             <mo>
              ∂
             </mo>
             <mo>
              ⁡
             </mo>
             <mi>
              t
             </mi>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           =
          </mo>
          <mrow>
           <mpadded width="+8.3pt">
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <msup>
                <mo>
                 ∂
                </mo>
                <mn>
                 2
                </mn>
               </msup>
               <mo>
                ⁡
               </mo>
               <msub>
                <mi>
                 i
                </mi>
                <mi>
                 V
                </mi>
               </msub>
              </mrow>
              <mrow>
               <mo>
                ∂
               </mo>
               <mo>
                ⁡
               </mo>
               <msup>
                <mi>
                 t
                </mi>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
             </mfrac>
            </mstyle>
           </mpadded>
           <mo>
            ⁢
           </mo>
           <mi mathvariant="normal">
            e
           </mi>
          </mrow>
         </mrow>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <div class="row formula" id="eS3_E6">
     <a name="S3_E6">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (6)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mover accent="true">
           <mo>
            ∇
           </mo>
           <mo stretchy="false">
            →
           </mo>
          </mover>
          <mo>
           .
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <mover accent="true">
               <mi>
                v
               </mi>
               <mo stretchy="false">
                →
               </mo>
              </mover>
             </mrow>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <mi>
               t
              </mi>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            +
           </mo>
           <mover accent="true">
            <mo>
             ∇
            </mo>
            <mo stretchy="false">
             →
            </mo>
           </mover>
          </mrow>
          <mo>
           .
          </mo>
          <mrow>
           <mrow>
            <mo>
             (
            </mo>
            <mrow>
             <mstyle displaystyle="true">
              <mfrac>
               <mn>
                1
               </mn>
               <mi>
                ρ
               </mi>
              </mfrac>
             </mstyle>
             <mo>
              ⁢
             </mo>
             <mover accent="true">
              <mo>
               ∇
              </mo>
              <mo stretchy="false">
               →
              </mo>
             </mover>
             <mo>
              ⁢
             </mo>
             <mi>
              p
             </mi>
            </mrow>
            <mo>
             )
            </mo>
           </mrow>
           <mo>
            =
           </mo>
           <mover accent="true">
            <mo>
             ∇
            </mo>
            <mo stretchy="false">
             →
            </mo>
           </mover>
          </mrow>
          <mo>
           .
          </mo>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <mstyle displaystyle="true">
             <mfrac>
              <mn>
               1
              </mn>
              <mi>
               ρ
              </mi>
             </mfrac>
            </mstyle>
            <mo>
             ⁢
            </mo>
            <mover accent="true">
             <mi>
              f
             </mi>
             <mo stretchy="false">
              →
             </mo>
            </mover>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Subtraindo a segunda equação na primeira, chega-se à
    </p>
    <div class="row formula" id="eS3_Ex1">
     <a name="S3_Ex1">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <math display="block">
        <mrow>
         <mrow>
          <mover accent="true">
           <mo>
            ∇
           </mo>
           <mo stretchy="false">
            →
           </mo>
          </mover>
          <mo>
           .
          </mo>
          <mrow>
           <mrow>
            <mrow>
             <mo>
              (
             </mo>
             <mrow>
              <mstyle displaystyle="true">
               <mfrac>
                <mn>
                 1
                </mn>
                <mi>
                 ρ
                </mi>
               </mfrac>
              </mstyle>
              <mo>
               ⁢
              </mo>
              <mover accent="true">
               <mo>
                ∇
               </mo>
               <mo stretchy="false">
                →
               </mo>
              </mover>
              <mo>
               ⁢
              </mo>
              <mi>
               p
              </mi>
             </mrow>
             <mo>
              )
             </mo>
            </mrow>
            <mo>
             -
            </mo>
            <mrow>
             <mstyle displaystyle="true">
              <mfrac>
               <mn>
                1
               </mn>
               <mi>
                κ
               </mi>
              </mfrac>
             </mstyle>
             <mo>
              ⁢
             </mo>
             <mstyle displaystyle="true">
              <mfrac>
               <mrow>
                <msup>
                 <mo>
                  ∂
                 </mo>
                 <mn>
                  2
                 </mn>
                </msup>
                <mo>
                 ⁡
                </mo>
                <mi>
                 p
                </mi>
               </mrow>
               <mrow>
                <mo>
                 ∂
                </mo>
                <mo>
                 ⁡
                </mo>
                <msup>
                 <mi>
                  t
                 </mi>
                 <mn>
                  2
                 </mn>
                </msup>
               </mrow>
              </mfrac>
             </mstyle>
            </mrow>
           </mrow>
           <mo>
            =
           </mo>
           <mrow>
            <mo>
             -
            </mo>
            <mrow>
             <mi>
              F
             </mi>
             <mo>
              ⁢
             </mo>
             <mrow>
              <mo stretchy="false">
               (
              </mo>
              <mi>
               t
              </mi>
              <mo stretchy="false">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     ou, multiplicando-se a equação acima por ρ,
    </p>
    <div class="row formula" id="eS3_E7">
     <a name="S3_E7">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (7)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mi>
            ρ
           </mi>
           <mo>
            ⁢
           </mo>
           <mover accent="true">
            <mo>
             ∇
            </mo>
            <mo stretchy="false">
             →
            </mo>
           </mover>
          </mrow>
          <mo>
           .
          </mo>
          <mrow>
           <mrow>
            <mrow>
             <mo>
              (
             </mo>
             <mrow>
              <mstyle displaystyle="true">
               <mfrac>
                <mn>
                 1
                </mn>
                <mi>
                 ρ
                </mi>
               </mfrac>
              </mstyle>
              <mo>
               ⁢
              </mo>
              <mover accent="true">
               <mo>
                ∇
               </mo>
               <mo stretchy="false">
                →
               </mo>
              </mover>
              <mo>
               ⁢
              </mo>
              <mi>
               p
              </mi>
             </mrow>
             <mo>
              )
             </mo>
            </mrow>
            <mo>
             -
            </mo>
            <mrow>
             <mstyle displaystyle="true">
              <mfrac>
               <mn>
                1
               </mn>
               <msup>
                <mi>
                 c
                </mi>
                <mn>
                 2
                </mn>
               </msup>
              </mfrac>
             </mstyle>
             <mo>
              ⁢
             </mo>
             <mstyle displaystyle="true">
              <mfrac>
               <mrow>
                <msup>
                 <mo>
                  ∂
                 </mo>
                 <mn>
                  2
                 </mn>
                </msup>
                <mo>
                 ⁡
                </mo>
                <mi>
                 p
                </mi>
               </mrow>
               <mrow>
                <mo>
                 ∂
                </mo>
                <mo>
                 ⁡
                </mo>
                <msup>
                 <mi>
                  t
                 </mi>
                 <mn>
                  2
                 </mn>
                </msup>
               </mrow>
              </mfrac>
             </mstyle>
            </mrow>
           </mrow>
           <mo>
            =
           </mo>
           <mrow>
            <mo>
             -
            </mo>
            <mrow>
             <mi>
              ρ
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              F
             </mi>
             <mo>
              ⁢
             </mo>
             <mrow>
              <mo stretchy="false">
               (
              </mo>
              <mi>
               t
              </mi>
              <mo stretchy="false">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde
     <i>
      F
     </i>
     representa a fonte sísmica, dada por
    </p>
    <p>
    </p>
    <div class="row formula" id="eS3_E8">
     <a name="S3_E8">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (8)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <mi>
             F
            </mi>
            <mo>
             ⁢
            </mo>
            <mrow>
             <mo stretchy="false">
              (
             </mo>
             <mi>
              t
             </mi>
             <mo stretchy="false">
              )
             </mo>
            </mrow>
           </mrow>
           <mo>
            =
           </mo>
           <mrow>
            <mfrac>
             <mrow>
              <msup>
               <mo>
                ∂
               </mo>
               <mn>
                2
               </mn>
              </msup>
              <mo>
               ⁡
              </mo>
              <msub>
               <mi>
                i
               </mi>
               <mi>
                V
               </mi>
              </msub>
             </mrow>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <msup>
               <mi>
                t
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </mfrac>
            <mo>
             -
            </mo>
            <mover accent="true">
             <mo>
              ∇
             </mo>
             <mo stretchy="false">
              →
             </mo>
            </mover>
           </mrow>
          </mrow>
          <mo>
           .
          </mo>
          <mrow>
           <mo>
            (
           </mo>
           <mrow>
            <mfrac>
             <mn>
              1
             </mn>
             <mi>
              ρ
             </mi>
            </mfrac>
            <mo>
             ⁢
            </mo>
            <mover accent="true">
             <mi>
              f
             </mi>
             <mo stretchy="false">
              →
             </mo>
            </mover>
           </mrow>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     A equação (
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E7" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      7
     </a>
     ) pode ser simplificada considerando-se meios em que o gradiente de densidades é desprezável. Primeiro, utilizando a identidade
     <math id="INEQ10">
      <mrow>
       <mover accent="true">
        <mo>
         ∇
        </mo>
        <mo stretchy="false">
         →
        </mo>
       </mover>
       <mo>
        .
       </mo>
       <mrow>
        <mrow>
         <mo stretchy="false">
          (
         </mo>
         <mrow>
          <mi>
           h
          </mi>
          <mo>
           ⁢
          </mo>
          <mover accent="true">
           <mo>
            ∇
           </mo>
           <mo stretchy="false">
            →
           </mo>
          </mover>
          <mo>
           ⁢
          </mo>
          <mi>
           g
          </mi>
         </mrow>
         <mo stretchy="false">
          )
         </mo>
        </mrow>
        <mo>
         =
        </mo>
        <mrow>
         <mover accent="true">
          <mo>
           ∇
          </mo>
          <mo stretchy="false">
           →
          </mo>
         </mover>
         <mo>
          ⁢
         </mo>
         <mi>
          h
         </mi>
        </mrow>
       </mrow>
       <mo>
        .
       </mo>
       <mrow>
        <mrow>
         <mover accent="true">
          <mo>
           ∇
          </mo>
          <mo stretchy="false">
           →
          </mo>
         </mover>
         <mo>
          ⁢
         </mo>
         <mi>
          g
         </mi>
        </mrow>
        <mo>
         +
        </mo>
        <mrow>
         <mi>
          h
         </mi>
         <mo>
          ⁢
         </mo>
         <mrow>
          <msup>
           <mo>
            ∇
           </mo>
           <mn>
            2
           </mn>
          </msup>
          <mo>
           ⁡
          </mo>
          <mi>
           g
          </mi>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </math>
     , pode-se reescrever a equação na seguinte forma
    </p>
    <div class="row formula" id="eS3_Ex2">
     <a name="S3_Ex2">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <msup>
             <mo>
              ∇
             </mo>
             <mn>
              2
             </mn>
            </msup>
            <mo>
             ⁡
            </mo>
            <mi>
             p
            </mi>
           </mrow>
           <mo>
            +
           </mo>
           <mrow>
            <mi>
             ρ
            </mi>
            <mo>
             ⁢
            </mo>
            <mover accent="true">
             <mo>
              ∇
             </mo>
             <mo stretchy="false">
              →
             </mo>
            </mover>
            <mo>
             ⁢
            </mo>
            <mrow>
             <mo>
              (
             </mo>
             <mstyle displaystyle="true">
              <mfrac>
               <mn>
                1
               </mn>
               <mi>
                ρ
               </mi>
              </mfrac>
             </mstyle>
             <mo>
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <mo>
           .
          </mo>
          <mrow>
           <mrow>
            <mrow>
             <mover accent="true">
              <mo>
               ∇
              </mo>
              <mo stretchy="false">
               →
              </mo>
             </mover>
             <mo>
              ⁢
             </mo>
             <mi>
              p
             </mi>
            </mrow>
            <mo>
             -
            </mo>
            <mrow>
             <mstyle displaystyle="true">
              <mfrac>
               <mn>
                1
               </mn>
               <msup>
                <mi>
                 c
                </mi>
                <mn>
                 2
                </mn>
               </msup>
              </mfrac>
             </mstyle>
             <mo>
              ⁢
             </mo>
             <mstyle displaystyle="true">
              <mfrac>
               <mrow>
                <msup>
                 <mo>
                  ∂
                 </mo>
                 <mn>
                  2
                 </mn>
                </msup>
                <mo>
                 ⁡
                </mo>
                <mi>
                 p
                </mi>
               </mrow>
               <mrow>
                <mo>
                 ∂
                </mo>
                <mo>
                 ⁡
                </mo>
                <msup>
                 <mi>
                  t
                 </mi>
                 <mn>
                  2
                 </mn>
                </msup>
               </mrow>
              </mfrac>
             </mstyle>
            </mrow>
           </mrow>
           <mo>
            =
           </mo>
           <mrow>
            <mo>
             -
            </mo>
            <mrow>
             <mi>
              ρ
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              F
             </mi>
             <mo>
              ⁢
             </mo>
             <mrow>
              <mo stretchy="false">
               (
              </mo>
              <mi>
               t
              </mi>
              <mo stretchy="false">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Logo, derivando o inverso da densidade, chega-se à
    </p>
    <p>
    </p>
    <div class="row formula" id="eS3_E9">
     <a name="S3_E9">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (9)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <msup>
             <mo>
              ∇
             </mo>
             <mn>
              2
             </mn>
            </msup>
            <mo>
             ⁡
            </mo>
            <mi>
             p
            </mi>
           </mrow>
           <mo>
            -
           </mo>
           <mrow>
            <mfrac>
             <mn>
              1
             </mn>
             <msup>
              <mi>
               c
              </mi>
              <mn>
               2
              </mn>
             </msup>
            </mfrac>
            <mo>
             ⁢
            </mo>
            <mfrac>
             <mrow>
              <msup>
               <mo>
                ∂
               </mo>
               <mn>
                2
               </mn>
              </msup>
              <mo>
               ⁡
              </mo>
              <mi>
               p
              </mi>
             </mrow>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <msup>
               <mi>
                t
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mrow>
           <mo>
            -
           </mo>
           <mrow>
            <mfrac>
             <mn>
              1
             </mn>
             <mi>
              ρ
             </mi>
            </mfrac>
            <mo>
             ⁢
            </mo>
            <mover accent="true">
             <mo>
              ∇
             </mo>
             <mo stretchy="false">
              →
             </mo>
            </mover>
            <mo>
             ⁢
            </mo>
            <mi>
             ρ
            </mi>
           </mrow>
          </mrow>
          <mo>
           .
          </mo>
          <mrow>
           <mrow>
            <mover accent="true">
             <mo>
              ∇
             </mo>
             <mo stretchy="false">
              →
             </mo>
            </mover>
            <mo>
             ⁢
            </mo>
            <mi>
             p
            </mi>
           </mrow>
           <mo>
            =
           </mo>
           <mrow>
            <mo>
             -
            </mo>
            <mrow>
             <mi>
              ρ
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              F
             </mi>
             <mo>
              ⁢
             </mo>
             <mrow>
              <mo stretchy="false">
               (
              </mo>
              <mi>
               t
              </mi>
              <mo stretchy="false">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Consequentemente, em regiões onde o gradiente de ρ é negligenciável, é válida a conhecida equação da onda
    </p>
    <p>
    </p>
    <div class="row formula" id="eS3_E10">
     <a name="S3_E10">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (10)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <msup>
             <mo>
              ∇
             </mo>
             <mn>
              2
             </mn>
            </msup>
            <mo>
             ⁡
            </mo>
            <mi>
             p
            </mi>
           </mrow>
           <mo>
            -
           </mo>
           <mrow>
            <mfrac>
             <mn>
              1
             </mn>
             <msup>
              <mi>
               c
              </mi>
              <mn>
               2
              </mn>
             </msup>
            </mfrac>
            <mo>
             ⁢
            </mo>
            <mfrac>
             <mrow>
              <msup>
               <mo>
                ∂
               </mo>
               <mn>
                2
               </mn>
              </msup>
              <mo>
               ⁡
              </mo>
              <mi>
               p
              </mi>
             </mrow>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <msup>
               <mi>
                t
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <mo>
            -
           </mo>
           <mrow>
            <mi>
             ρ
            </mi>
            <mo>
             ⁢
            </mo>
            <mi>
             F
            </mi>
            <mo>
             ⁢
            </mo>
            <mrow>
             <mo stretchy="false">
              (
             </mo>
             <mi>
              t
             </mi>
             <mo stretchy="false">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Em regiões onde o gradiente de densidade não seja desprezável, esta equação não é uma boa aproximação. Um caso típico onde isto ocorre é no fundo do mar, quando a onda passa da água para as primeiras camadas de sedimentos. Neste caso, embora, a princípio, a direção de propagação e os tempos de trânsito sejam bem descritos pela equação, o mesmo não se verifica com a amplitude. No jargão da área, a equação honra a cinemática da propagação, mas não a dinâmica.
    </p>
    <h2>
     3.1. Fonte sísmica
    </h2>
    <p>
     De forma geral, uma fonte sísmica é qualquer aparato utilizado para gerar ondas sísmicas que irão se propagar através do meio que se deseja estudar. Exemplos de possíveis fontes sísmicas para levantamentos terrestres em geofísica são: detonação de dinamites enterradas, queda de pesos e emprego de caminhões vibratórios.
    </p>
    <p>
     No caso dos levantamentos marítimos, em geral, a fonte é um canhão de ar comprimido (
     <i>
      airgun
     </i>
     ). Esta injeção de ar ocorre ao longo de um curto intervalo de tempo, tipicamente da ordem de um décimo de segundo (o que fornece frequências típicas de algumas dezenas de Hertz). Ela gera uma frente de onda esférica que se propaga pela água até atingir as primeiras camadas de rocha no fundo oceânico e continua a se propagar pelas rochas que compõe a subsuperfície. Ao atingir regiões com forte variação das propriedades físicas (contrastes de impedância), sofre reflexões, refrações e difrações, sendo uma parte desta energia enviada novamente para a superfície, onde podem ser medidas pelos hidrofones
    </p>
    <p>
     A onda gerada por um
     <i>
      airgun
     </i>
     é de tipo
     <i>
      P
     </i>
     , isto é, puramente longitudinal, o único tipo de onda que se propaga em fluídos (como é o caso da água). Logicamente, isto não significa que inexistam ondas
     <i>
      S
     </i>
     em aquisições marítimas, uma vez que há conversão da onda
     <i>
      P
     </i>
     gerada pela fonte para onda
     <i>
      S
     </i>
     ao atingir as primeiras camadas rochosas em subsuperfície. Entretanto, neste trabalho apenas as ondas
     <i>
      P
     </i>
     serão modeladas, uma vez que a teoria acústica é utilizada.
    </p>
    <p>
     A fonte deve ter certas características desejáveis: primeiro, é fundamental que tenham um espectro específico, onde se verifica a existência de uma frequência máxima presente, em segundo lugar, elas deve possuir uma frequência adequada para se verificar as feições na escala de interesse e que, por outro lado, permita que a onda se propague por distâncias da escala de cerca de uma dezena de quilômetros.
    </p>
    <p>
     No formalismo utilizado neste trabalho, uma fonte geral é caracterizada pela distribuição
     <math id="INEQ11">
      <mover accent="true">
       <mi>
        f
       </mi>
       <mo stretchy="false">
        →
       </mo>
      </mover>
     </math>
     de densidade de força (forças de volumes) e pelo parâmetro
     <i>
      i
     </i>
     <sub>
      <i>
       V
      </i>
     </sub>
     de injeção de massa. Como feito tradicionalmente na geofísica, será utilizada uma fonte dada pelo pulso de Ricker, o que corresponde a uma injeção de massa gaussiana [
     <span class="ref">
      <sup class="xref xrefblue">
       9
      </sup>
      <span class="refCtt closed">
       <span>
        9. L. Di Bartolo, C. Dors e W.J. Mansur, Geophysics 77 , T187 (2012).
       </span>
      </span>
     </span>
     ], como será visto. O temo fonte utilizado na Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E10" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      10
     </a>
     é, desta forma, dado pela seguinte função
    </p>
    <div class="row formula" id="eS3_E11">
     <a name="S3_E11">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (11)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mi>
            F
           </mi>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo stretchy="false">
             (
            </mo>
            <mi>
             t
            </mi>
            <mo stretchy="false">
             )
            </mo>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <mrow>
            <mo>
             [
            </mo>
            <mrow>
             <mrow>
              <mn>
               2
              </mn>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                π
               </mi>
               <mn>
                3
               </mn>
              </msup>
              <mo>
               ⁢
              </mo>
              <msup>
               <mrow>
                <mo>
                 (
                </mo>
                <mrow>
                 <msub>
                  <mi>
                   f
                  </mi>
                  <mi>
                   c
                  </mi>
                 </msub>
                 <mo>
                  ⁢
                 </mo>
                 <msub>
                  <mi>
                   t
                  </mi>
                  <mi>
                   d
                  </mi>
                 </msub>
                </mrow>
                <mo>
                 )
                </mo>
               </mrow>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
             <mo>
              -
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mo>
             ]
            </mo>
           </mrow>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mrow>
             <mo>
              [
             </mo>
             <mrow>
              <mo>
               -
              </mo>
              <mrow>
               <msup>
                <mi>
                 π
                </mi>
                <mn>
                 3
                </mn>
               </msup>
               <mo>
                ⁢
               </mo>
               <msup>
                <mrow>
                 <mo stretchy="false">
                  (
                 </mo>
                 <mrow>
                  <msub>
                   <mi>
                    f
                   </mi>
                   <mi>
                    c
                   </mi>
                  </msub>
                  <mo>
                   ⁢
                  </mo>
                  <msub>
                   <mi>
                    t
                   </mi>
                   <mi>
                    d
                   </mi>
                  </msub>
                 </mrow>
                 <mo stretchy="false">
                  )
                 </mo>
                </mrow>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
             </mrow>
             <mo>
              ]
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde
     <i>
      f
     </i>
     <sub>
      <i>
       c
      </i>
     </sub>
     é um parâmetro relacionado com a frequência de corte
     <i>
      f
     </i>
     <sub>
      <i>
       corte
      </i>
     </sub>
     e
     <i>
      t
     </i>
     <sub>
      <i>
       d
      </i>
     </sub>
     é o tempo defasado, utilizado para deslocar o início da aplicação da fonte, para que o máximo (ou mínimo, no caso) da função seja deslocado de zero para um tempo
     <i>
      t
     </i>
     <sub>
      0
     </sub>
     positivo de forma que a expressão seja praticamente zero no início da análise (em
     <i>
      t
     </i>
     = 0) e cresça suavemente (sem descontinuidade), conforme mostra a Fig.
     <a class="open-asset-modal" data-target="#ModalFigS3_F3" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      3
     </a>
     . As expressões para os parâmetros descritos acima são dadas por
    </p>
    <div class="row fig" id="S3_F3">
     <a name="S3_F3">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS3_F3" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/87039d5d0a2a47d285e28f02f87ae351b4ecb736.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 3
      </strong>
      <br/>
      (a) Fonte de Ricker, com
      <i>
       f
      </i>
      <sub>
       <i>
        corte
       </i>
      </sub>
      = 60Hz, e (b) sua transformada de Fourier.
      <br/>
     </div>
    </div>
    <div class="row formula" id="eS3_E12">
     <a name="S3_E12">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (12)
       </span>
       <math display="block">
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mi>
           c
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <mstyle displaystyle="true">
          <mfrac>
           <msub>
            <mi>
             f
            </mi>
            <mrow>
             <mi>
              c
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              o
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              r
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              t
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              e
             </mi>
            </mrow>
           </msub>
           <mrow>
            <mn>
             3
            </mn>
            <mo>
             ⁢
            </mo>
            <msqrt>
             <mi>
              π
             </mi>
            </msqrt>
           </mrow>
          </mfrac>
         </mstyle>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <div class="row formula" id="eS3_E13">
     <a name="S3_E13">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (13)
       </span>
       <math display="block">
        <mrow>
         <msub>
          <mi>
           t
          </mi>
          <mi>
           d
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <mrow>
          <mi>
           t
          </mi>
          <mo>
           -
          </mo>
          <msub>
           <mi>
            t
           </mi>
           <mn>
            0
           </mn>
          </msub>
         </mrow>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <div class="row formula" id="eS3_E14">
     <a name="S3_E14">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (14)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <msub>
           <mi>
            t
           </mi>
           <mn>
            0
           </mn>
          </msub>
          <mo>
           =
          </mo>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mn>
              2
             </mn>
             <mo>
              ⁢
             </mo>
             <msqrt>
              <mi>
               π
              </mi>
             </msqrt>
            </mrow>
            <msub>
             <mi>
              f
             </mi>
             <mrow>
              <mi>
               c
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               o
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               r
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               t
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               e
              </mi>
             </mrow>
            </msub>
           </mfrac>
          </mstyle>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Como a Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E11" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      11
     </a>
     vai a zero apenas no infinito, na prática, utiliza-se tal expressão truncada no tempo, ou seja, a seguinte expressão é utilizada para o temo fonte:
    </p>
    <div class="row formula" id="eS3_E15">
     <a name="S3_E15">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (15)
       </span>
       <math display="block">
        <mtable columnspacing="5pt" rowspacing="0pt">
         <mtr>
          <mtd columnalign="left">
           <mrow>
            <mrow>
             <mrow>
              <mi>
               F
              </mi>
              <mo>
               ⁢
              </mo>
              <mrow>
               <mo stretchy="false">
                (
               </mo>
               <mi>
                t
               </mi>
               <mo stretchy="false">
                )
               </mo>
              </mrow>
             </mrow>
             <mo>
              =
             </mo>
             <mrow>
              <mo>
               [
              </mo>
              <mrow>
               <mrow>
                <mn>
                 2
                </mn>
                <mo>
                 ⁢
                </mo>
                <msup>
                 <mi>
                  π
                 </mi>
                 <mn>
                  3
                 </mn>
                </msup>
                <mo>
                 ⁢
                </mo>
                <msup>
                 <mrow>
                  <mo>
                   (
                  </mo>
                  <mrow>
                   <msub>
                    <mi>
                     f
                    </mi>
                    <mi>
                     c
                    </mi>
                   </msub>
                   <mo>
                    ⁢
                   </mo>
                   <msub>
                    <mi>
                     t
                    </mi>
                    <mi>
                     d
                    </mi>
                   </msub>
                  </mrow>
                  <mo>
                   )
                  </mo>
                 </mrow>
                 <mn>
                  2
                 </mn>
                </msup>
               </mrow>
               <mo>
                -
               </mo>
               <mn>
                1
               </mn>
              </mrow>
              <mo>
               ]
              </mo>
             </mrow>
            </mrow>
            <mo mathvariant="italic" separator="true">
            </mo>
           </mrow>
          </mtd>
          <mtd columnalign="left">
           <mrow>
            <mi>
             t
            </mi>
            <mo>
             ∈
            </mo>
            <mrow>
             <mo stretchy="false">
              [
             </mo>
             <mn>
              0
             </mn>
             <mo>
              ,
             </mo>
             <msub>
              <mi>
               t
              </mi>
              <mi>
               M
              </mi>
             </msub>
             <mo stretchy="false">
              ]
             </mo>
            </mrow>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="left">
           <mrow>
            <mrow>
             <mpadded lspace="40pt" width="+40pt">
              <mi>
               exp
              </mi>
             </mpadded>
             <mo>
              ⁡
             </mo>
             <mrow>
              <mo>
               [
              </mo>
              <mrow>
               <mo>
                -
               </mo>
               <mrow>
                <msup>
                 <mi>
                  π
                 </mi>
                 <mn>
                  3
                 </mn>
                </msup>
                <mo>
                 ⁢
                </mo>
                <msup>
                 <mrow>
                  <mo stretchy="false">
                   (
                  </mo>
                  <mrow>
                   <msub>
                    <mi>
                     f
                    </mi>
                    <mi>
                     c
                    </mi>
                   </msub>
                   <mo>
                    ⁢
                   </mo>
                   <msub>
                    <mi>
                     t
                    </mi>
                    <mi>
                     d
                    </mi>
                   </msub>
                  </mrow>
                  <mo stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mn>
                  2
                 </mn>
                </msup>
               </mrow>
              </mrow>
              <mo>
               ]
              </mo>
             </mrow>
            </mrow>
            <mo rspace="12.5pt">
             ,
            </mo>
           </mrow>
          </mtd>
          <mtd>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="left">
           <mrow>
            <mrow>
             <mrow>
              <mi>
               F
              </mi>
              <mo>
               ⁢
              </mo>
              <mrow>
               <mo stretchy="false">
                (
               </mo>
               <mi>
                t
               </mi>
               <mo stretchy="false">
                )
               </mo>
              </mrow>
             </mrow>
             <mo>
              =
             </mo>
             <mn>
              0
             </mn>
            </mrow>
            <mo rspace="12.5pt">
             ,
            </mo>
           </mrow>
          </mtd>
          <mtd columnalign="left">
           <mrow>
            <mrow>
             <mi>
              t
             </mi>
             <mo>
              ∈
             </mo>
             <mrow>
              <mo stretchy="false">
               (
              </mo>
              <msub>
               <mi>
                t
               </mi>
               <mi>
                M
               </mi>
              </msub>
              <mo>
               ,
              </mo>
              <mi mathvariant="normal">
               ∞
              </mi>
              <mo stretchy="false">
               )
              </mo>
             </mrow>
            </mrow>
            <mo>
             ,
            </mo>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde
    </p>
    <div class="row formula" id="eS3_E16">
     <a name="S3_E16">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (16)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <msub>
           <mi>
            t
           </mi>
           <mi>
            M
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mrow>
           <mn>
            2
           </mn>
           <mo>
            ⁢
           </mo>
           <msub>
            <mi>
             t
            </mi>
            <mn>
             0
            </mn>
           </msub>
          </mrow>
          <mo>
           =
          </mo>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mn>
              4
             </mn>
             <mo>
              ⁢
             </mo>
             <msqrt>
              <mi>
               π
              </mi>
             </msqrt>
            </mrow>
            <msub>
             <mi>
              f
             </mi>
             <mrow>
              <mi>
               c
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               o
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               r
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               t
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               e
              </mi>
             </mrow>
            </msub>
           </mfrac>
          </mstyle>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Definindo o parâmetros
     <i>
      i
     </i>
     <sub>
      <i>
       V
      </i>
     </sub>
     como (Gaussiana)
    </p>
    <div class="row formula" id="eS3_E17">
     <a name="S3_E17">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (17)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <msub>
            <mi>
             i
            </mi>
            <mi>
             V
            </mi>
           </msub>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo stretchy="false">
             (
            </mo>
            <mi>
             t
            </mi>
            <mo stretchy="false">
             )
            </mo>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mi>
              A
             </mi>
             <mrow>
              <mn>
               2
              </mn>
              <mo>
               ⁢
              </mo>
              <mi>
               π
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mrow>
                <mo stretchy="false">
                 (
                </mo>
                <mrow>
                 <mi>
                  π
                 </mi>
                 <mo>
                  ⁢
                 </mo>
                 <msub>
                  <mi>
                   f
                  </mi>
                  <mi>
                   c
                  </mi>
                 </msub>
                </mrow>
                <mo stretchy="false">
                 )
                </mo>
               </mrow>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mrow>
             <mo>
              [
             </mo>
             <mrow>
              <mo>
               -
              </mo>
              <mrow>
               <mi>
                π
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mrow>
                 <mo stretchy="false">
                  (
                 </mo>
                 <mrow>
                  <mi>
                   π
                  </mi>
                  <mo>
                   ⁢
                  </mo>
                  <msub>
                   <mi>
                    f
                   </mi>
                   <mi>
                    c
                   </mi>
                  </msub>
                  <mo>
                   ⁢
                  </mo>
                  <msub>
                   <mi>
                    t
                   </mi>
                   <mi>
                    d
                   </mi>
                  </msub>
                 </mrow>
                 <mo stretchy="false">
                  )
                 </mo>
                </mrow>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
             </mrow>
             <mo>
              ]
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde
     <i>
      A
     </i>
     é uma amplitude, introduzida por conveniência e, além disso, considerando a densidade de forças externas nula, ou seja,
    </p>
    <div class="row formula" id="eS3_E18">
     <a name="S3_E18">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (18)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mover accent="true">
           <mi>
            f
           </mi>
           <mo stretchy="false">
            →
           </mo>
          </mover>
          <mo>
           =
          </mo>
          <mover accent="true">
           <mn>
            0
           </mn>
           <mo stretchy="false">
            →
           </mo>
          </mover>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     obtém-se o termo fonte visto acima. Com isto todos os termos fonte nas equações da acústica podem ser obtidos a partir das derivadas primeira e segunda de
     <i>
      i
     </i>
     <sub>
      <i>
       V
      </i>
     </sub>
     , que por sua vez podem são dadas por
    </p>
    <div class="row formula" id="eS3_E19">
     <a name="S3_E19">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (19)
       </span>
       <math display="block">
        <mrow>
         <mstyle displaystyle="true">
          <mfrac>
           <mrow>
            <mo>
             ∂
            </mo>
            <mo>
             ⁡
            </mo>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              V
             </mi>
            </msub>
           </mrow>
           <mrow>
            <mo>
             ∂
            </mo>
            <mo>
             ⁡
            </mo>
            <mi>
             t
            </mi>
           </mrow>
          </mfrac>
         </mstyle>
         <mo>
          =
         </mo>
         <mrow>
          <mo>
           -
          </mo>
          <mrow>
           <mi>
            A
           </mi>
           <mo>
            ⁢
           </mo>
           <msub>
            <mi>
             t
            </mi>
            <mi>
             d
            </mi>
           </msub>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mrow>
             <mo>
              [
             </mo>
             <mrow>
              <mo>
               -
              </mo>
              <mrow>
               <mi>
                π
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mrow>
                 <mo stretchy="false">
                  (
                 </mo>
                 <mrow>
                  <mi>
                   π
                  </mi>
                  <mo>
                   ⁢
                  </mo>
                  <msub>
                   <mi>
                    f
                   </mi>
                   <mi>
                    c
                   </mi>
                  </msub>
                  <mo>
                   ⁢
                  </mo>
                  <msub>
                   <mi>
                    t
                   </mi>
                   <mi>
                    d
                   </mi>
                  </msub>
                 </mrow>
                 <mo stretchy="false">
                  )
                 </mo>
                </mrow>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
             </mrow>
             <mo>
              ]
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <div class="row formula" id="eS3_E20">
     <a name="S3_E20">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (20)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <msup>
              <mo>
               ∂
              </mo>
              <mn>
               2
              </mn>
             </msup>
             <mo>
              ⁡
             </mo>
             <msub>
              <mi>
               i
              </mi>
              <mi>
               V
              </mi>
             </msub>
            </mrow>
            <mrow>
             <mo>
              ∂
             </mo>
             <mo>
              ⁡
             </mo>
             <msup>
              <mi>
               t
              </mi>
              <mn>
               2
              </mn>
             </msup>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           =
          </mo>
          <mrow>
           <mi>
            A
           </mi>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo>
             [
            </mo>
            <mrow>
             <mrow>
              <mn>
               2
              </mn>
              <mo>
               ⁢
              </mo>
              <mi>
               π
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mrow>
                <mo>
                 (
                </mo>
                <mrow>
                 <mi>
                  π
                 </mi>
                 <mo>
                  ⁢
                 </mo>
                 <msub>
                  <mi>
                   f
                  </mi>
                  <mi>
                   c
                  </mi>
                 </msub>
                 <mo>
                  ⁢
                 </mo>
                 <msub>
                  <mi>
                   t
                  </mi>
                  <mi>
                   d
                  </mi>
                 </msub>
                </mrow>
                <mo>
                 )
                </mo>
               </mrow>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
             <mo>
              -
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mo>
             ]
            </mo>
           </mrow>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mrow>
             <mo>
              [
             </mo>
             <mrow>
              <mo>
               -
              </mo>
              <mrow>
               <mi>
                π
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mrow>
                 <mo stretchy="false">
                  (
                 </mo>
                 <mrow>
                  <mi>
                   π
                  </mi>
                  <mo>
                   ⁢
                  </mo>
                  <msub>
                   <mi>
                    f
                   </mi>
                   <mi>
                    c
                   </mi>
                  </msub>
                  <mo>
                   ⁢
                  </mo>
                  <msub>
                   <mi>
                    t
                   </mi>
                   <mi>
                    d
                   </mi>
                  </msub>
                 </mrow>
                 <mo stretchy="false">
                  )
                 </mo>
                </mrow>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
             </mrow>
             <mo>
              ]
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Na Figura
     <a class="open-asset-modal" data-target="#ModalFigS3_F4" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      4
     </a>
     , são mostrados os gráficos do parâmetro de injeção de massa
     <i>
      i
     </i>
     <sub>
      <i>
       V
      </i>
     </sub>
     e de sua derivada primeira para
     <i>
      A
     </i>
     = 1. Repare que este parâmetro é adimensional, por representar um volume de injeção de massa por volume do meio.
    </p>
    <div class="row fig" id="S3_F4">
     <a name="S3_F4">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS3_F4" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/643166bdd793619e2a0afaef6ca7e193ce856878.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 4
      </strong>
      <br/>
      (a) Parâmetro
      <i>
       i
      </i>
      <sub>
       <i>
        V
       </i>
      </sub>
      injeção de massa (função de Gauss) e (b) derivada primeira de
      <i>
       i
      </i>
      <sub>
       <i>
        V
       </i>
      </sub>
      .
      <br/>
     </div>
    </div>
    <p>
     A transformada de Fourier da fonte é dada por
    </p>
    <div class="row formula" id="eS3_E21">
     <a name="S3_E21">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (21)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mi>
            s
           </mi>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo stretchy="false">
             (
            </mo>
            <mi>
             f
            </mi>
            <mo stretchy="false">
             )
            </mo>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mn>
               2
              </mn>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                f
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
             <mrow>
              <msup>
               <mi>
                π
               </mi>
               <mn>
                2
               </mn>
              </msup>
              <mo>
               ⁢
              </mo>
              <msubsup>
               <mi>
                f
               </mi>
               <mi>
                c
               </mi>
               <mn>
                3
               </mn>
              </msubsup>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mi>
             exp
            </mi>
            <mo>
             ⁡
            </mo>
            <mrow>
             <mo>
              [
             </mo>
             <mstyle displaystyle="true">
              <mfrac>
               <mrow>
                <mo>
                 -
                </mo>
                <msup>
                 <mi>
                  f
                 </mi>
                 <mn>
                  2
                 </mn>
                </msup>
               </mrow>
               <mrow>
                <mi>
                 π
                </mi>
                <mo>
                 ⁢
                </mo>
                <msubsup>
                 <mi>
                  f
                 </mi>
                 <mi>
                  c
                 </mi>
                 <mn>
                  2
                 </mn>
                </msubsup>
               </mrow>
              </mfrac>
             </mstyle>
             <mo>
              ]
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     o que fornece o conteúdo de frequências associados. Com isto, vê-se que a fonte é de banda limitada, sendo
     <i>
      f
     </i>
     <sub>
      <i>
       corte
      </i>
     </sub>
     a máxima frequência presente (Fig.
     <a class="open-asset-modal" data-target="#ModalFigS3_F3" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      3
     </a>
     (b)).
    </p>
    <p>
     O fato da fonte ser de banda limitada é importantíssimo pois, em primeiro lugar, as camadas rochosas por onde a onda se propaga funcionam como um filtro de altas frequências, dissipando energia nesta faixa. Em segundo lugar, para representar o sinal da fonte em termos discretos, existe uma frequência limite que pode ser representada dependendo do tempo de amostragem
     <i>
      t
     </i>
     <sub>
      <i>
       A
      </i>
     </sub>
     utilizado na gravação do registro sísmico (como estabelecido pelo Teorema da Amostragem). Em terceiro lugar, o método das diferenças finitas sofre restrições em relação à máxima frequência que ele consegue aproximar sem que ocorra dispersão numérica, como será discutido posteriormente.
    </p>
    <h2>
     3.2. Condições iniciais e de contorno
    </h2>
    <p>
     Como é bem conhecido da teoria de equações diferenciais parciais, é necessário considerar-se condições de contorno e condições iniciais adequadas para que o problema tenha solução bem definida. Ou seja, trata-se de um problema de valor inicial e de valor de contorno.
    </p>
    <p>
     Em relação às condições iniciais, nos problemas de Sísmica necessita-se apenas de condições triviais. Desta forma, as condições iniciais adequadas e utilizada aqui são de campos de pressão nulo, bem como de derivada temporal nula. Em relação às condições de contorno, classicamente dois tipos de condições de contorno são comumente utilizadas, nomeadamente as condições essenciais (de Dirichlet), com valor do campo prescrito, e as condições naturais (de Neumann), com valor da derivada do campo prescrita. Aqui utilizamos condições essenciais triviais (
     <i>
      p
     </i>
     = 0) em todas as bordas.
    </p>
    <p>
     No contexto da Sísmica, onde o domínio seria melhor representado por um meio semi-infinito, aplicar
     <i>
      p
     </i>
     = 0 em todos os bordos do domínio numérico não é adequado, uma que que isto faz com que toda a onda incidente sobre as interfaces seja refletida. Apenas o topo do modelo deveria ter este comportamento, uma vez que se trata da superfície do mar nas simulações aqui realizadas. Nos demais bordos (nas laterais e na borda inferior), deve-se recorrer a estratégias especiais, chamadas de condições de contorno não-reflexivas, para que as ondas que as atinjam sejam atenuadas e não gerem artefatos numéricos em virtude do truncamento do domínio físico em um domínio computacional de dimensões adequadas.
    </p>
    <p>
     Dito de outra forma, a necessidade de utilização de condições de contorno não-reflexivas se deve ao fato de os problemas que se deseja modelar serem na verdade problemas de domínios semi-infinitos, onde as bordas laterais e inferior devem ser simuladas como “transparentes”, evitando a degradação das soluções pelas reflexões nas bordas numéricas.
    </p>
    <p>
     Uma estratégia simples e muito utilizada para atenuar as reflexões indesejadas nas bordas do modelo constitui-se na aplicação de camadas de absorção [
     <span class="ref">
      <sup class="xref xrefblue">
       10
      </sup>
      <span class="refCtt closed">
       <span>
        10. C. Cerjan, D. Kosloff, R. Kosloff e M. Reshef, Geophysics 50 , 705 (1985).
       </span>
      </span>
     </span>
     ]. Esta zona de amortecimento é criada nos pontos próximos a borda do modelo, como mostrado na Fig.
     <a class="open-asset-modal" data-target="#ModalFigS3_F5" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      5
     </a>
     , sendo a função de amortecimento para o lado esquerdo, em função do ponto espacial
     <i>
      n
     </i>
     , dada por
    </p>
    <div class="row fig" id="S3_F5">
     <a name="S3_F5">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS3_F5" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/11c0a5a867aa174cf7362fa7829f98f70fe0f596.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 5
      </strong>
      <br/>
      A figura da esquerda mostra a exponencial aplicada em 100 pontos na região próxima à borda esquerda e a figura da direita representa a região de amortecimento.
      <br/>
     </div>
    </div>
    <p>
    </p>
    <div class="row formula" id="eS3_E22">
     <a name="S3_E22">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (22)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <msub>
            <mi>
             f
            </mi>
            <mi>
             a
            </mi>
           </msub>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo stretchy="false">
             (
            </mo>
            <mi>
             n
            </mi>
            <mo stretchy="false">
             )
            </mo>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <mi>
            E
           </mi>
           <mo>
            ⁢
           </mo>
           <mi>
            x
           </mi>
           <mo>
            ⁢
           </mo>
           <mi>
            p
           </mi>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo stretchy="false">
             {
            </mo>
            <mrow>
             <mo>
              -
             </mo>
             <msup>
              <mrow>
               <mo stretchy="false">
                [
               </mo>
               <mrow>
                <mi>
                 a
                </mi>
                <mo>
                 ⁢
                </mo>
                <mrow>
                 <mo stretchy="false">
                  (
                 </mo>
                 <mrow>
                  <msub>
                   <mi>
                    N
                   </mi>
                   <mi>
                    P
                   </mi>
                  </msub>
                  <mo>
                   -
                  </mo>
                  <mi>
                   n
                  </mi>
                 </mrow>
                 <mo stretchy="false">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo stretchy="false">
                ]
               </mo>
              </mrow>
              <mn>
               2
              </mn>
             </msup>
            </mrow>
            <mo stretchy="false">
             }
            </mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde
     <i>
      a
     </i>
     é o fator de amortecimento,
     <i>
      N
     </i>
     <sub>
      <i>
       P
      </i>
     </sub>
     é o número de pontos total da camada de amortecimento (em cada um dos lados) e
     <i>
      n
     </i>
     é o ponto espacial. No exemplo apresentado, utilizou-se
     <i>
      a
     </i>
     = 2,5×10
     <sup>
      −4
     </sup>
     e
     <i>
      N
     </i>
     <sub>
      <i>
       P
      </i>
     </sub>
     = 100. Como mostrado, em tais pontos o campo é multiplicado por um fator de decaimento exponencial ponto a ponto, o que reduz gradativamente a amplitude da onda ao se aproximar da borda do modelo. É importante chamar a atenção para o fato de que esta exponencial deve ser aplicada em pontos suficientes (da ordem de 80 a 100 pontos) e deve ser suave, como ilustrado. Outro métodos muito popular na área é denominado de PML (
     <i>
      perfectly matched layers
     </i>
     ) [
     <span class="ref">
      <sup class="xref xrefblue">
       11
      </sup>
      <span class="refCtt closed">
       <span>
        11. J.P. Berenger, Journal of computational physics 114 , 185 (1994).
       </span>
      </span>
     </span>
     ], método que modifica as equações na região próxima às bordas para que seja contemplada absorção de energia de forma perfeita (embora, após discretizadas as equações, a absorção não seja perfeita).
    </p>
    <p>
     Outra estratégia que pode ser combinada com as camadas de amortecimento é a utilização de equações de onda de sentido único (one-way equations). Neste sentido pomos escrever a equação unidimensional da onda podemos fazer:
    </p>
    <p>
    </p>
    <div class="row formula" id="eS3_E23">
     <a name="S3_E23">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (23)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mfrac>
            <mrow>
             <msup>
              <mo>
               ∂
              </mo>
              <mn>
               2
              </mn>
             </msup>
             <mo>
              ⁡
             </mo>
             <mi>
              p
             </mi>
            </mrow>
            <mrow>
             <mo>
              ∂
             </mo>
             <mo>
              ⁡
             </mo>
             <msup>
              <mi>
               x
              </mi>
              <mn>
               2
              </mn>
             </msup>
            </mrow>
           </mfrac>
           <mo>
            -
           </mo>
           <mrow>
            <mfrac>
             <mn>
              1
             </mn>
             <msup>
              <mi>
               c
              </mi>
              <mn>
               2
              </mn>
             </msup>
            </mfrac>
            <mo>
             ⁢
            </mo>
            <mfrac>
             <mrow>
              <msup>
               <mo>
                ∂
               </mo>
               <mn>
                2
               </mn>
              </msup>
              <mo>
               ⁡
              </mo>
              <mi>
               p
              </mi>
             </mrow>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <msup>
               <mi>
                t
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <munder>
            <munder accentunder="true">
             <mrow>
              <mo movablelimits="false">
               (
              </mo>
              <mrow>
               <mfrac>
                <mo movablelimits="false">
                 ∂
                </mo>
                <mrow>
                 <mo movablelimits="false">
                  ∂
                 </mo>
                 <mo movablelimits="false">
                  ⁡
                 </mo>
                 <mi>
                  x
                 </mi>
                </mrow>
               </mfrac>
               <mo movablelimits="false">
                +
               </mo>
               <mrow>
                <mfrac>
                 <mn>
                  1
                 </mn>
                 <mi>
                  c
                 </mi>
                </mfrac>
                <mo movablelimits="false">
                 ⁢
                </mo>
                <mfrac>
                 <mo movablelimits="false">
                  ∂
                 </mo>
                 <mrow>
                  <mo movablelimits="false">
                   ∂
                  </mo>
                  <mo movablelimits="false">
                   ⁡
                  </mo>
                  <mi>
                   t
                  </mi>
                 </mrow>
                </mfrac>
               </mrow>
              </mrow>
              <mo movablelimits="false">
               )
              </mo>
             </mrow>
             <mo movablelimits="false">
              ⏟
             </mo>
            </munder>
            <mrow>
             <mi>
              p
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              a
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              r
             </mi>
             <mo>
              ⁢
             </mo>
             <mpadded width="+1.7pt">
              <mi>
               a
              </mi>
             </mpadded>
             <mo>
              ⁢
             </mo>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              i
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              r
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              e
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              i
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              t
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              a
             </mi>
            </mrow>
           </munder>
           <mo>
            ⁢
           </mo>
           <munder>
            <munder accentunder="true">
             <mrow>
              <mo movablelimits="false">
               (
              </mo>
              <mrow>
               <mfrac>
                <mo movablelimits="false">
                 ∂
                </mo>
                <mrow>
                 <mo movablelimits="false">
                  ∂
                 </mo>
                 <mo movablelimits="false">
                  ⁡
                 </mo>
                 <mi>
                  x
                 </mi>
                </mrow>
               </mfrac>
               <mo movablelimits="false">
                -
               </mo>
               <mrow>
                <mfrac>
                 <mn>
                  1
                 </mn>
                 <mi>
                  c
                 </mi>
                </mfrac>
                <mo movablelimits="false">
                 ⁢
                </mo>
                <mfrac>
                 <mo movablelimits="false">
                  ∂
                 </mo>
                 <mrow>
                  <mo movablelimits="false">
                   ∂
                  </mo>
                  <mo movablelimits="false">
                   ⁡
                  </mo>
                  <mi>
                   t
                  </mi>
                 </mrow>
                </mfrac>
               </mrow>
              </mrow>
              <mo movablelimits="false">
               )
              </mo>
             </mrow>
             <mo movablelimits="false">
              ⏟
             </mo>
            </munder>
            <mrow>
             <mi>
              p
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              a
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              r
             </mi>
             <mo>
              ⁢
             </mo>
             <mpadded width="+1.7pt">
              <mi>
               a
              </mi>
             </mpadded>
             <mo>
              ⁢
             </mo>
             <mi>
              e
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              s
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              q
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              u
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              e
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              r
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              a
             </mi>
            </mrow>
           </munder>
           <mo>
            ⁢
           </mo>
           <mi>
            p
           </mi>
          </mrow>
          <mo>
           =
          </mo>
          <mn>
           0
          </mn>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde identificamos cada um dos operadores diferenciais como responsável por fazer a onda pra pagar para cada um dos sentidos (direita ou esquerda), que dão origem a solução completa da equação da onda, a conhecida solução de D’Alembert. A partir da fatoração acima, podemos escrever as equações unidirecionais da onda:
    </p>
    <div class="row formula" id="eS3_E24">
     <a name="S3_E24">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (24)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mo>
              ∂
             </mo>
             <mo>
              ⁡
             </mo>
             <mi>
              p
             </mi>
            </mrow>
            <mrow>
             <mo>
              ∂
             </mo>
             <mo>
              ⁡
             </mo>
             <mi>
              x
             </mi>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           +
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mn>
              1
             </mn>
             <mi>
              c
             </mi>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <mi>
               p
              </mi>
             </mrow>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <mi>
               t
              </mi>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
         </mrow>
         <mo>
          =
         </mo>
         <mn>
          0
         </mn>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <div class="row formula" id="eS3_E25">
     <a name="S3_E25">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (25)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <mi>
               p
              </mi>
             </mrow>
             <mrow>
              <mo>
               ∂
              </mo>
              <mo>
               ⁡
              </mo>
              <mi>
               x
              </mi>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            -
           </mo>
           <mrow>
            <mstyle displaystyle="true">
             <mfrac>
              <mn>
               1
              </mn>
              <mi>
               c
              </mi>
             </mfrac>
            </mstyle>
            <mo>
             ⁢
            </mo>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <mo>
                ∂
               </mo>
               <mo>
                ⁡
               </mo>
               <mi>
                p
               </mi>
              </mrow>
              <mrow>
               <mo>
                ∂
               </mo>
               <mo>
                ⁡
               </mo>
               <mi>
                t
               </mi>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mn>
           0
          </mn>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     A segunda equação é aplicada nos pontos da borda esquerda, o que tem o efeito de reduzir a reflexão da onda que atinge esta borda enquanto se propaga no meio 2D. A primeira equação é aplicada na borda direita e uma equação similar para a componente
     <i>
      z
     </i>
     é aplicada na borda inferior.
    </p>
    <p>
     Para exemplificar a eficácia destas estratégias, é apresentada uma modelagem acústica para um meio de três camadas planas horizontais e homogêneas (Fig.
     <a class="open-asset-modal" data-target="#ModalFigS3_F6" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      6
     </a>
     ). O efeito da aplicação isolada da equação one-way [
     <span class="ref">
      <sup class="xref xrefblue">
       12
      </sup>
      <span class="refCtt closed">
       <span>
        12. D. Loewenthal, P.L. Stoffa e E.L. Faria, Geophysics 52 , 1007 (1987).
       </span>
      </span>
     </span>
     ] é mostrada na Fig.
     <a class="open-asset-modal" data-target="#ModalFigS3_F6" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      6
     </a>
     (a) e o efeito combinado da aplicação desta e das camadas de Cerjan é mostrado na Fig.
     <a class="open-asset-modal" data-target="#ModalFigS3_F6" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      6
     </a>
     (b). Pode-se ver, que as reflexões nas bordas não são mais visíveis, uma vez que apresentam amplitude consideravelmente menor que as demais amplitudes presentes. Pode-se obter bons resultados aplicando-se apenas as camadas de Cerjan, como feito neste trabalho.
    </p>
    <div class="row fig" id="S3_F6">
     <a name="S3_F6">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS3_F6" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/21e518b85dbaaa3f504ad78ad9f800de8736f96b.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 6
      </strong>
      <br/>
      Condições de contorno simulando meios semi-infinitos, aplicando-se: (a) a equação
      <i>
       one-way
      </i>
      da onda isoladamente e (b) esta em conjunto com as camadas de amortecimento de Cerjan. Apenas na borda superior utilizou-se
      <i>
       p
      </i>
      = 0.
      <br/>
     </div>
    </div>
    <h1 class="articleSectionTitle">
     4. Soluções numéricas
    </h1>
    <p>
     Neste seção, primeiro serão apresentadas as ideias básicas do Método das Diferenças Finitas (MDF), com o objetivo de descrever em detalhes a formulação numérica explícita que será adotada. Para um aprofundamento do tema, reporta-se à vasta bibliografia especializada sobre o tema, em especial, ao excelente livro texto [
     <span class="ref">
      <sup class="xref xrefblue">
       13
      </sup>
      <span class="refCtt closed">
       <span>
        13. J.W. Thomas, Numerical partial differential equations: finite difference methods (Springer Science &amp; Business Media, Berlim, 1995), v. 22.
       </span>
      </span>
     </span>
     ]. Outros livros sobre o MDF contém informação adicional e introdutória são [
     <span class="ref">
      <sup class="xref xrefblue">
       14
      </sup>
      <span class="refCtt closed">
       <span>
        14. J.C. Strikwerda, Finite difference schemes and partial differential equations (SIAM, Pensilvânia, 2004), 2ª ed.
       </span>
      </span>
     </span>
     ,
     <span class="ref">
      <sup class="xref xrefblue">
       15
      </sup>
      <span class="refCtt closed">
       <span>
        15. R.J. LeVeque, Finite difference methods for ordinary and partial differential equations: steady-state and time-dependent problems (SIAM, Pensilvânia, 2007).
       </span>
      </span>
     </span>
     ], podendo ser consultados outros bons livros textos mais gerais de métodos numéricos [
     <span class="ref">
      <sup class="xref xrefblue">
       16
      </sup>
      <span class="refCtt closed">
       <span>
        16. I.P. Mysovskih, Lectures on Numerical Methods (Wolters-Noordhoff Plublishin Groningen, Netherlands, 1969).
       </span>
      </span>
     </span>
     ,
     <span class="ref">
      <sup class="xref xrefblue">
       17
      </sup>
      <span class="refCtt closed">
       <span>
        17. V.S. Ryaben’Kii e S.V. Tsynkov, A theoretical introduction to numerical analysis (Chapman &amp; Hall/CRC, New York, 2007).
       </span>
      </span>
     </span>
     ,
     <span class="ref">
      <sup class="xref xrefblue">
       18
      </sup>
      <span class="refCtt closed">
       <span>
        18. E. Isaacson e H.B. Keller, Analysis of numerical methods (Dover Inc, Illinois, 1994), 1ª ed.
       </span>
      </span>
     </span>
     ,
     <span class="ref">
      <sup class="xref xrefblue">
       19
      </sup>
      <span class="refCtt closed">
       <span>
        19. K.J. Bathe, Finite Element Procedures (Prentice-Hall, New Jersey, 1996), 2ª ed.
       </span>
      </span>
     </span>
     ].
    </p>
    <h2>
     4.1. O Método das Diferenças Finitas
    </h2>
    <p>
     O Método das Diferenças Finitas (MDF) é um dos métodos numéricos mais simples e intuitivos utilizados para resolução de equações diferenciais, podendo ser utilizado para obter soluções numéricas de uma vasta gama de equações.
    </p>
    <p>
     O seu princípio básico é o de que as equações diferenciais são válidas ponto a ponto do domínio, podendo ser empregadas aproximações de diferenças finitas ponto a ponto desta
     <i>
      malha
     </i>
     para obter equações algébricas que irão fornecer
     <i>
      soluções numéricas
     </i>
     das equações. A Fig.
     <a class="open-asset-modal" data-target="#ModalFigS4_F7" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      7
     </a>
     mostra a malha, com espaçamentos fixos Δ
     <i>
      x
     </i>
     e Δ
     <i>
      z
     </i>
     , respectivamente, nas direções
     <i>
      x
     </i>
     e
     <i>
      z
     </i>
     . No MDF, usualmente, também é adotado um incremento temporal fixo para a solução de equações dependentes do tempo. Desta forma, as funções e propriedades de interesse são consideradas apenas nestes pontos discretos
     <i>
      P
     </i>
     (
     <i>
      x
     </i>
     <sub>
      <i>
       i
      </i>
     </sub>
     ,
     <i>
      z
     </i>
     <sub>
      <i>
       j
      </i>
     </sub>
     ,
     <i>
      t
     </i>
     <sub>
      <i>
       n
      </i>
     </sub>
     ) =
     <i>
      P
     </i>
     (
     <i>
      i
     </i>
     Δ
     <i>
      x
     </i>
     ,
     <i>
      k
     </i>
     Δ
     <i>
      z
     </i>
     ,
     <i>
      n
     </i>
     Δ
     <i>
      t
     </i>
     ). Repare que o eixo
     <i>
      z
     </i>
     é apontado para baixo e será considerado o zero na superfície da Terra.
    </p>
    <div class="row fig" id="S4_F7">
     <a name="S4_F7">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS4_F7" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/6c06aa40a5a1c1d76537f4d48e8bd3fc2412701d.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 7
      </strong>
      <br/>
      Malha simples de Diferenças Finitas.
      <br/>
     </div>
    </div>
    <p>
     São obtidas então expressões aproximadas para as derivadas nestes pontos discretos, sendo elas denominadas aproximações de diferenças finitas ou simplesmente
     <i>
      diferenças finitas
     </i>
     , podendo estas serem de diferentes ordens de precisão, dependendo do número de pontos utilizados, como será visto a seguir.
    </p>
    <h3>
     4.1.1. Operadores de diferenças finitas
    </h3>
    <p>
     Considere
     <i>
      f
     </i>
     (
     <i>
      x
     </i>
     ) então uma função contínua, bem como suas derivadas. Pode-se desenvolver esta função em série de Taylor em torno do ponto
     <i>
      x
     </i>
     <sub>
      0
     </sub>
     :
    </p>
    <p>
    </p>
    <div class="row formula" id="eS4_E26">
     <a name="S4_E26">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (26)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mi>
            f
           </mi>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo stretchy="false">
             (
            </mo>
            <mi>
             x
            </mi>
            <mo stretchy="false">
             )
            </mo>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <msub>
            <mrow>
             <mrow>
              <munderover>
               <mo largeop="true" movablelimits="false" symmetric="true">
                ∑
               </mo>
               <mrow>
                <mi>
                 n
                </mi>
                <mo>
                 =
                </mo>
                <mn>
                 0
                </mn>
               </mrow>
               <mi mathvariant="normal">
                ∞
               </mi>
              </munderover>
              <mrow>
               <mfrac>
                <mn>
                 1
                </mn>
                <mrow>
                 <mi>
                  n
                 </mi>
                 <mo>
                  !
                 </mo>
                </mrow>
               </mfrac>
               <mo>
                ⁢
               </mo>
               <mfrac>
                <mrow>
                 <msup>
                  <mi>
                   d
                  </mi>
                  <mi>
                   n
                  </mi>
                 </msup>
                 <mo>
                  ⁢
                 </mo>
                 <mi>
                  f
                 </mi>
                 <mo>
                  ⁢
                 </mo>
                 <mrow>
                  <mo stretchy="false">
                   (
                  </mo>
                  <mi>
                   x
                  </mi>
                  <mo stretchy="false">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mrow>
                 <mi>
                  d
                 </mi>
                 <mo>
                  ⁢
                 </mo>
                 <msup>
                  <mi>
                   x
                  </mi>
                  <mi>
                   n
                  </mi>
                 </msup>
                </mrow>
               </mfrac>
              </mrow>
             </mrow>
             <mo fence="true" maxsize="210%" minsize="210%">
              |
             </mo>
            </mrow>
            <mrow>
             <mi>
              x
             </mi>
             <mo>
              =
             </mo>
             <msub>
              <mi>
               x
              </mi>
              <mn>
               0
              </mn>
             </msub>
            </mrow>
           </msub>
           <mo>
            ⁢
           </mo>
           <msup>
            <mrow>
             <mo stretchy="false">
              (
             </mo>
             <mrow>
              <mi>
               x
              </mi>
              <mo>
               -
              </mo>
              <msub>
               <mi>
                x
               </mi>
               <mn>
                0
               </mn>
              </msub>
             </mrow>
             <mo stretchy="false">
              )
             </mo>
            </mrow>
            <mi>
             n
            </mi>
           </msup>
          </mrow>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Para obter as diferenças finitas que serão utilizadas nas formulações numéricas deste trabalho, o valor da função deve ser desenvolvido em série de Taylor em diferentes pontos
     <i>
      x
     </i>
     =
     <i>
      x
     </i>
     <sub>
      <i>
       i
      </i>
     </sub>
     +
     <i>
      l
     </i>
     Δ
     <i>
      x
     </i>
     , onde
     <i>
      l
     </i>
     ∈ Z, em torno de
     <i>
      x
     </i>
     <sub>
      <i>
       i
      </i>
     </sub>
     , isto é,
    </p>
    <p>
    </p>
    <div class="row formula" id="eS4_E27">
     <a name="S4_E27">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (27)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <msub>
           <mpadded lspace="-1.7pt" width="-1.7pt">
            <mi>
             f
            </mi>
           </mpadded>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ±
            </mo>
            <mi>
             l
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mrow>
           <mi>
            f
           </mi>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo stretchy="false">
             (
            </mo>
            <mrow>
             <msub>
              <mi>
               x
              </mi>
              <mi>
               i
              </mi>
             </msub>
             <mo>
              ±
             </mo>
             <mrow>
              <mi>
               l
              </mi>
              <mo>
               ⁢
              </mo>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               x
              </mi>
             </mrow>
            </mrow>
            <mo stretchy="false">
             )
            </mo>
           </mrow>
          </mrow>
          <mo>
           =
          </mo>
          <mrow>
           <msub>
            <mrow>
             <mrow>
              <munderover>
               <mo largeop="true" movablelimits="false" symmetric="true">
                ∑
               </mo>
               <mrow>
                <mi>
                 n
                </mi>
                <mo>
                 =
                </mo>
                <mn>
                 0
                </mn>
               </mrow>
               <mi mathvariant="normal">
                ∞
               </mi>
              </munderover>
              <mrow>
               <mfrac>
                <mn>
                 1
                </mn>
                <mrow>
                 <mi>
                  n
                 </mi>
                 <mo>
                  !
                 </mo>
                </mrow>
               </mfrac>
               <mo>
                ⁢
               </mo>
               <mfrac>
                <mrow>
                 <msup>
                  <mi>
                   d
                  </mi>
                  <mi>
                   n
                  </mi>
                 </msup>
                 <mo>
                  ⁢
                 </mo>
                 <mi>
                  f
                 </mi>
                 <mo>
                  ⁢
                 </mo>
                 <mrow>
                  <mo stretchy="false">
                   (
                  </mo>
                  <mi>
                   x
                  </mi>
                  <mo stretchy="false">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mrow>
                 <mi>
                  d
                 </mi>
                 <mo>
                  ⁢
                 </mo>
                 <msup>
                  <mi>
                   x
                  </mi>
                  <mi>
                   n
                  </mi>
                 </msup>
                </mrow>
               </mfrac>
              </mrow>
             </mrow>
             <mo fence="true" maxsize="210%" minsize="210%">
              |
             </mo>
            </mrow>
            <mrow>
             <mi>
              x
             </mi>
             <mo>
              =
             </mo>
             <msub>
              <mi>
               x
              </mi>
              <mi>
               i
              </mi>
             </msub>
            </mrow>
           </msub>
           <mo>
            ⁢
           </mo>
           <msup>
            <mrow>
             <mo stretchy="false">
              (
             </mo>
             <mrow>
              <mo>
               ±
              </mo>
              <mrow>
               <mi>
                l
               </mi>
               <mo>
                ⁢
               </mo>
               <mi mathvariant="normal">
                Δ
               </mi>
               <mo>
                ⁢
               </mo>
               <mi>
                x
               </mi>
              </mrow>
             </mrow>
             <mo stretchy="false">
              )
             </mo>
            </mrow>
            <mi>
             n
            </mi>
           </msup>
          </mrow>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Soma-se, então, as diferentes expressões obtidas a fim de cancelar os termos até a ordem de interesse da derivada em questão. Como será visto, quanto maior a ordem de aproximação, mais pontos precisam ser considerados. A seguir, serão obtidos os operadores de diferenças finitas em segunda e quarta ordens
     <span class="ref footnote">
      <sup class="xref">
       1
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        <strong class="fn-title">
         1
        </strong>
        n-ésima ordem na variável x significa que o erro de truncamento da série de Taylor da aproximação via DF seja da ordem da n-ésima potência do equivalente espaçamento da malha, isto é, Δxn.
       </span>
      </span>
     </span>
     de aproximação em Δ
     <i>
      x
     </i>
     .
    </p>
    <p>
     Assim, considere os seguintes desenvolvimentos (
     <i>
      l
     </i>
     = ±1):
    </p>
    <div class="row formula" id="eS4_E28">
     <a name="S4_E28">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (28)
       </span>
       <math display="block">
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            f
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           +
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               x
              </mi>
             </mrow>
             <mrow>
              <mn>
               1
              </mn>
              <mo>
               !
              </mo>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mi>
               d
              </mi>
              <mo>
               ⁢
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mi>
                i
               </mi>
              </msub>
             </mrow>
             <mrow>
              <mi>
               d
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               x
              </mi>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
          <mo>
           +
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
             <mrow>
              <mn>
               2
              </mn>
              <mo>
               !
              </mo>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <msup>
               <mi>
                d
               </mi>
               <mn>
                2
               </mn>
              </msup>
              <mo>
               ⁢
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mi>
                i
               </mi>
              </msub>
             </mrow>
             <mrow>
              <mi>
               d
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
          <mo>
           +
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                3
               </mn>
              </msup>
             </mrow>
             <mrow>
              <mn>
               3
              </mn>
              <mo>
               !
              </mo>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <msup>
               <mi>
                d
               </mi>
               <mn>
                3
               </mn>
              </msup>
              <mo>
               ⁢
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mi>
                i
               </mi>
              </msub>
             </mrow>
             <mrow>
              <mi>
               d
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                3
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
         </mrow>
        </mrow>
       </math>
       <math display="block">
        <mrow>
         <mi mathvariant="normal">
         </mi>
         <mo>
          +
         </mo>
         <mrow>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mi mathvariant="normal">
              Δ
             </mi>
             <mo>
              ⁢
             </mo>
             <msup>
              <mi>
               x
              </mi>
              <mn>
               4
              </mn>
             </msup>
            </mrow>
            <mrow>
             <mn>
              4
             </mn>
             <mo>
              !
             </mo>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           ⁢
          </mo>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <msup>
              <mi>
               d
              </mi>
              <mn>
               4
              </mn>
             </msup>
             <mo>
              ⁢
             </mo>
             <msub>
              <mi>
               f
              </mi>
              <mi>
               i
              </mi>
             </msub>
            </mrow>
            <mrow>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <msup>
              <mi>
               x
              </mi>
              <mn>
               4
              </mn>
             </msup>
            </mrow>
           </mfrac>
          </mstyle>
         </mrow>
         <mo>
          +
         </mo>
         <mrow>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mi mathvariant="normal">
              Δ
             </mi>
             <mo>
              ⁢
             </mo>
             <msup>
              <mi>
               x
              </mi>
              <mn>
               5
              </mn>
             </msup>
            </mrow>
            <mrow>
             <mn>
              5
             </mn>
             <mo>
              !
             </mo>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           ⁢
          </mo>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <msup>
              <mi>
               d
              </mi>
              <mn>
               5
              </mn>
             </msup>
             <mo>
              ⁢
             </mo>
             <msub>
              <mi>
               f
              </mi>
              <mi>
               i
              </mi>
             </msub>
            </mrow>
            <mrow>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <msup>
              <mi>
               x
              </mi>
              <mn>
               5
              </mn>
             </msup>
            </mrow>
           </mfrac>
          </mstyle>
         </mrow>
         <mo>
          +
         </mo>
         <mi mathvariant="normal">
          …
         </mi>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <div class="row formula" id="eS4_E29">
     <a name="S4_E29">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (29)
       </span>
       <math display="block">
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            -
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mo>
          =
         </mo>
         <mrow>
          <mrow>
           <mrow>
            <msub>
             <mi>
              f
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mo>
             -
            </mo>
            <mrow>
             <mstyle displaystyle="true">
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 Δ
                </mi>
                <mo>
                 ⁢
                </mo>
                <mi>
                 x
                </mi>
               </mrow>
               <mrow>
                <mn>
                 1
                </mn>
                <mo>
                 !
                </mo>
               </mrow>
              </mfrac>
             </mstyle>
             <mo>
              ⁢
             </mo>
             <mstyle displaystyle="true">
              <mfrac>
               <mrow>
                <mi>
                 d
                </mi>
                <mo>
                 ⁢
                </mo>
                <msub>
                 <mi>
                  f
                 </mi>
                 <mi>
                  i
                 </mi>
                </msub>
               </mrow>
               <mrow>
                <mi>
                 d
                </mi>
                <mo>
                 ⁢
                </mo>
                <mi>
                 x
                </mi>
               </mrow>
              </mfrac>
             </mstyle>
            </mrow>
           </mrow>
           <mo>
            +
           </mo>
           <mrow>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <mi mathvariant="normal">
                Δ
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
              <mrow>
               <mn>
                2
               </mn>
               <mo>
                !
               </mo>
              </mrow>
             </mfrac>
            </mstyle>
            <mo>
             ⁢
            </mo>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <msup>
                <mi>
                 d
                </mi>
                <mn>
                 2
                </mn>
               </msup>
               <mo>
                ⁢
               </mo>
               <msub>
                <mi>
                 f
                </mi>
                <mi>
                 i
                </mi>
               </msub>
              </mrow>
              <mrow>
               <mi>
                d
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
          </mrow>
          <mo>
           -
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                3
               </mn>
              </msup>
             </mrow>
             <mrow>
              <mn>
               3
              </mn>
              <mo>
               !
              </mo>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <msup>
               <mi>
                d
               </mi>
               <mn>
                3
               </mn>
              </msup>
              <mo>
               ⁢
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mi>
                i
               </mi>
              </msub>
             </mrow>
             <mrow>
              <mi>
               d
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                3
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
         </mrow>
        </mrow>
       </math>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <mi mathvariant="normal">
            </mi>
            <mo>
             +
            </mo>
            <mrow>
             <mstyle displaystyle="true">
              <mfrac>
               <mrow>
                <mi mathvariant="normal">
                 Δ
                </mi>
                <mo>
                 ⁢
                </mo>
                <msup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  4
                 </mn>
                </msup>
               </mrow>
               <mrow>
                <mn>
                 4
                </mn>
                <mo>
                 !
                </mo>
               </mrow>
              </mfrac>
             </mstyle>
             <mo>
              ⁢
             </mo>
             <mstyle displaystyle="true">
              <mfrac>
               <mrow>
                <msup>
                 <mi>
                  d
                 </mi>
                 <mn>
                  4
                 </mn>
                </msup>
                <mo>
                 ⁢
                </mo>
                <msub>
                 <mi>
                  f
                 </mi>
                 <mi>
                  i
                 </mi>
                </msub>
               </mrow>
               <mrow>
                <mi>
                 d
                </mi>
                <mo>
                 ⁢
                </mo>
                <msup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  4
                 </mn>
                </msup>
               </mrow>
              </mfrac>
             </mstyle>
            </mrow>
           </mrow>
           <mo>
            -
           </mo>
           <mrow>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <mi mathvariant="normal">
                Δ
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 5
                </mn>
               </msup>
              </mrow>
              <mrow>
               <mn>
                5
               </mn>
               <mo>
                !
               </mo>
              </mrow>
             </mfrac>
            </mstyle>
            <mo>
             ⁢
            </mo>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <msup>
                <mi>
                 d
                </mi>
                <mn>
                 5
                </mn>
               </msup>
               <mo>
                ⁢
               </mo>
               <msub>
                <mi>
                 f
                </mi>
                <mi>
                 i
                </mi>
               </msub>
              </mrow>
              <mrow>
               <mi>
                d
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 5
                </mn>
               </msup>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
          </mrow>
          <mo>
           +
          </mo>
          <mi mathvariant="normal">
           …
          </mi>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde
     <i>
      df
     </i>
     <sub>
      <i>
       i
      </i>
     </sub>
     /
     <i>
      dx
     </i>
     é a derivada considerada no ponto
     <i>
      x
     </i>
     =
     <i>
      x
     </i>
     <sub>
      <i>
       i
      </i>
     </sub>
     .
    </p>
    <p>
     Fazendo-se a Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E29" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      29
     </a>
     menos a Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E28" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      28
     </a>
     , obtém-se a expressão em segunda ordem de aproximação:
    </p>
    <div class="row formula" id="eS4_E30">
     <a name="S4_E30">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (30)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <msub>
              <mi>
               f
              </mi>
              <mi>
               i
              </mi>
             </msub>
            </mrow>
            <mrow>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              x
             </mi>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           =
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <msub>
               <mi>
                f
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 +
                </mo>
                <mn>
                 1
                </mn>
               </mrow>
              </msub>
              <mo>
               -
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 -
                </mo>
                <mn>
                 1
                </mn>
               </mrow>
              </msub>
             </mrow>
             <mrow>
              <mn>
               2
              </mn>
              <mo>
               ⁢
              </mo>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               x
              </mi>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            -
           </mo>
           <mrow>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <mi mathvariant="normal">
                Δ
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
              <mrow>
               <mn>
                3
               </mn>
               <mo>
                !
               </mo>
              </mrow>
             </mfrac>
            </mstyle>
            <mo>
             ⁢
            </mo>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <msup>
                <mi>
                 d
                </mi>
                <mn>
                 3
                </mn>
               </msup>
               <mo>
                ⁢
               </mo>
               <msub>
                <mi>
                 f
                </mi>
                <mi>
                 i
                </mi>
               </msub>
              </mrow>
              <mrow>
               <mi>
                d
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 3
                </mn>
               </msup>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
           <mo>
            -
           </mo>
           <mrow>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <mi mathvariant="normal">
                Δ
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 4
                </mn>
               </msup>
              </mrow>
              <mrow>
               <mn>
                5
               </mn>
               <mo>
                !
               </mo>
              </mrow>
             </mfrac>
            </mstyle>
            <mo>
             ⁢
            </mo>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <msup>
                <mi>
                 d
                </mi>
                <mn>
                 5
                </mn>
               </msup>
               <mo>
                ⁢
               </mo>
               <msub>
                <mi>
                 f
                </mi>
                <mi>
                 i
                </mi>
               </msub>
              </mrow>
              <mrow>
               <mi>
                d
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 5
                </mn>
               </msup>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
           <mo>
            -
           </mo>
           <mi mathvariant="normal">
            …
           </mi>
          </mrow>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     sendo o erro de truncamento da ordem de Δ
     <i>
      x
     </i>
     <sup>
      2
     </sup>
     , ou seja, é uma aproximação de segunda ordem.
    </p>
    <p>
     Para obter aproximações de quarta ordem, é necessário considerar, além dos pontos
     <i>
      x
     </i>
     <sub>
      <i>
       i
      </i>
      ±1
     </sub>
     , os pontos
     <i>
      x
     </i>
     <sub>
      <i>
       i
      </i>
      ±2
     </sub>
     , utilizando procedimento similar. Primeiro, considera-se a Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E27" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      27
     </a>
     nos pontos
     <i>
      l
     </i>
     = ±2 e subtrai-se uma equação da outra, isolando a derivada, obtendo-se:
    </p>
    <div class="row formula" id="eS4_E31">
     <a name="S4_E31">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (31)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <msub>
              <mi>
               f
              </mi>
              <mi>
               i
              </mi>
             </msub>
            </mrow>
            <mrow>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              x
             </mi>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           =
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <msub>
               <mi>
                f
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 +
                </mo>
                <mn>
                 2
                </mn>
               </mrow>
              </msub>
              <mo>
               -
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 -
                </mo>
                <mn>
                 2
                </mn>
               </mrow>
              </msub>
             </mrow>
             <mrow>
              <mn>
               4
              </mn>
              <mo>
               ⁢
              </mo>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               x
              </mi>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            -
           </mo>
           <mrow>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <mn>
                4
               </mn>
               <mo>
                ⁢
               </mo>
               <mi mathvariant="normal">
                Δ
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
              <mrow>
               <mn>
                3
               </mn>
               <mo>
                !
               </mo>
              </mrow>
             </mfrac>
            </mstyle>
            <mo>
             ⁢
            </mo>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <msup>
                <mi>
                 d
                </mi>
                <mn>
                 3
                </mn>
               </msup>
               <mo>
                ⁢
               </mo>
               <msub>
                <mi>
                 f
                </mi>
                <mi>
                 i
                </mi>
               </msub>
              </mrow>
              <mrow>
               <mi>
                d
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 3
                </mn>
               </msup>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
           <mo>
            -
           </mo>
           <mrow>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <mn>
                16
               </mn>
               <mo>
                ⁢
               </mo>
               <mi mathvariant="normal">
                Δ
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 4
                </mn>
               </msup>
              </mrow>
              <mrow>
               <mn>
                5
               </mn>
               <mo>
                !
               </mo>
              </mrow>
             </mfrac>
            </mstyle>
            <mo>
             ⁢
            </mo>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <msup>
                <mi>
                 d
                </mi>
                <mn>
                 5
                </mn>
               </msup>
               <mo>
                ⁢
               </mo>
               <msub>
                <mi>
                 f
                </mi>
                <mi>
                 i
                </mi>
               </msub>
              </mrow>
              <mrow>
               <mi>
                d
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 5
                </mn>
               </msup>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
           <mo>
            -
           </mo>
           <mi mathvariant="normal">
            …
           </mi>
          </mrow>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     que inclusive pode ser obtida diretamente da Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E30" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      30
     </a>
     tomando os pontos
     <i>
      i
     </i>
     ±2 (e fazendo-se Δ
     <i>
      x
     </i>
     →2Δ
     <i>
      x
     </i>
     ). Para obter o operador com erro em Δ
     <i>
      x
     </i>
     <sup>
      4
     </sup>
     , é necessário cancelar o termo em Δ
     <i>
      x
     </i>
     <sup>
      2
     </sup>
     na expressão acima. Isto é obtido multiplicando a Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E30" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      30
     </a>
     por 4 e subtraindo a Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E31" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      31
     </a>
     dela, de onde segue
    </p>
    <div class="row formula" id="eS4_E32">
     <a name="S4_E32">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (32)
       </span>
       <math display="block">
        <mrow>
         <mstyle displaystyle="true">
          <mfrac>
           <mrow>
            <mi>
             d
            </mi>
            <mo>
             ⁢
            </mo>
            <msub>
             <mi>
              f
             </mi>
             <mi>
              i
             </mi>
            </msub>
           </mrow>
           <mrow>
            <mi>
             d
            </mi>
            <mo>
             ⁢
            </mo>
            <mi>
             x
            </mi>
           </mrow>
          </mfrac>
         </mstyle>
         <mo>
          =
         </mo>
         <mrow>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mn>
              4
             </mn>
             <mn>
              3
             </mn>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mrow>
            <mo>
             (
            </mo>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <msub>
                <mi>
                 f
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msub>
               <mo>
                -
               </mo>
               <msub>
                <mi>
                 f
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  -
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msub>
              </mrow>
              <mrow>
               <mn>
                2
               </mn>
               <mo>
                ⁢
               </mo>
               <mi mathvariant="normal">
                Δ
               </mi>
               <mo>
                ⁢
               </mo>
               <mi>
                x
               </mi>
              </mrow>
             </mfrac>
            </mstyle>
            <mo>
             )
            </mo>
           </mrow>
          </mrow>
          <mo>
           -
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mn>
              1
             </mn>
             <mn>
              3
             </mn>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <msub>
               <mi>
                f
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 +
                </mo>
                <mn>
                 2
                </mn>
               </mrow>
              </msub>
              <mo>
               -
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 -
                </mo>
                <mn>
                 2
                </mn>
               </mrow>
              </msub>
             </mrow>
             <mrow>
              <mn>
               4
              </mn>
              <mo>
               ⁢
              </mo>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               x
              </mi>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
         </mrow>
        </mrow>
       </math>
       <math display="block">
        <mrow>
         <mrow>
          <mi mathvariant="normal">
          </mi>
          <mo>
           +
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mn>
               4
              </mn>
              <mo>
               ⁢
              </mo>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                4
               </mn>
              </msup>
             </mrow>
             <mrow>
              <mn>
               5
              </mn>
              <mo>
               !
              </mo>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <msup>
               <mi>
                d
               </mi>
               <mn>
                5
               </mn>
              </msup>
              <mo>
               ⁢
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mi>
                i
               </mi>
              </msub>
             </mrow>
             <mrow>
              <mi>
               d
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                5
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
         </mrow>
         <mo>
          -
         </mo>
         <mi mathvariant="normal">
          …
         </mi>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     ou, de maneira compacta,
    </p>
    <div class="row formula" id="eS4_E33">
     <a name="S4_E33">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (33)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <msub>
              <mi>
               f
              </mi>
              <mi>
               i
              </mi>
             </msub>
            </mrow>
            <mrow>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              x
             </mi>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           =
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mrow>
               <mrow>
                <mrow>
                 <mo>
                  -
                 </mo>
                 <msub>
                  <mi>
                   f
                  </mi>
                  <mrow>
                   <mi>
                    i
                   </mi>
                   <mo>
                    +
                   </mo>
                   <mn>
                    2
                   </mn>
                  </mrow>
                 </msub>
                </mrow>
                <mo>
                 +
                </mo>
                <mrow>
                 <mn>
                  8
                 </mn>
                 <mo>
                  ⁢
                 </mo>
                 <msub>
                  <mi>
                   f
                  </mi>
                  <mrow>
                   <mi>
                    i
                   </mi>
                   <mo>
                    +
                   </mo>
                   <mn>
                    1
                   </mn>
                  </mrow>
                 </msub>
                </mrow>
               </mrow>
               <mo>
                -
               </mo>
               <mrow>
                <mn>
                 8
                </mn>
                <mo>
                 ⁢
                </mo>
                <msub>
                 <mi>
                  f
                 </mi>
                 <mrow>
                  <mi>
                   i
                  </mi>
                  <mo>
                   -
                  </mo>
                  <mn>
                   1
                  </mn>
                 </mrow>
                </msub>
               </mrow>
              </mrow>
              <mo>
               +
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 -
                </mo>
                <mn>
                 2
                </mn>
               </mrow>
              </msub>
             </mrow>
             <mrow>
              <mn>
               12
              </mn>
              <mo>
               ⁢
              </mo>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               x
              </mi>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            +
           </mo>
           <mrow>
            <mi>
             O
            </mi>
            <mo>
             ⁢
            </mo>
            <mrow>
             <mo stretchy="false">
              (
             </mo>
             <mrow>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                4
               </mn>
              </msup>
             </mrow>
             <mo stretchy="false">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Por outro lado, somando as Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E28" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      28
     </a>
     e Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E29" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      29
     </a>
     e isolando a derivada segunda, obtém-se
    </p>
    <div class="row formula" id="eS4_E34">
     <a name="S4_E34">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (34)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <msup>
              <mi>
               d
              </mi>
              <mn>
               2
              </mn>
             </msup>
             <mo>
              ⁢
             </mo>
             <msub>
              <mi>
               f
              </mi>
              <mi>
               i
              </mi>
             </msub>
            </mrow>
            <mrow>
             <mi>
              d
             </mi>
             <mo>
              ⁢
             </mo>
             <msup>
              <mi>
               x
              </mi>
              <mn>
               2
              </mn>
             </msup>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           =
          </mo>
          <mrow>
           <mrow>
            <mstyle displaystyle="true">
             <mfrac>
              <mrow>
               <mrow>
                <msub>
                 <mi>
                  f
                 </mi>
                 <mrow>
                  <mi>
                   i
                  </mi>
                  <mo>
                   +
                  </mo>
                  <mn>
                   1
                  </mn>
                 </mrow>
                </msub>
                <mo>
                 -
                </mo>
                <mrow>
                 <mn>
                  2
                 </mn>
                 <mo>
                  ⁢
                 </mo>
                 <msub>
                  <mi>
                   f
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msub>
                </mrow>
               </mrow>
               <mo>
                +
               </mo>
               <msub>
                <mi>
                 f
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  -
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msub>
              </mrow>
              <mrow>
               <mi mathvariant="normal">
                Δ
               </mi>
               <mo>
                ⁢
               </mo>
               <msup>
                <mi>
                 x
                </mi>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
             </mfrac>
            </mstyle>
            <mo>
             -
            </mo>
            <mrow>
             <mstyle displaystyle="true">
              <mfrac>
               <mrow>
                <mn>
                 2
                </mn>
                <mo>
                 ⁢
                </mo>
                <mi mathvariant="normal">
                 Δ
                </mi>
                <mo>
                 ⁢
                </mo>
                <msup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  2
                 </mn>
                </msup>
               </mrow>
               <mrow>
                <mn>
                 4
                </mn>
                <mo>
                 !
                </mo>
               </mrow>
              </mfrac>
             </mstyle>
             <mo>
              ⁢
             </mo>
             <mstyle displaystyle="true">
              <mfrac>
               <mrow>
                <msup>
                 <mi>
                  d
                 </mi>
                 <mn>
                  4
                 </mn>
                </msup>
                <mo>
                 ⁢
                </mo>
                <msub>
                 <mi>
                  f
                 </mi>
                 <mi>
                  i
                 </mi>
                </msub>
               </mrow>
               <mrow>
                <mi>
                 d
                </mi>
                <mo>
                 ⁢
                </mo>
                <msup>
                 <mi>
                  x
                 </mi>
                 <mn>
                  4
                 </mn>
                </msup>
               </mrow>
              </mfrac>
             </mstyle>
            </mrow>
           </mrow>
           <mo>
            +
           </mo>
           <mi mathvariant="normal">
            …
           </mi>
          </mrow>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     que é uma aproximação de segunda ordem para a derivada segunda. A aproximação de quarta ordem é obtida pelo mesmo processo visto para a derivada primeira, resultando em
    </p>
    <div class="row formula" id="eS4_E35">
     <a name="S4_E35">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (35)
       </span>
       <math display="block">
        <mrow>
         <mstyle displaystyle="true">
          <mfrac>
           <mrow>
            <msup>
             <mi>
              d
             </mi>
             <mn>
              2
             </mn>
            </msup>
            <mo>
             ⁢
            </mo>
            <msub>
             <mi>
              f
             </mi>
             <mi>
              i
             </mi>
            </msub>
           </mrow>
           <mrow>
            <mi>
             d
            </mi>
            <mo>
             ⁢
            </mo>
            <msup>
             <mi>
              x
             </mi>
             <mn>
              2
             </mn>
            </msup>
           </mrow>
          </mfrac>
         </mstyle>
         <mo>
          =
         </mo>
         <mrow>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mn>
              4
             </mn>
             <mn>
              3
             </mn>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mrow>
               <msub>
                <mi>
                 f
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msub>
               <mo>
                -
               </mo>
               <mrow>
                <mn>
                 2
                </mn>
                <mo>
                 ⁢
                </mo>
                <msub>
                 <mi>
                  f
                 </mi>
                 <mi>
                  i
                 </mi>
                </msub>
               </mrow>
              </mrow>
              <mo>
               +
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 -
                </mo>
                <mn>
                 1
                </mn>
               </mrow>
              </msub>
             </mrow>
             <mrow>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
          <mo>
           -
          </mo>
          <mrow>
           <mstyle displaystyle="true">
            <mfrac>
             <mn>
              1
             </mn>
             <mn>
              3
             </mn>
            </mfrac>
           </mstyle>
           <mo>
            ⁢
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mrow>
              <mrow>
               <msub>
                <mi>
                 f
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  2
                 </mn>
                </mrow>
               </msub>
               <mo>
                -
               </mo>
               <mrow>
                <mn>
                 2
                </mn>
                <mo>
                 ⁢
                </mo>
                <msub>
                 <mi>
                  f
                 </mi>
                 <mi>
                  i
                 </mi>
                </msub>
               </mrow>
              </mrow>
              <mo>
               +
              </mo>
              <msub>
               <mi>
                f
               </mi>
               <mrow>
                <mi>
                 i
                </mi>
                <mo>
                 -
                </mo>
                <mn>
                 2
                </mn>
               </mrow>
              </msub>
             </mrow>
             <mrow>
              <mn>
               4
              </mn>
              <mo>
               ⁢
              </mo>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <msup>
               <mi>
                x
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
         </mrow>
        </mrow>
       </math>
       <math display="block">
        <mrow>
         <mrow>
          <mi>
          </mi>
          <mo>
           =
          </mo>
          <mstyle displaystyle="true">
           <mfrac>
            <mrow>
             <mrow>
              <mrow>
               <mrow>
                <mrow>
                 <mo>
                  -
                 </mo>
                 <msub>
                  <mi>
                   f
                  </mi>
                  <mrow>
                   <mi>
                    i
                   </mi>
                   <mo>
                    -
                   </mo>
                   <mn>
                    2
                   </mn>
                  </mrow>
                 </msub>
                </mrow>
                <mo>
                 +
                </mo>
                <mrow>
                 <mn>
                  16
                 </mn>
                 <mo>
                  ⁢
                 </mo>
                 <msub>
                  <mi>
                   f
                  </mi>
                  <mrow>
                   <mi>
                    i
                   </mi>
                   <mo>
                    -
                   </mo>
                   <mn>
                    1
                   </mn>
                  </mrow>
                 </msub>
                </mrow>
               </mrow>
               <mo>
                -
               </mo>
               <mrow>
                <mn>
                 30
                </mn>
                <mo>
                 ⁢
                </mo>
                <msub>
                 <mi>
                  f
                 </mi>
                 <mi>
                  i
                 </mi>
                </msub>
               </mrow>
              </mrow>
              <mo>
               +
              </mo>
              <mrow>
               <mn>
                16
               </mn>
               <mo>
                ⁢
               </mo>
               <msub>
                <mi>
                 f
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msub>
              </mrow>
             </mrow>
             <mo>
              -
             </mo>
             <msub>
              <mi>
               f
              </mi>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                +
               </mo>
               <mn>
                2
               </mn>
              </mrow>
             </msub>
            </mrow>
            <mrow>
             <mn>
              12
             </mn>
             <mo>
              ⁢
             </mo>
             <mi mathvariant="normal">
              Δ
             </mi>
             <mo>
              ⁢
             </mo>
             <msup>
              <mi>
               x
              </mi>
              <mn>
               2
              </mn>
             </msup>
            </mrow>
           </mfrac>
          </mstyle>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <h3>
     4.1.2. Propriedades das formulações de MDF
    </h3>
    <p>
     O MDF permite resolver equações diferenciais parciais (EDP), como é o caso da equação da onda, através da aplicação de diferenças finitas na equação que se deseja resolver numericamente. A equação algébrica (sistema linear) advinda deste processo de
     <i>
      discretização
     </i>
     é denominada de equação de diferenças finitas. Para que a resposta da equação de diferenças finitas (EDF) represente de forma satisfatória a solução da EDP original, é necessário que exigir que algumas propriedades sejam satisfeitas para que se possa de fato obter soluções numéricas limitadas (não infinitas) e uteis. A seguir, são discutidas estas propriedades de forma qualitativa e, na seção
     <span class="ref footnote">
      <sup class="xref">
       4.2.1
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        4.2.1. Critérios práticos para acurácia
          Um esquema numérico pode satisfazer todas as propriedades discutidas acima (seção 4.1.2) e ainda assim apresentar respostas numéricas com acurácia insuficiente para uma determinada aplicação. Intuitivamente, vê-se que a precisão da solução numérica depende dos parâmetros h e Δt adotados e, a princípio, quanto menores forem, melhor a resposta. Na realidade, o assunto é mais complexo como o leitor mais atento deve ter notado da discussão acima sobre estabilidade, em especial, do fato do nosso esquema ser condicionalmente estável.
          Como dito, tais esquemas requerem a utilização de parâmetros h e Δt relacionados entre si, respeitando a condição de estabilidade. Entretanto, mesmo satisfazendo esta condição – que a rigor só garante que os erros numéricos não se tornem incontroláveis durante a marcha no tempo –, as soluções podem se desviar bastante da solução esperada, sendo necessário impor valores h e Δt ainda menores para garantir um determinado grau de acurácia da solução.
          Um estudo detalhado relativo à obtenção do critério de estabilidade ou sobre a acurácia de formulações de diferenças finitas está fora do escopo deste trabalho. Ao leitor interessado em aprofundar-se no assunto, indica-se os mesmos livros de referência citados no início da seção 4. Aqui, apresenta-se, em lugar disso, alguns critérios práticos que, uma vez aplicados, garantem que as soluções numéricas vistas acima possuam estabilidade e precisão suficiente para inúmeras aplicações. Assim, frente aos parâmetros físicos do problema em questão (e.g., velocidade do meio, frequência da fonte), impõe-se a necessidade de os parâmetros numéricos satisfazerem os critérios apresentados abaixo.
          Antes de apresentar os critérios, entretanto, faz-se necessário algumas explicações adicionais. As soluções numéricas de problemas ondulatórios estão sujeitas ao problema conhecido como dispersão numérica. Isto é, no caso de meios não dispersivos e isotrópicos, como os regidos pela equação acústica da onda, as velocidades de fase e de grupo (ver conceito na Ref. [8, 22]) coincidem e são independentes da frequência e do ângulo de propagação. Quando discretiza-se o domínio do problema através do MDF, estas velocidades passam a ser função do espaçamento utilizado para a malha, além da velocidade de propagação do meio, da frequência e do ângulo de propagação. Para minimizar o nível de dispersão numérica a um patamar adequado (e imperceptível nas escala de tempo que será adotada) basta impor o seguinte critério:
          
            
              (39)
              
                
                  
                    h
                    ≤
                    
                      
                        c
                        
                          m
                          ⁢
                          i
                          ⁢
                          n
                        
                      
                      
                        α
                        ⁢
                        
                          f
                          
                            c
                            ⁢
                            o
                            ⁢
                            r
                            ⁢
                            t
                            ⁢
                            e
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde h é o espaçamento da malha, fcorte é a frequência de corte da fonte, isto é, a frequência máxima presente, cmin é a velocidade mínima presente no modelo de velocidades e α é um parâmetro que varia de acordo com a aproximação numérica utilizada. Assim definido, o parâmetro α representa o número de pontos discretos por comprimento de onda, onde se considera o menor comprimento de onda presente (referente à menor velocidade e à maior frequência).
          Em esquemas de diferenças finitas utilizando operador de segunda ordem no tempo e quarta ordem no espaço, como o discutido aqui, valores de α = 5 são suficientes para um boa precisão. Utilizando operadores de segunda ordem no espaço, é necessário utilizar α = 10. Enfatiza-se, ainda, que estes valores dependem do esquema numérico considerado, podendo variar para outras formulações.
          Para que a solução tenha estabilidade numérica, por outro lado, garantindo ainda um alto grau de precisão numérica, o seguinte critério deve ser satisfeito pelos parâmetros numéricos:
          
            
              (40)
              
                
                  
                    
                      Δ
                      ⁢
                      t
                    
                    ≤
                    
                      h
                      
                        β
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde Δt é o intervalo de tempo, h é espaçamento da malha, cmax é a velocidade máxima presente no modelo e β é um parâmetro obtido de forma empírica.
          A relação acima é similar ao critério de Courant-Friedrich-Levy (CFL). Ela expressa a necessidade do intervalo de tempo considerado ter de ser menor que o menor tempo que a onda leva pra atravessar uma célula de diferenças finitas (ou seja, considerando-se a maior velocidade no meio). Assim, β pode ser interpretado como o número de iterações necessárias para levar esta informação de um ponto a outro. Valores de β = 4 são suficientes para garantir a estabilidade da resposta numérica e um bom grau de precisão.
       </span>
      </span>
     </span>
     , são apresentados critérios quantitativos para garantir respostas acuradas na formulação para a equação da onda adotada aqui.
    </p>
    <h3>
     Consistência
    </h3>
    <p>
     Uma EDF é consistente com uma EDP se a diferença entre a EDF e a EDP (o erro de truncamento da série de Taylor) vai a zero quando o espaçamento da malha e o incremento de tempo vão a zero independentemente, ou seja,
    </p>
    <p>
    </p>
    <div class="row formula" id="eS4_E36">
     <a name="S4_E36">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (36)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <mo stretchy="false">
             |
            </mo>
            <mrow>
             <mi>
              EDP
             </mi>
             <mo>
              -
             </mo>
             <mi>
              EDF
             </mi>
            </mrow>
            <mo stretchy="false">
             |
            </mo>
           </mrow>
           <mo>
            →
           </mo>
           <mrow>
            <mn>
             0
            </mn>
            <mo mathvariant="italic" separator="true">
            </mo>
            <mi>
             se
            </mi>
           </mrow>
          </mrow>
          <mo mathvariant="italic" separator="true">
          </mo>
          <mrow>
           <mrow>
            <mrow>
             <mi mathvariant="normal">
              Δ
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              t
             </mi>
            </mrow>
            <mo>
             →
            </mo>
            <mn>
             0
            </mn>
           </mrow>
           <mo>
            ,
           </mo>
           <mrow>
            <mi>
             h
            </mi>
            <mo>
             →
            </mo>
            <mn>
             0
            </mn>
           </mrow>
          </mrow>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Pode acontecer da condição acima ser verdadeira somente quando uma certa relação entre o espaçamento da malha e o passo de tempo é satisfeita. Neste caso, o esquema é dito condicionalmente consistente. É claro que, se o erro de truncamento das aproximações da aproximação é conhecido e proporcional aos espaçamentos e incremento temporal (ou uma potência destes), como ocorre em todos os esquemas derivados com MDF, então a prova de consistência é direta, sendo os esquemas sempre consistente.
    </p>
    <h3>
     Estabilidade
    </h3>
    <p>
     Tal propriedade relaciona-se com o fato de que uma formulação numérica não pode amplificar artificialmente os erros numéricos da solução, o que degradaria completamente a solução numérica do problema ao longo do tempo. Neste sentido, se a solução de uma EDP é limitada, então a solução numérica deve ser limitada também. Como na maioria das vezes a solução de problemas físicos de interesse é limitada, pode-se definir estabilidade numérica como a seguir:
    </p>
    <div>
     <blockquote>
      <p>
       Um esquema de diferenças finitas é estável se produz uma solução limitada quando a solução exata é limitada, e, reversamente, é instável se produz uma solução ilimitada, sendo a solução exata limitada.
      </p>
     </blockquote>
    </div>
    <p>
     Há casos em que a estabilidade do esquema depende do espaçamento da malha e do incremento de tempo, sendo tais esquemas chamados de condicionalmente estáveis. Este é o caso do esquema numérico utilizado neste artigo e de grande parte dos esquemas de diferenças finitas. Na verdade, é o caso dos esquemas de diferenças finitas explícitos. Neste casos, é necessário que o espaçamento da malha e o incremento temporal estejam relacionados entre si de forma adequada, chamada de condição de estabilidade. O pior dos casos ocorre quando o esquema apresenta soluções numéricas ilimitadas para quaisquer valores de espaçamento da malha e incremento temporal, sendo em tais situações chamados de incondicionalmente instáveis. A chamada análise de estabilidade de von Neumann, uma aplicação da análise de Fourier, é o procedimento mais largamente empregado para provar a estabilidade de esquemas de diferenças finitas. Maiores detalhes sobre esta análise podem ser encontrados na Ref. [
     <span class="ref">
      <sup class="xref xrefblue">
       13
      </sup>
      <span class="refCtt closed">
       <span>
        13. J.W. Thomas, Numerical partial differential equations: finite difference methods (Springer Science &amp; Business Media, Berlim, 1995), v. 22.
       </span>
      </span>
     </span>
     ].
    </p>
    <h3>
     Convergência
    </h3>
    <p>
     Isoladamente, é a propriedade mais importante. Ela exige que a solução numérica deve convergir para a solução do problema original (regido pela EDP) quando o espaçamento da malha e o incremento temporal tenderem a zero. Infelizmente, provar que um esquema é convergente é bem mais complicado do que provar a consistência e a estabilidade. Por este motivo, um teorema de importância prática imensa é conhecido como Teorema da Equivalência de Lax-Richtmyer [
     <span class="ref">
      <sup class="xref xrefblue">
       13
      </sup>
      <span class="refCtt closed">
       <span>
        13. J.W. Thomas, Numerical partial differential equations: finite difference methods (Springer Science &amp; Business Media, Berlim, 1995), v. 22.
       </span>
      </span>
     </span>
     ,
     <span class="ref">
      <sup class="xref xrefblue">
       14
      </sup>
      <span class="refCtt closed">
       <span>
        14. J.C. Strikwerda, Finite difference schemes and partial differential equations (SIAM, Pensilvânia, 2004), 2ª ed.
       </span>
      </span>
     </span>
     ]. Tal teorema estabelece que um esquema é convergente se ele é estável e consistente. Assim, a tarefa de provar a convergência é substituída pelas tarefas mais simples de provar a consistência e a estabilidade.
    </p>
    <h2>
     4.2. Formulação explícita adotada
    </h2>
    <p>
     Nesta seção, será apresentada uma discretização simples da Eq. (
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E10" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      10
     </a>
     ). Além disso, serão abordados critérios práticos para que tais soluções sejam adequadas.
    </p>
    <p>
     O esquema abordado aqui utiliza expressões de quarta ordem no espaço (Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E35" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      35
     </a>
     ) e de segunda ordem no tempo (utilizando expressão análoga à Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E34" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      34
     </a>
     para o tempo). Em 2D, a equação de diferenças (que fornece a solução numérica) é obtida substituindo-se as aproximações e isolando no primeiro membro o termo do tempo mais avançando dado por
     <math id="INEQ12">
      <msubsup>
       <mi>
        P
       </mi>
       <mrow>
        <mi>
         i
        </mi>
        <mo>
         ,
        </mo>
        <mi>
         k
        </mi>
       </mrow>
       <mrow>
        <mi>
         n
        </mi>
        <mo>
         +
        </mo>
        <mn>
         1
        </mn>
       </mrow>
      </msubsup>
     </math>
     , obtendo-se:
    </p>
    <div class="row formula" id="eS4_E37">
     <a name="S4_E37">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (37)
       </span>
       <math display="block">
        <mrow>
         <msubsup>
          <mi>
           P
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
          <mrow>
           <mi>
            n
           </mi>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msubsup>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           δ
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
         <mrow>
          <mo>
           [
          </mo>
          <mo>
           -
          </mo>
          <mrow>
           <mo>
            (
           </mo>
           <msubsup>
            <mi>
             P
            </mi>
            <mrow>
             <mrow>
              <mi>
               i
              </mi>
              <mo>
               +
              </mo>
              <mn>
               2
              </mn>
             </mrow>
             <mo>
              ,
             </mo>
             <mi>
              j
             </mi>
            </mrow>
            <mi>
             n
            </mi>
           </msubsup>
           <mo>
            +
           </mo>
           <msubsup>
            <mi>
             P
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              ,
             </mo>
             <mrow>
              <mi>
               j
              </mi>
              <mo>
               +
              </mo>
              <mn>
               2
              </mn>
             </mrow>
            </mrow>
            <mi>
             n
            </mi>
           </msubsup>
           <mo>
            +
           </mo>
           <msubsup>
            <mi>
             P
            </mi>
            <mrow>
             <mrow>
              <mi>
               i
              </mi>
              <mo>
               -
              </mo>
              <mn>
               2
              </mn>
             </mrow>
             <mo>
              ,
             </mo>
             <mi>
              j
             </mi>
            </mrow>
            <mi>
             n
            </mi>
           </msubsup>
           <mo>
            +
           </mo>
           <msubsup>
            <mi>
             P
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              ,
             </mo>
             <mrow>
              <mi>
               j
              </mi>
              <mo>
               -
              </mo>
              <mn>
               2
              </mn>
             </mrow>
            </mrow>
            <mi>
             n
            </mi>
           </msubsup>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
       </math>
       <math display="block">
        <mrow>
         <mi mathvariant="normal">
         </mi>
         <mo>
          +
         </mo>
         <mn>
          16
         </mn>
         <mrow>
          <mo>
           (
          </mo>
          <msubsup>
           <mi>
            P
           </mi>
           <mrow>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mo>
             ,
            </mo>
            <mi>
             j
            </mi>
           </mrow>
           <mi>
            n
           </mi>
          </msubsup>
          <mo>
           +
          </mo>
          <msubsup>
           <mi>
            P
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mrow>
             <mi>
              j
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </mrow>
           <mi>
            n
           </mi>
          </msubsup>
          <mo>
           +
          </mo>
          <msubsup>
           <mi>
            P
           </mi>
           <mrow>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              -
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mo>
             ,
            </mo>
            <mi>
             j
            </mi>
           </mrow>
           <mi>
            n
           </mi>
          </msubsup>
          <mo>
           +
          </mo>
          <msubsup>
           <mi>
            P
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mrow>
             <mi>
              j
             </mi>
             <mo>
              -
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </mrow>
           <mi>
            n
           </mi>
          </msubsup>
          <mo>
           )
          </mo>
         </mrow>
         <mo>
          -
         </mo>
         <mn>
          60
         </mn>
         <msubsup>
          <mi>
           P
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            ,
           </mo>
           <mi>
            j
           </mi>
          </mrow>
          <mi>
           n
          </mi>
         </msubsup>
         <mo>
          ]
         </mo>
        </mrow>
       </math>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mi mathvariant="normal">
           </mi>
           <mo>
            +
           </mo>
           <mrow>
            <mn>
             2
            </mn>
            <mo>
             ⁢
            </mo>
            <msubsup>
             <mi>
              P
             </mi>
             <mrow>
              <mi>
               i
              </mi>
              <mo>
               ,
              </mo>
              <mi>
               j
              </mi>
             </mrow>
             <mi>
              n
             </mi>
            </msubsup>
           </mrow>
          </mrow>
          <mo>
           -
          </mo>
          <msubsup>
           <mi>
            P
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             j
            </mi>
           </mrow>
           <mrow>
            <mi>
             n
            </mi>
            <mo>
             -
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msubsup>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde o parâmetro numérico definido acima é dado por
    </p>
    <p>
    </p>
    <div class="row formula" id="eS4_E38">
     <a name="S4_E38">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (38)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <msub>
           <mi>
            δ
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             ,
            </mo>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <mi mathvariant="normal">
             Δ
            </mi>
            <mo>
             ⁢
            </mo>
            <msup>
             <mi>
              t
             </mi>
             <mn>
              2
             </mn>
            </msup>
            <mo>
             ⁢
            </mo>
            <msubsup>
             <mi>
              C
             </mi>
             <mrow>
              <mi>
               i
              </mi>
              <mo>
               ,
              </mo>
              <mi>
               j
              </mi>
             </mrow>
             <mn>
              2
             </mn>
            </msubsup>
           </mrow>
           <mrow>
            <mn>
             12
            </mn>
            <mo>
             ⁢
            </mo>
            <mi>
             h
            </mi>
           </mrow>
          </mfrac>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Um fato importante em relação à discretização no tempo é que esquemas em quarta ordem (utilizando expressão análoga à Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E35" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      35
     </a>
     para o tempo) são incondicionalmente instáveis [
     <span class="ref">
      <sup class="xref xrefblue">
       20
      </sup>
      <span class="refCtt closed">
       <span>
        20. L. Anne, P. Joly e Q.H. Tran, Computacional Geociences 4 , 207 (2000).
       </span>
      </span>
     </span>
     ]. Por outro lado, as derivadas espaciais podem ser aproximadas em ordens mais elevadas sem problemas, o que é feito para minimizar a dispersão numérica (ver seção
     <span class="ref footnote">
      <sup class="xref">
       4.2.1
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        4.2.1. Critérios práticos para acurácia
          Um esquema numérico pode satisfazer todas as propriedades discutidas acima (seção 4.1.2) e ainda assim apresentar respostas numéricas com acurácia insuficiente para uma determinada aplicação. Intuitivamente, vê-se que a precisão da solução numérica depende dos parâmetros h e Δt adotados e, a princípio, quanto menores forem, melhor a resposta. Na realidade, o assunto é mais complexo como o leitor mais atento deve ter notado da discussão acima sobre estabilidade, em especial, do fato do nosso esquema ser condicionalmente estável.
          Como dito, tais esquemas requerem a utilização de parâmetros h e Δt relacionados entre si, respeitando a condição de estabilidade. Entretanto, mesmo satisfazendo esta condição – que a rigor só garante que os erros numéricos não se tornem incontroláveis durante a marcha no tempo –, as soluções podem se desviar bastante da solução esperada, sendo necessário impor valores h e Δt ainda menores para garantir um determinado grau de acurácia da solução.
          Um estudo detalhado relativo à obtenção do critério de estabilidade ou sobre a acurácia de formulações de diferenças finitas está fora do escopo deste trabalho. Ao leitor interessado em aprofundar-se no assunto, indica-se os mesmos livros de referência citados no início da seção 4. Aqui, apresenta-se, em lugar disso, alguns critérios práticos que, uma vez aplicados, garantem que as soluções numéricas vistas acima possuam estabilidade e precisão suficiente para inúmeras aplicações. Assim, frente aos parâmetros físicos do problema em questão (e.g., velocidade do meio, frequência da fonte), impõe-se a necessidade de os parâmetros numéricos satisfazerem os critérios apresentados abaixo.
          Antes de apresentar os critérios, entretanto, faz-se necessário algumas explicações adicionais. As soluções numéricas de problemas ondulatórios estão sujeitas ao problema conhecido como dispersão numérica. Isto é, no caso de meios não dispersivos e isotrópicos, como os regidos pela equação acústica da onda, as velocidades de fase e de grupo (ver conceito na Ref. [8, 22]) coincidem e são independentes da frequência e do ângulo de propagação. Quando discretiza-se o domínio do problema através do MDF, estas velocidades passam a ser função do espaçamento utilizado para a malha, além da velocidade de propagação do meio, da frequência e do ângulo de propagação. Para minimizar o nível de dispersão numérica a um patamar adequado (e imperceptível nas escala de tempo que será adotada) basta impor o seguinte critério:
          
            
              (39)
              
                
                  
                    h
                    ≤
                    
                      
                        c
                        
                          m
                          ⁢
                          i
                          ⁢
                          n
                        
                      
                      
                        α
                        ⁢
                        
                          f
                          
                            c
                            ⁢
                            o
                            ⁢
                            r
                            ⁢
                            t
                            ⁢
                            e
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde h é o espaçamento da malha, fcorte é a frequência de corte da fonte, isto é, a frequência máxima presente, cmin é a velocidade mínima presente no modelo de velocidades e α é um parâmetro que varia de acordo com a aproximação numérica utilizada. Assim definido, o parâmetro α representa o número de pontos discretos por comprimento de onda, onde se considera o menor comprimento de onda presente (referente à menor velocidade e à maior frequência).
          Em esquemas de diferenças finitas utilizando operador de segunda ordem no tempo e quarta ordem no espaço, como o discutido aqui, valores de α = 5 são suficientes para um boa precisão. Utilizando operadores de segunda ordem no espaço, é necessário utilizar α = 10. Enfatiza-se, ainda, que estes valores dependem do esquema numérico considerado, podendo variar para outras formulações.
          Para que a solução tenha estabilidade numérica, por outro lado, garantindo ainda um alto grau de precisão numérica, o seguinte critério deve ser satisfeito pelos parâmetros numéricos:
          
            
              (40)
              
                
                  
                    
                      Δ
                      ⁢
                      t
                    
                    ≤
                    
                      h
                      
                        β
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde Δt é o intervalo de tempo, h é espaçamento da malha, cmax é a velocidade máxima presente no modelo e β é um parâmetro obtido de forma empírica.
          A relação acima é similar ao critério de Courant-Friedrich-Levy (CFL). Ela expressa a necessidade do intervalo de tempo considerado ter de ser menor que o menor tempo que a onda leva pra atravessar uma célula de diferenças finitas (ou seja, considerando-se a maior velocidade no meio). Assim, β pode ser interpretado como o número de iterações necessárias para levar esta informação de um ponto a outro. Valores de β = 4 são suficientes para garantir a estabilidade da resposta numérica e um bom grau de precisão.
       </span>
      </span>
     </span>
     ).
    </p>
    <p>
     Observa-se que, na formulação numérica apresentada, somente a velocidade
     <i>
      c
     </i>
     de propagação da onda é considerada, sendo este o único parâmetro que descreve o meio. Embora a densidade ρ apareça multiplicando a fonte, ela é considerada apenas no ponto onde ela é aplicada. Já a velocidade deve ser fornecida ponto a ponto no esquema, sendo este chamado de esquema heterogêneo (como definido na Ref. [
     <span class="ref">
      <sup class="xref xrefblue">
       21
      </sup>
      <span class="refCtt closed">
       <span>
        21. K.R. Kelly, R.W. Ward, S. Treitel e R.M. Alford, Geophysics 41 , 2 (1976).
       </span>
      </span>
     </span>
     ]).
    </p>
    <p>
     A formulação de diferenças finitas definida pela Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E37" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      37
     </a>
     é uma formulação explícita, uma vez que a resposta pode ser calculada explicitamente nos tempos futuros em função de tempos anteriores. Dadas condições iniciais conhecidas (em
     <i>
      n
     </i>
     = 0), isto permite que a solução seja calculada de forma explicita no passo de tempo seguinte (em
     <i>
      n
     </i>
     = 1) em função de valores de
     <math id="INEQ13">
      <msubsup>
       <mi>
        P
       </mi>
       <mrow>
        <mi>
         i
        </mi>
        <mo>
         ,
        </mo>
        <mi>
         k
        </mi>
       </mrow>
       <mn>
        0
       </mn>
      </msubsup>
     </math>
     conhecidos no tempo nulo e de valores
     <math id="INEQ14">
      <msubsup>
       <mi>
        P
       </mi>
       <mrow>
        <mi>
         i
        </mi>
        <mo>
         ,
        </mo>
        <mi>
         k
        </mi>
       </mrow>
       <mrow>
        <mo>
         -
        </mo>
        <mn>
         1
        </mn>
       </mrow>
      </msubsup>
     </math>
     no passo anterior (todos iguais a zero, pois são tempos anteriores ao da aplicação da fonte, no qual o meio encontra-se em equilíbrio). De forma geral, conhecendo-se
     <math id="INEQ15">
      <msubsup>
       <mi>
        P
       </mi>
       <mrow>
        <mi>
         i
        </mi>
        <mo>
         ,
        </mo>
        <mi>
         k
        </mi>
       </mrow>
       <mi>
        n
       </mi>
      </msubsup>
     </math>
     e
     <math id="INEQ16">
      <msubsup>
       <mi>
        P
       </mi>
       <mrow>
        <mi>
         i
        </mi>
        <mo>
         ,
        </mo>
        <mi>
         k
        </mi>
       </mrow>
       <mrow>
        <mi>
         n
        </mi>
        <mo>
         -
        </mo>
        <mn>
         1
        </mn>
       </mrow>
      </msubsup>
     </math>
     , pode-se calcular todos os valores de pressão no passo de tempo
     <i>
      n
     </i>
     + 1 e este processo continua iterativamente por
     <i>
      N
     </i>
     <sub>
      <i>
       t
      </i>
     </sub>
     passos até que se atinja um determinado tempo final
     <i>
      t
     </i>
     <sub>
      <i>
       f
      </i>
     </sub>
     =
     <i>
      N
     </i>
     <sub>
      <i>
       t
      </i>
     </sub>
     Δ
     <i>
      t
     </i>
     de análise. Esquemas explícitos têm a vantagem de não necessitarem de solução de sistemas lineares a cada passo de tempo, um processo bem mais dispendioso computacionalmente se comparado à marcha explícita.
    </p>
    <p>
     Os pontos de pressão discretos (sobre a malha de diferenças finitas) necessários para o cômputo de um ponto de pressão no tempo futuro definem o que se chama de estêncil do operador de diferenças finitas, conforme mostrado na Fig.
     <a class="open-asset-modal" data-target="#ModalFigS4_F8" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      8
     </a>
     .
    </p>
    <div class="row fig" id="S4_F8">
     <a name="S4_F8">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS4_F8" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/2667cb29124706d3399573a57ec864343ba91fbc.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 8
      </strong>
      <br/>
      Estêncil do esquema de diferenças finitas.
      <br/>
     </div>
    </div>
    <p>
     A seguir, será tratada a implementação computacional. Além da simplicidade mostrada acima para a obtenção de esquemas de diferenças finitas e da simplicidade conceitual do MDF, outra grande vantagem do método reside na simplicidade da programação de esquemas explícitos. Além disso, a solução numérica numérica é de boa qualidade, em especial para problemas de propagação de ondas, desde que sejam satisfeitas as condições discutidas na seção
     <span class="ref footnote">
      <sup class="xref">
       4.2.1
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        4.2.1. Critérios práticos para acurácia
          Um esquema numérico pode satisfazer todas as propriedades discutidas acima (seção 4.1.2) e ainda assim apresentar respostas numéricas com acurácia insuficiente para uma determinada aplicação. Intuitivamente, vê-se que a precisão da solução numérica depende dos parâmetros h e Δt adotados e, a princípio, quanto menores forem, melhor a resposta. Na realidade, o assunto é mais complexo como o leitor mais atento deve ter notado da discussão acima sobre estabilidade, em especial, do fato do nosso esquema ser condicionalmente estável.
          Como dito, tais esquemas requerem a utilização de parâmetros h e Δt relacionados entre si, respeitando a condição de estabilidade. Entretanto, mesmo satisfazendo esta condição – que a rigor só garante que os erros numéricos não se tornem incontroláveis durante a marcha no tempo –, as soluções podem se desviar bastante da solução esperada, sendo necessário impor valores h e Δt ainda menores para garantir um determinado grau de acurácia da solução.
          Um estudo detalhado relativo à obtenção do critério de estabilidade ou sobre a acurácia de formulações de diferenças finitas está fora do escopo deste trabalho. Ao leitor interessado em aprofundar-se no assunto, indica-se os mesmos livros de referência citados no início da seção 4. Aqui, apresenta-se, em lugar disso, alguns critérios práticos que, uma vez aplicados, garantem que as soluções numéricas vistas acima possuam estabilidade e precisão suficiente para inúmeras aplicações. Assim, frente aos parâmetros físicos do problema em questão (e.g., velocidade do meio, frequência da fonte), impõe-se a necessidade de os parâmetros numéricos satisfazerem os critérios apresentados abaixo.
          Antes de apresentar os critérios, entretanto, faz-se necessário algumas explicações adicionais. As soluções numéricas de problemas ondulatórios estão sujeitas ao problema conhecido como dispersão numérica. Isto é, no caso de meios não dispersivos e isotrópicos, como os regidos pela equação acústica da onda, as velocidades de fase e de grupo (ver conceito na Ref. [8, 22]) coincidem e são independentes da frequência e do ângulo de propagação. Quando discretiza-se o domínio do problema através do MDF, estas velocidades passam a ser função do espaçamento utilizado para a malha, além da velocidade de propagação do meio, da frequência e do ângulo de propagação. Para minimizar o nível de dispersão numérica a um patamar adequado (e imperceptível nas escala de tempo que será adotada) basta impor o seguinte critério:
          
            
              (39)
              
                
                  
                    h
                    ≤
                    
                      
                        c
                        
                          m
                          ⁢
                          i
                          ⁢
                          n
                        
                      
                      
                        α
                        ⁢
                        
                          f
                          
                            c
                            ⁢
                            o
                            ⁢
                            r
                            ⁢
                            t
                            ⁢
                            e
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde h é o espaçamento da malha, fcorte é a frequência de corte da fonte, isto é, a frequência máxima presente, cmin é a velocidade mínima presente no modelo de velocidades e α é um parâmetro que varia de acordo com a aproximação numérica utilizada. Assim definido, o parâmetro α representa o número de pontos discretos por comprimento de onda, onde se considera o menor comprimento de onda presente (referente à menor velocidade e à maior frequência).
          Em esquemas de diferenças finitas utilizando operador de segunda ordem no tempo e quarta ordem no espaço, como o discutido aqui, valores de α = 5 são suficientes para um boa precisão. Utilizando operadores de segunda ordem no espaço, é necessário utilizar α = 10. Enfatiza-se, ainda, que estes valores dependem do esquema numérico considerado, podendo variar para outras formulações.
          Para que a solução tenha estabilidade numérica, por outro lado, garantindo ainda um alto grau de precisão numérica, o seguinte critério deve ser satisfeito pelos parâmetros numéricos:
          
            
              (40)
              
                
                  
                    
                      Δ
                      ⁢
                      t
                    
                    ≤
                    
                      h
                      
                        β
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde Δt é o intervalo de tempo, h é espaçamento da malha, cmax é a velocidade máxima presente no modelo e β é um parâmetro obtido de forma empírica.
          A relação acima é similar ao critério de Courant-Friedrich-Levy (CFL). Ela expressa a necessidade do intervalo de tempo considerado ter de ser menor que o menor tempo que a onda leva pra atravessar uma célula de diferenças finitas (ou seja, considerando-se a maior velocidade no meio). Assim, β pode ser interpretado como o número de iterações necessárias para levar esta informação de um ponto a outro. Valores de β = 4 são suficientes para garantir a estabilidade da resposta numérica e um bom grau de precisão.
       </span>
      </span>
     </span>
     , i.e., desde que se satisfaça o critério de estabilidade e se utilize espaçamentos da malha e incremento temporal pequeno o suficiente para que e se tenha uma boa precisão numérica.
    </p>
    <p>
     No código computacional, em primeiro lugar, deve-se definir os parâmetros físicos associados ao problema. Estes são: o domínio de propagação da onda, ou seja, o tamanho
     <i>
      X
     </i>
     e
     <i>
      Z
     </i>
     do modelo 2D (em metros, por exemplo); as velocidades de propagação de onda no meio, definidas ponto a ponto no domínio; e a frequência de corte da fonte. Os parâmetros numéricos também precisam ser definidos de forma adequada, como será detalhado na seção
     <span class="ref footnote">
      <sup class="xref">
       4.2.1
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        4.2.1. Critérios práticos para acurácia
          Um esquema numérico pode satisfazer todas as propriedades discutidas acima (seção 4.1.2) e ainda assim apresentar respostas numéricas com acurácia insuficiente para uma determinada aplicação. Intuitivamente, vê-se que a precisão da solução numérica depende dos parâmetros h e Δt adotados e, a princípio, quanto menores forem, melhor a resposta. Na realidade, o assunto é mais complexo como o leitor mais atento deve ter notado da discussão acima sobre estabilidade, em especial, do fato do nosso esquema ser condicionalmente estável.
          Como dito, tais esquemas requerem a utilização de parâmetros h e Δt relacionados entre si, respeitando a condição de estabilidade. Entretanto, mesmo satisfazendo esta condição – que a rigor só garante que os erros numéricos não se tornem incontroláveis durante a marcha no tempo –, as soluções podem se desviar bastante da solução esperada, sendo necessário impor valores h e Δt ainda menores para garantir um determinado grau de acurácia da solução.
          Um estudo detalhado relativo à obtenção do critério de estabilidade ou sobre a acurácia de formulações de diferenças finitas está fora do escopo deste trabalho. Ao leitor interessado em aprofundar-se no assunto, indica-se os mesmos livros de referência citados no início da seção 4. Aqui, apresenta-se, em lugar disso, alguns critérios práticos que, uma vez aplicados, garantem que as soluções numéricas vistas acima possuam estabilidade e precisão suficiente para inúmeras aplicações. Assim, frente aos parâmetros físicos do problema em questão (e.g., velocidade do meio, frequência da fonte), impõe-se a necessidade de os parâmetros numéricos satisfazerem os critérios apresentados abaixo.
          Antes de apresentar os critérios, entretanto, faz-se necessário algumas explicações adicionais. As soluções numéricas de problemas ondulatórios estão sujeitas ao problema conhecido como dispersão numérica. Isto é, no caso de meios não dispersivos e isotrópicos, como os regidos pela equação acústica da onda, as velocidades de fase e de grupo (ver conceito na Ref. [8, 22]) coincidem e são independentes da frequência e do ângulo de propagação. Quando discretiza-se o domínio do problema através do MDF, estas velocidades passam a ser função do espaçamento utilizado para a malha, além da velocidade de propagação do meio, da frequência e do ângulo de propagação. Para minimizar o nível de dispersão numérica a um patamar adequado (e imperceptível nas escala de tempo que será adotada) basta impor o seguinte critério:
          
            
              (39)
              
                
                  
                    h
                    ≤
                    
                      
                        c
                        
                          m
                          ⁢
                          i
                          ⁢
                          n
                        
                      
                      
                        α
                        ⁢
                        
                          f
                          
                            c
                            ⁢
                            o
                            ⁢
                            r
                            ⁢
                            t
                            ⁢
                            e
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde h é o espaçamento da malha, fcorte é a frequência de corte da fonte, isto é, a frequência máxima presente, cmin é a velocidade mínima presente no modelo de velocidades e α é um parâmetro que varia de acordo com a aproximação numérica utilizada. Assim definido, o parâmetro α representa o número de pontos discretos por comprimento de onda, onde se considera o menor comprimento de onda presente (referente à menor velocidade e à maior frequência).
          Em esquemas de diferenças finitas utilizando operador de segunda ordem no tempo e quarta ordem no espaço, como o discutido aqui, valores de α = 5 são suficientes para um boa precisão. Utilizando operadores de segunda ordem no espaço, é necessário utilizar α = 10. Enfatiza-se, ainda, que estes valores dependem do esquema numérico considerado, podendo variar para outras formulações.
          Para que a solução tenha estabilidade numérica, por outro lado, garantindo ainda um alto grau de precisão numérica, o seguinte critério deve ser satisfeito pelos parâmetros numéricos:
          
            
              (40)
              
                
                  
                    
                      Δ
                      ⁢
                      t
                    
                    ≤
                    
                      h
                      
                        β
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde Δt é o intervalo de tempo, h é espaçamento da malha, cmax é a velocidade máxima presente no modelo e β é um parâmetro obtido de forma empírica.
          A relação acima é similar ao critério de Courant-Friedrich-Levy (CFL). Ela expressa a necessidade do intervalo de tempo considerado ter de ser menor que o menor tempo que a onda leva pra atravessar uma célula de diferenças finitas (ou seja, considerando-se a maior velocidade no meio). Assim, β pode ser interpretado como o número de iterações necessárias para levar esta informação de um ponto a outro. Valores de β = 4 são suficientes para garantir a estabilidade da resposta numérica e um bom grau de precisão.
       </span>
      </span>
     </span>
     . Os principais parâmetros numéricos são: os espaçamentos da malha Δ
     <i>
      x
     </i>
     e Δ
     <i>
      z
     </i>
     , que define os números de pontos
     <i>
      N
     </i>
     <sub>
      <i>
       z
      </i>
     </sub>
     ×
     <i>
      N
     </i>
     <sub>
      <i>
       x
      </i>
     </sub>
     , e o incremento temporal Δ
     <i>
      t
     </i>
     , que define o número de passos
     <i>
      N
     </i>
     <sub>
      <i>
       t
      </i>
     </sub>
     .
    </p>
    <p>
     Um algoritmo básico é apresentado (Algoritmo
     <a class="open-asset-modal" data-target="#ModalFigS4_F8" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      8
     </a>
     ) e explicado na sequência. Primeiro, deve-se declarar as variáveis necessárias para a solução do problema, definir os parâmetros físicos e numérico associados ou lê-los de arquivo. Caso sejam lidos de arquivo durante a execução do programa, as matrizes de
     <i>
      N
     </i>
     <sub>
      <i>
       z
      </i>
     </sub>
     ×
     <i>
      N
     </i>
     <sub>
      <i>
       x
      </i>
     </sub>
     posições devem ser alocadas dinamicamente, após tais parâmetros terem sido lidos e alternativamente, de forma mais simples, tais matrizes podem ser declaradas se
     <i>
      N
     </i>
     <sub>
      <i>
       z
      </i>
     </sub>
     e
     <i>
      N
     </i>
     <sub>
      <i>
       x
      </i>
     </sub>
     são declarados como parâmetros. Na linha
     <a class="open-asset-modal" data-target="#ModalFigS4_F8" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      8
     </a>
     , o modelo de velocidade é lido para a matriz de velocidades. Na linha
     <a class="open-asset-modal" data-target="#ModalFigS4_F8" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      8
     </a>
     , deve-se realizar alguns cálculos iniciais, como: (1) zerar as matrizes
     <i>
      P
     </i>
     1 e
     <i>
      P
     </i>
     2 que irão guardar os valores de pressão na malha em instantes de tempo consecutivos, respectivamente em
     <i>
      n
     </i>
     −1 e
     <i>
      n
     </i>
     , necessários para a marcha explícita no tempo (cálculo de
     <i>
      P
     </i>
     3 em
     <i>
      n
     </i>
     + 1), (2) calcular parâmetros da fonte, como os dados pelas Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E12" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      12
     </a>
     –
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E14" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      14
     </a>
     e (3) a matriz δ é calculada (Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E38" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      38
     </a>
     ).
    </p>
    <div class="row fig" id="F1">
     <a name="F1">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigF1" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/3b72ef1f7d706d589a060e528d3a49028a22f6e3.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Algoritmo 1
      </strong>
      <br/>
      Propagação de onda
      <br/>
     </div>
    </div>
    <p>
     A linha 8 dá início à marcha no tempo propriamente dita (laço sobre o número de passos de tempo
     <i>
      n
     </i>
     ). Na linha 10, a fonte sísmica é aplicada no ponto
     <i>
      kf
     </i>
     ×
     <i>
      if
     </i>
     da malha, utilizando-se uma função definida pelo usuário, com base na Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E11" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      11
     </a>
     . A fonte é aplicada por meio da introdução do valor da fonte na posição correta da malha, por meio da matriz
     <i>
      P
     </i>
     1. Assim, ela será corretamente considerada quando executada a linha 14 na posição da fonte. Repare que a fonte só será aplicada se o passo de tempo for menor ou igual que a variável inteira
     <i>
      N
     </i>
     <sub>
      <i>
       fonte
      </i>
     </sub>
     que especifica o número de passos de tempo onde a fonte é não nula, conforme definido pela Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E15" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      15
     </a>
     . Deve-se utilizar
     <i>
      N
     </i>
     <sub>
      <i>
       fonte
      </i>
     </sub>
     como o inteiro de valor mais próximo de
     <i>
      t
     </i>
     <sub>
      <i>
       M
      </i>
     </sub>
     /Δ
     <i>
      t
     </i>
     (
     <i>
      t
     </i>
     <sub>
      <i>
       M
      </i>
     </sub>
     dado pela Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS3_E16" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      16
     </a>
     ). Entre as linha 12–16, o operador de diferença finita, dado pela Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E37" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      37
     </a>
     , é calculado em cada ponto da malha através de um laço duplo. Na linha 14,
     <i>
      F
     </i>
     (
     <i>
      P
     </i>
     2) representa todos os valores de
     <i>
      P
     </i>
     2 necessários para o cômputo de
     <i>
      P
     </i>
     3, dados pelos pontos entre colchetes na Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E37" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      37
     </a>
     (Fig.
     <a class="open-asset-modal" data-target="#ModalFigS4_F8" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      8
     </a>
     ).
    </p>
    <p>
     Na linha 17, foram agrupadas em uma subrotina todo o tratamento das bordas, ou seja, a aplicação de segunda ordem nos pontos próximos ao contorno, a aplicação de
     <i>
      p
     </i>
     = 0 na superfície, das equações one-way da onda nas demais bordas, bem como as camadas de Cerjan. Detalhamento sobre esta subrotina é deixado como exercício para o leitor interessado em implementar o código utilizando uma linguagem de programação. As linhas 18–22 escrevem os snapshots em arquivos a cada
     <i>
      N
     </i>
     <sub>
      <i>
       snap
      </i>
     </sub>
     passos, onde
     <i>
      MOD
     </i>
     (
     <i>
      a
     </i>
     ,
     <i>
      b
     </i>
     ) retorna o resto da divisão inteira
     <i>
      a
     </i>
     /
     <i>
      b
     </i>
     . As linhas 22–24 salvam o sismograma na matriz
     <i>
      Sismo
     </i>
     (cada um dos
     <i>
      N
     </i>
     <sub>
      <i>
       R
      </i>
     </sub>
     receptores em (
     <i>
      z
     </i>
     ,
     <i>
      x
     </i>
     ) =
     <i>
      i
     </i>
     <sub>
      <i>
       prof
      </i>
     </sub>
     ,
     <i>
      x
     </i>
     <sub>
      <i>
       k
      </i>
     </sub>
     ), posteriormente escrita em arquivo. Na linha 25, os campos de pressão são atualizados para continuar a marcha. Dentro de um laço duplo sob toda a malha, utiliza-se as atribuições:
     <i>
      P
     </i>
     1(
     <i>
      i
     </i>
     ,
     <i>
      k
     </i>
     )←
     <i>
      P
     </i>
     2(
     <i>
      i
     </i>
     ,
     <i>
      k
     </i>
     ),
     <i>
      P
     </i>
     2(
     <i>
      i
     </i>
     ,
     <i>
      k
     </i>
     )←
     <i>
      P
     </i>
     3(
     <i>
      i
     </i>
     ,
     <i>
      k
     </i>
     ).
    </p>
    <h3>
     4.2.1. Critérios práticos para acurácia
    </h3>
    <p>
     Um esquema numérico pode satisfazer todas as propriedades discutidas acima (seção
     <span class="ref footnote">
      <sup class="xref">
       4.1.2
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        4.1.2. Propriedades das formulações de MDF
          O MDF permite resolver equações diferenciais parciais (EDP), como é o caso da equação da onda, através da aplicação de diferenças finitas na equação que se deseja resolver numericamente. A equação algébrica (sistema linear) advinda deste processo de discretização é denominada de equação de diferenças finitas. Para que a resposta da equação de diferenças finitas (EDF) represente de forma satisfatória a solução da EDP original, é necessário que exigir que algumas propriedades sejam satisfeitas para que se possa de fato obter soluções numéricas limitadas (não infinitas) e uteis. A seguir, são discutidas estas propriedades de forma qualitativa e, na seção 4.2.1, são apresentados critérios quantitativos para garantir respostas acuradas na formulação para a equação da onda adotada aqui.
       </span>
      </span>
     </span>
     ) e ainda assim apresentar respostas numéricas com acurácia insuficiente para uma determinada aplicação. Intuitivamente, vê-se que a precisão da solução numérica depende dos parâmetros
     <i>
      h
     </i>
     e Δ
     <i>
      t
     </i>
     adotados e, a princípio, quanto menores forem, melhor a resposta. Na realidade, o assunto é mais complexo como o leitor mais atento deve ter notado da discussão acima sobre estabilidade, em especial, do fato do nosso esquema ser condicionalmente estável.
    </p>
    <p>
     Como dito, tais esquemas requerem a utilização de parâmetros
     <i>
      h
     </i>
     e Δ
     <i>
      t
     </i>
     relacionados entre si, respeitando a condição de estabilidade. Entretanto, mesmo satisfazendo esta condição – que a rigor só garante que os erros numéricos não se tornem incontroláveis durante a marcha no tempo –, as soluções podem se desviar bastante da solução esperada, sendo necessário impor valores
     <i>
      h
     </i>
     e Δ
     <i>
      t
     </i>
     ainda menores para garantir um determinado grau de acurácia da solução.
    </p>
    <p>
     Um estudo detalhado relativo à obtenção do critério de estabilidade ou sobre a acurácia de formulações de diferenças finitas está fora do escopo deste trabalho. Ao leitor interessado em aprofundar-se no assunto, indica-se os mesmos livros de referência citados no início da seção
     <span class="ref footnote">
      <sup class="xref">
       4
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        4. Soluções numéricas
      Neste seção, primeiro serão apresentadas as ideias básicas do Método das Diferenças Finitas (MDF), com o objetivo de descrever em detalhes a formulação numérica explícita que será adotada. Para um aprofundamento do tema, reporta-se à vasta bibliografia especializada sobre o tema, em especial, ao excelente livro texto [13]. Outros livros sobre o MDF contém informação adicional e introdutória são [14, 15], podendo ser consultados outros bons livros textos mais gerais de métodos numéricos [16, 17, 18, 19].
      
        4.1. O Método das Diferenças Finitas
        O Método das Diferenças Finitas (MDF) é um dos métodos numéricos mais simples e intuitivos utilizados para resolução de equações diferenciais, podendo ser utilizado para obter soluções numéricas de uma vasta gama de equações.
        O seu princípio básico é o de que as equações diferenciais são válidas ponto a ponto do domínio, podendo ser empregadas aproximações de diferenças finitas ponto a ponto desta malha para obter equações algébricas que irão fornecer soluções numéricas das equações. A Fig. 7 mostra a malha, com espaçamentos fixos Δx e Δz, respectivamente, nas direções x e z. No MDF, usualmente, também é adotado um incremento temporal fixo para a solução de equações dependentes do tempo. Desta forma, as funções e propriedades de interesse são consideradas apenas nestes pontos discretos P(xi,zj,tn) = P(iΔx,kΔz,nΔt). Repare que o eixo z é apontado para baixo e será considerado o zero na superfície da Terra.
        
          Figura 7
          
            Malha simples de Diferenças Finitas.
          
          
            
            
          
        
        São obtidas então expressões aproximadas para as derivadas nestes pontos discretos, sendo elas denominadas aproximações de diferenças finitas ou simplesmente diferenças finitas, podendo estas serem de diferentes ordens de precisão, dependendo do número de pontos utilizados, como será visto a seguir.
        
          4.1.1. Operadores de diferenças finitas
          Considere f(x) então uma função contínua, bem como suas derivadas. Pode-se desenvolver esta função em série de Taylor em torno do ponto x0:
          
            
              (26)
              
                
                  
                    
                      f
                      ⁢
                      
                        (
                        x
                        )
                      
                    
                    =
                    
                      
                        
                          
                            
                              ∑
                              
                                n
                                =
                                0
                              
                              ∞
                            
                            
                              
                                1
                                
                                  n
                                  !
                                
                              
                              ⁢
                              
                                
                                  
                                    d
                                    n
                                  
                                  ⁢
                                  f
                                  ⁢
                                  
                                    (
                                    x
                                    )
                                  
                                
                                
                                  d
                                  ⁢
                                  
                                    x
                                    n
                                  
                                
                              
                            
                          
                          |
                        
                        
                          x
                          =
                          
                            x
                            0
                          
                        
                      
                      ⁢
                      
                        
                          (
                          
                            x
                            -
                            
                              x
                              0
                            
                          
                          )
                        
                        n
                      
                    
                  
                  .
                
              
            
          
          Para obter as diferenças finitas que serão utilizadas nas formulações numéricas deste trabalho, o valor da função deve ser desenvolvido em série de Taylor em diferentes pontos x = xi + lΔx, onde l ∈ Z, em torno de xi, isto é,
          
            
              (27)
              
                
                  
                    
                      
                        f
                      
                      
                        i
                        ±
                        l
                      
                    
                    =
                    
                      f
                      ⁢
                      
                        (
                        
                          
                            x
                            i
                          
                          ±
                          
                            l
                            ⁢
                            Δ
                            ⁢
                            x
                          
                        
                        )
                      
                    
                    =
                    
                      
                        
                          
                            
                              ∑
                              
                                n
                                =
                                0
                              
                              ∞
                            
                            
                              
                                1
                                
                                  n
                                  !
                                
                              
                              ⁢
                              
                                
                                  
                                    d
                                    n
                                  
                                  ⁢
                                  f
                                  ⁢
                                  
                                    (
                                    x
                                    )
                                  
                                
                                
                                  d
                                  ⁢
                                  
                                    x
                                    n
                                  
                                
                              
                            
                          
                          |
                        
                        
                          x
                          =
                          
                            x
                            i
                          
                        
                      
                      ⁢
                      
                        
                          (
                          
                            ±
                            
                              l
                              ⁢
                              Δ
                              ⁢
                              x
                            
                          
                          )
                        
                        n
                      
                    
                  
                  .
                
              
            
          
          Soma-se, então, as diferentes expressões obtidas a fim de cancelar os termos até a ordem de interesse da derivada em questão. Como será visto, quanto maior a ordem de aproximação, mais pontos precisam ser considerados. A seguir, serão obtidos os operadores de diferenças finitas em segunda e quarta ordens1 de aproximação em Δx.
          Assim, considere os seguintes desenvolvimentos (l = ±1):
          
            (28)
            
              
                
                  f
                  
                    i
                    +
                    1
                  
                
                =
                
                  
                    f
                    i
                  
                  +
                  
                    
                      
                        
                          Δ
                          ⁢
                          x
                        
                        
                          1
                          !
                        
                      
                    
                    ⁢
                    
                      
                        
                          d
                          ⁢
                          
                            f
                            i
                          
                        
                        
                          d
                          ⁢
                          x
                        
                      
                    
                  
                  +
                  
                    
                      
                        
                          Δ
                          ⁢
                          
                            x
                            2
                          
                        
                        
                          2
                          !
                        
                      
                    
                    ⁢
                    
                      
                        
                          
                            d
                            2
                          
                          ⁢
                          
                            f
                            i
                          
                        
                        
                          d
                          ⁢
                          
                            x
                            2
                          
                        
                      
                    
                  
                  +
                  
                    
                      
                        
                          Δ
                          ⁢
                          
                            x
                            3
                          
                        
                        
                          3
                          !
                        
                      
                    
                    ⁢
                    
                      
                        
                          
                            d
                            3
                          
                          ⁢
                          
                            f
                            i
                          
                        
                        
                          d
                          ⁢
                          
                            x
                            3
                          
                        
                      
                    
                  
                
              
            
            
              
                 
                +
                
                  
                    
                      
                        Δ
                        ⁢
                        
                          x
                          4
                        
                      
                      
                        4
                        !
                      
                    
                  
                  ⁢
                  
                    
                      
                        
                          d
                          4
                        
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        
                          x
                          4
                        
                      
                    
                  
                
                +
                
                  
                    
                      
                        Δ
                        ⁢
                        
                          x
                          5
                        
                      
                      
                        5
                        !
                      
                    
                  
                  ⁢
                  
                    
                      
                        
                          d
                          5
                        
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        
                          x
                          5
                        
                      
                    
                  
                
                +
                …
              
            
          
          
            (29)
            
              
                
                  f
                  
                    i
                    -
                    1
                  
                
                =
                
                  
                    
                      
                        f
                        i
                      
                      -
                      
                        
                          
                            
                              Δ
                              ⁢
                              x
                            
                            
                              1
                              !
                            
                          
                        
                        ⁢
                        
                          
                            
                              d
                              ⁢
                              
                                f
                                i
                              
                            
                            
                              d
                              ⁢
                              x
                            
                          
                        
                      
                    
                    +
                    
                      
                        
                          
                            Δ
                            ⁢
                            
                              x
                              2
                            
                          
                          
                            2
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              2
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              2
                            
                          
                        
                      
                    
                  
                  -
                  
                    
                      
                        
                          Δ
                          ⁢
                          
                            x
                            3
                          
                        
                        
                          3
                          !
                        
                      
                    
                    ⁢
                    
                      
                        
                          
                            d
                            3
                          
                          ⁢
                          
                            f
                            i
                          
                        
                        
                          d
                          ⁢
                          
                            x
                            3
                          
                        
                      
                    
                  
                
              
            
            
              
                
                  
                    
                       
                      +
                      
                        
                          
                            
                              Δ
                              ⁢
                              
                                x
                                4
                              
                            
                            
                              4
                              !
                            
                          
                        
                        ⁢
                        
                          
                            
                              
                                d
                                4
                              
                              ⁢
                              
                                f
                                i
                              
                            
                            
                              d
                              ⁢
                              
                                x
                                4
                              
                            
                          
                        
                      
                    
                    -
                    
                      
                        
                          
                            Δ
                            ⁢
                            
                              x
                              5
                            
                          
                          
                            5
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              5
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              5
                            
                          
                        
                      
                    
                  
                  +
                  …
                
                ,
              
            
          
          onde dfi/dx é a derivada considerada no ponto x = xi.
          Fazendo-se a Eq. 29 menos a Eq. 28, obtém-se a expressão em segunda ordem de aproximação:
          
            (30)
            
              
                
                  
                    
                      
                        d
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        x
                      
                    
                  
                  =
                  
                    
                      
                        
                          
                            f
                            
                              i
                              +
                              1
                            
                          
                          -
                          
                            f
                            
                              i
                              -
                              1
                            
                          
                        
                        
                          2
                          ⁢
                          Δ
                          ⁢
                          x
                        
                      
                    
                    -
                    
                      
                        
                          
                            Δ
                            ⁢
                            
                              x
                              2
                            
                          
                          
                            3
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              3
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              3
                            
                          
                        
                      
                    
                    -
                    
                      
                        
                          
                            Δ
                            ⁢
                            
                              x
                              4
                            
                          
                          
                            5
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              5
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              5
                            
                          
                        
                      
                    
                    -
                    …
                  
                
                ,
              
            
          
          sendo o erro de truncamento da ordem de Δx2, ou seja, é uma aproximação de segunda ordem.
          Para obter aproximações de quarta ordem, é necessário considerar, além dos pontos xi±1, os pontos xi±2, utilizando procedimento similar. Primeiro, considera-se a Eq. 27 nos pontos l = ±2 e subtrai-se uma equação da outra, isolando a derivada, obtendo-se:
          
            (31)
            
              
                
                  
                    
                      
                        d
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        x
                      
                    
                  
                  =
                  
                    
                      
                        
                          
                            f
                            
                              i
                              +
                              2
                            
                          
                          -
                          
                            f
                            
                              i
                              -
                              2
                            
                          
                        
                        
                          4
                          ⁢
                          Δ
                          ⁢
                          x
                        
                      
                    
                    -
                    
                      
                        
                          
                            4
                            ⁢
                            Δ
                            ⁢
                            
                              x
                              2
                            
                          
                          
                            3
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              3
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              3
                            
                          
                        
                      
                    
                    -
                    
                      
                        
                          
                            16
                            ⁢
                            Δ
                            ⁢
                            
                              x
                              4
                            
                          
                          
                            5
                            !
                          
                        
                      
                      ⁢
                      
                        
                          
                            
                              d
                              5
                            
                            ⁢
                            
                              f
                              i
                            
                          
                          
                            d
                            ⁢
                            
                              x
                              5
                            
                          
                        
                      
                    
                    -
                    …
                  
                
                ,
              
            
          
          que inclusive pode ser obtida diretamente da Eq. 30 tomando os pontos i±2 (e fazendo-se Δx→2Δx). Para obter o operador com erro em Δx4, é necessário cancelar o termo em Δx2 na expressão acima. Isto é obtido multiplicando a Eq. 30 por 4 e subtraindo a Eq. 31 dela, de onde segue
          
            (32)
            
              
                
                  
                    
                      d
                      ⁢
                      
                        f
                        i
                      
                    
                    
                      d
                      ⁢
                      x
                    
                  
                
                =
                
                  
                    
                      
                        4
                        3
                      
                    
                    ⁢
                    
                      (
                      
                        
                          
                            
                              f
                              
                                i
                                +
                                1
                              
                            
                            -
                            
                              f
                              
                                i
                                -
                                1
                              
                            
                          
                          
                            2
                            ⁢
                            Δ
                            ⁢
                            x
                          
                        
                      
                      )
                    
                  
                  -
                  
                    
                      
                        1
                        3
                      
                    
                    ⁢
                    
                      
                        
                          
                            f
                            
                              i
                              +
                              2
                            
                          
                          -
                          
                            f
                            
                              i
                              -
                              2
                            
                          
                        
                        
                          4
                          ⁢
                          Δ
                          ⁢
                          x
                        
                      
                    
                  
                
              
            
            
              
                
                   
                  +
                  
                    
                      
                        
                          4
                          ⁢
                          Δ
                          ⁢
                          
                            x
                            4
                          
                        
                        
                          5
                          !
                        
                      
                    
                    ⁢
                    
                      
                        
                          
                            d
                            5
                          
                          ⁢
                          
                            f
                            i
                          
                        
                        
                          d
                          ⁢
                          
                            x
                            5
                          
                        
                      
                    
                  
                
                -
                …
              
            
          
          ou, de maneira compacta,
          
            (33)
            
              
                
                  
                    
                      
                        d
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        x
                      
                    
                  
                  =
                  
                    
                      
                        
                          
                            
                              
                                -
                                
                                  f
                                  
                                    i
                                    +
                                    2
                                  
                                
                              
                              +
                              
                                8
                                ⁢
                                
                                  f
                                  
                                    i
                                    +
                                    1
                                  
                                
                              
                            
                            -
                            
                              8
                              ⁢
                              
                                f
                                
                                  i
                                  -
                                  1
                                
                              
                            
                          
                          +
                          
                            f
                            
                              i
                              -
                              2
                            
                          
                        
                        
                          12
                          ⁢
                          Δ
                          ⁢
                          x
                        
                      
                    
                    +
                    
                      O
                      ⁢
                      
                        (
                        
                          Δ
                          ⁢
                          
                            x
                            4
                          
                        
                        )
                      
                    
                  
                
                .
              
            
          
          Por outro lado, somando as Eq. 28 e Eq. 29 e isolando a derivada segunda, obtém-se
          
            (34)
            
              
                
                  
                    
                      
                        
                          d
                          2
                        
                        ⁢
                        
                          f
                          i
                        
                      
                      
                        d
                        ⁢
                        
                          x
                          2
                        
                      
                    
                  
                  =
                  
                    
                      
                        
                          
                            
                              
                                f
                                
                                  i
                                  +
                                  1
                                
                              
                              -
                              
                                2
                                ⁢
                                
                                  f
                                  i
                                
                              
                            
                            +
                            
                              f
                              
                                i
                                -
                                1
                              
                            
                          
                          
                            Δ
                            ⁢
                            
                              x
                              2
                            
                          
                        
                      
                      -
                      
                        
                          
                            
                              2
                              ⁢
                              Δ
                              ⁢
                              
                                x
                                2
                              
                            
                            
                              4
                              !
                            
                          
                        
                        ⁢
                        
                          
                            
                              
                                d
                                4
                              
                              ⁢
                              
                                f
                                i
                              
                            
                            
                              d
                              ⁢
                              
                                x
                                4
                              
                            
                          
                        
                      
                    
                    +
                    …
                  
                
                ,
              
            
          
          que é uma aproximação de segunda ordem para a derivada segunda. A aproximação de quarta ordem é obtida pelo mesmo processo visto para a derivada primeira, resultando em
          
            (35)
            
              
                
                  
                    
                      
                        d
                        2
                      
                      ⁢
                      
                        f
                        i
                      
                    
                    
                      d
                      ⁢
                      
                        x
                        2
                      
                    
                  
                
                =
                
                  
                    
                      
                        4
                        3
                      
                    
                    ⁢
                    
                      
                        
                          
                            
                              f
                              
                                i
                                +
                                1
                              
                            
                            -
                            
                              2
                              ⁢
                              
                                f
                                i
                              
                            
                          
                          +
                          
                            f
                            
                              i
                              -
                              1
                            
                          
                        
                        
                          Δ
                          ⁢
                          
                            x
                            2
                          
                        
                      
                    
                  
                  -
                  
                    
                      
                        1
                        3
                      
                    
                    ⁢
                    
                      
                        
                          
                            
                              f
                              
                                i
                                +
                                2
                              
                            
                            -
                            
                              2
                              ⁢
                              
                                f
                                i
                              
                            
                          
                          +
                          
                            f
                            
                              i
                              -
                              2
                            
                          
                        
                        
                          4
                          ⁢
                          Δ
                          ⁢
                          
                            x
                            2
                          
                        
                      
                    
                  
                
              
            
            
              
                
                  
                  =
                  
                    
                      
                        
                          
                            
                              
                                -
                                
                                  f
                                  
                                    i
                                    -
                                    2
                                  
                                
                              
                              +
                              
                                16
                                ⁢
                                
                                  f
                                  
                                    i
                                    -
                                    1
                                  
                                
                              
                            
                            -
                            
                              30
                              ⁢
                              
                                f
                                i
                              
                            
                          
                          +
                          
                            16
                            ⁢
                            
                              f
                              
                                i
                                +
                                1
                              
                            
                          
                        
                        -
                        
                          f
                          
                            i
                            +
                            2
                          
                        
                      
                      
                        12
                        ⁢
                        Δ
                        ⁢
                        
                          x
                          2
                        
                      
                    
                  
                
                .
              
            
          
        
        
          4.1.2. Propriedades das formulações de MDF
          O MDF permite resolver equações diferenciais parciais (EDP), como é o caso da equação da onda, através da aplicação de diferenças finitas na equação que se deseja resolver numericamente. A equação algébrica (sistema linear) advinda deste processo de discretização é denominada de equação de diferenças finitas. Para que a resposta da equação de diferenças finitas (EDF) represente de forma satisfatória a solução da EDP original, é necessário que exigir que algumas propriedades sejam satisfeitas para que se possa de fato obter soluções numéricas limitadas (não infinitas) e uteis. A seguir, são discutidas estas propriedades de forma qualitativa e, na seção 4.2.1, são apresentados critérios quantitativos para garantir respostas acuradas na formulação para a equação da onda adotada aqui.
        
        
          Consistência
          Uma EDF é consistente com uma EDP se a diferença entre a EDF e a EDP (o erro de truncamento da série de Taylor) vai a zero quando o espaçamento da malha e o incremento de tempo vão a zero independentemente, ou seja,
          
            
              (36)
              
                
                  
                    
                      
                        |
                        
                          EDP
                          -
                          EDF
                        
                        |
                      
                      →
                      
                        0
                         
                        se
                      
                    
                     
                    
                      
                        
                          Δ
                          ⁢
                          t
                        
                        →
                        0
                      
                      ,
                      
                        h
                        →
                        0
                      
                    
                  
                  .
                
              
            
          
          Pode acontecer da condição acima ser verdadeira somente quando uma certa relação entre o espaçamento da malha e o passo de tempo é satisfeita. Neste caso, o esquema é dito condicionalmente consistente. É claro que, se o erro de truncamento das aproximações da aproximação é conhecido e proporcional aos espaçamentos e incremento temporal (ou uma potência destes), como ocorre em todos os esquemas derivados com MDF, então a prova de consistência é direta, sendo os esquemas sempre consistente.
        
        
          Estabilidade
          Tal propriedade relaciona-se com o fato de que uma formulação numérica não pode amplificar artificialmente os erros numéricos da solução, o que degradaria completamente a solução numérica do problema ao longo do tempo. Neste sentido, se a solução de uma EDP é limitada, então a solução numérica deve ser limitada também. Como na maioria das vezes a solução de problemas físicos de interesse é limitada, pode-se definir estabilidade numérica como a seguir:
          
            Um esquema de diferenças finitas é estável se produz uma solução limitada quando a solução exata é limitada, e, reversamente, é instável se produz uma solução ilimitada, sendo a solução exata limitada.
          
          Há casos em que a estabilidade do esquema depende do espaçamento da malha e do incremento de tempo, sendo tais esquemas chamados de condicionalmente estáveis. Este é o caso do esquema numérico utilizado neste artigo e de grande parte dos esquemas de diferenças finitas. Na verdade, é o caso dos esquemas de diferenças finitas explícitos. Neste casos, é necessário que o espaçamento da malha e o incremento temporal estejam relacionados entre si de forma adequada, chamada de condição de estabilidade. O pior dos casos ocorre quando o esquema apresenta soluções numéricas ilimitadas para quaisquer valores de espaçamento da malha e incremento temporal, sendo em tais situações chamados de incondicionalmente instáveis. A chamada análise de estabilidade de von Neumann, uma aplicação da análise de Fourier, é o procedimento mais largamente empregado para provar a estabilidade de esquemas de diferenças finitas. Maiores detalhes sobre esta análise podem ser encontrados na Ref. [13].
        
        
          Convergência
          Isoladamente, é a propriedade mais importante. Ela exige que a solução numérica deve convergir para a solução do problema original (regido pela EDP) quando o espaçamento da malha e o incremento temporal tenderem a zero. Infelizmente, provar que um esquema é convergente é bem mais complicado do que provar a consistência e a estabilidade. Por este motivo, um teorema de importância prática imensa é conhecido como Teorema da Equivalência de Lax-Richtmyer [13, 14]. Tal teorema estabelece que um esquema é convergente se ele é estável e consistente. Assim, a tarefa de provar a convergência é substituída pelas tarefas mais simples de provar a consistência e a estabilidade.
        
      
      
        4.2. Formulação explícita adotada
        Nesta seção, será apresentada uma discretização simples da Eq. (10). Além disso, serão abordados critérios práticos para que tais soluções sejam adequadas.
        O esquema abordado aqui utiliza expressões de quarta ordem no espaço (Eq. 35) e de segunda ordem no tempo (utilizando expressão análoga à Eq. 34 para o tempo). Em 2D, a equação de diferenças (que fornece a solução numérica) é obtida substituindo-se as aproximações e isolando no primeiro membro o termo do tempo mais avançando dado por Pi,kn+1, obtendo-se:
        
          (37)
          
            
              
                P
                
                  i
                  ,
                  j
                
                
                  n
                  +
                  1
                
              
              =
              
                δ
                
                  i
                  ,
                  j
                
              
              
                [
                -
                
                  (
                  
                    P
                    
                      
                        i
                        +
                        2
                      
                      ,
                      j
                    
                    n
                  
                  +
                  
                    P
                    
                      i
                      ,
                      
                        j
                        +
                        2
                      
                    
                    n
                  
                  +
                  
                    P
                    
                      
                        i
                        -
                        2
                      
                      ,
                      j
                    
                    n
                  
                  +
                  
                    P
                    
                      i
                      ,
                      
                        j
                        -
                        2
                      
                    
                    n
                  
                  )
                
              
            
          
          
            
               
              +
              16
              
                (
                
                  P
                  
                    
                      i
                      +
                      1
                    
                    ,
                    j
                  
                  n
                
                +
                
                  P
                  
                    i
                    ,
                    
                      j
                      +
                      1
                    
                  
                  n
                
                +
                
                  P
                  
                    
                      i
                      -
                      1
                    
                    ,
                    j
                  
                  n
                
                +
                
                  P
                  
                    i
                    ,
                    
                      j
                      -
                      1
                    
                  
                  n
                
                )
              
              -
              60
              
                P
                
                  i
                  ,
                  j
                
                n
              
              ]
            
          
          
            
              
                
                   
                  +
                  
                    2
                    ⁢
                    
                      P
                      
                        i
                        ,
                        j
                      
                      n
                    
                  
                
                -
                
                  P
                  
                    i
                    ,
                    j
                  
                  
                    n
                    -
                    1
                  
                
              
              ,
            
          
        
        onde o parâmetro numérico definido acima é dado por
        
          
            (38)
            
              
                
                  
                    δ
                    
                      i
                      ,
                      j
                    
                  
                  =
                  
                    
                      Δ
                      ⁢
                      
                        t
                        2
                      
                      ⁢
                      
                        C
                        
                          i
                          ,
                          j
                        
                        2
                      
                    
                    
                      12
                      ⁢
                      h
                    
                  
                
                .
              
            
          
        
        Um fato importante em relação à discretização no tempo é que esquemas em quarta ordem (utilizando expressão análoga à Eq. 35 para o tempo) são incondicionalmente instáveis [20]. Por outro lado, as derivadas espaciais podem ser aproximadas em ordens mais elevadas sem problemas, o que é feito para minimizar a dispersão numérica (ver seção 4.2.1).
        Observa-se que, na formulação numérica apresentada, somente a velocidade c de propagação da onda é considerada, sendo este o único parâmetro que descreve o meio. Embora a densidade ρ apareça multiplicando a fonte, ela é considerada apenas no ponto onde ela é aplicada. Já a velocidade deve ser fornecida ponto a ponto no esquema, sendo este chamado de esquema heterogêneo (como definido na Ref. [21]).
        A formulação de diferenças finitas definida pela Eq. 37 é uma formulação explícita, uma vez que a resposta pode ser calculada explicitamente nos tempos futuros em função de tempos anteriores. Dadas condições iniciais conhecidas (em n = 0), isto permite que a solução seja calculada de forma explicita no passo de tempo seguinte (em n = 1) em função de valores de Pi,k0 conhecidos no tempo nulo e de valores Pi,k-1 no passo anterior (todos iguais a zero, pois são tempos anteriores ao da aplicação da fonte, no qual o meio encontra-se em equilíbrio). De forma geral, conhecendo-se Pi,kn e Pi,kn-1, pode-se calcular todos os valores de pressão no passo de tempo n + 1 e este processo continua iterativamente por Nt passos até que se atinja um determinado tempo final tf = NtΔt de análise. Esquemas explícitos têm a vantagem de não necessitarem de solução de sistemas lineares a cada passo de tempo, um processo bem mais dispendioso computacionalmente se comparado à marcha explícita.
        Os pontos de pressão discretos (sobre a malha de diferenças finitas) necessários para o cômputo de um ponto de pressão no tempo futuro definem o que se chama de estêncil do operador de diferenças finitas, conforme mostrado na Fig. 8.
        
          Figura 8
          
            Estêncil do esquema de diferenças finitas.
          
          
            
            
          
        
        A seguir, será tratada a implementação computacional. Além da simplicidade mostrada acima para a obtenção de esquemas de diferenças finitas e da simplicidade conceitual do MDF, outra grande vantagem do método reside na simplicidade da programação de esquemas explícitos. Além disso, a solução numérica numérica é de boa qualidade, em especial para problemas de propagação de ondas, desde que sejam satisfeitas as condições discutidas na seção 4.2.1, i.e., desde que se satisfaça o critério de estabilidade e se utilize espaçamentos da malha e incremento temporal pequeno o suficiente para que e se tenha uma boa precisão numérica.
        No código computacional, em primeiro lugar, deve-se definir os parâmetros físicos associados ao problema. Estes são: o domínio de propagação da onda, ou seja, o tamanho X e Z do modelo 2D (em metros, por exemplo); as velocidades de propagação de onda no meio, definidas ponto a ponto no domínio; e a frequência de corte da fonte. Os parâmetros numéricos também precisam ser definidos de forma adequada, como será detalhado na seção 4.2.1. Os principais parâmetros numéricos são: os espaçamentos da malha Δx e Δz, que define os números de pontos Nz×Nx, e o incremento temporal Δt, que define o número de passos Nt.
        Um algoritmo básico é apresentado (Algoritmo 8) e explicado na sequência. Primeiro, deve-se declarar as variáveis necessárias para a solução do problema, definir os parâmetros físicos e numérico associados ou lê-los de arquivo. Caso sejam lidos de arquivo durante a execução do programa, as matrizes de Nz×Nx posições devem ser alocadas dinamicamente, após tais parâmetros terem sido lidos e alternativamente, de forma mais simples, tais matrizes podem ser declaradas se Nz e Nx são declarados como parâmetros. Na linha 8, o modelo de velocidade é lido para a matriz de velocidades. Na linha 8, deve-se realizar alguns cálculos iniciais, como: (1) zerar as matrizes P1 e P2 que irão guardar os valores de pressão na malha em instantes de tempo consecutivos, respectivamente em n−1 e n, necessários para a marcha explícita no tempo (cálculo de P3 em n + 1), (2) calcular parâmetros da fonte, como os dados pelas Eq. 12–14 e (3) a matriz δ é calculada (Eq. 38).
        
          Algoritmo 1
          
            Propagação de onda
          
          
            
            
          
        
        A linha 8 dá início à marcha no tempo propriamente dita (laço sobre o número de passos de tempo n). Na linha 10, a fonte sísmica é aplicada no ponto kf×if da malha, utilizando-se uma função definida pelo usuário, com base na Eq. 11. A fonte é aplicada por meio da introdução do valor da fonte na posição correta da malha, por meio da matriz P1. Assim, ela será corretamente considerada quando executada a linha 14 na posição da fonte. Repare que a fonte só será aplicada se o passo de tempo for menor ou igual que a variável inteira Nfonte que especifica o número de passos de tempo onde a fonte é não nula, conforme definido pela Eq. 15. Deve-se utilizar Nfonte como o inteiro de valor mais próximo de tM/Δt (tM dado pela Eq. 16). Entre as linha 12–16, o operador de diferença finita, dado pela Eq. 37, é calculado em cada ponto da malha através de um laço duplo. Na linha 14, F(P2) representa todos os valores de P2 necessários para o cômputo de P3, dados pelos pontos entre colchetes na Eq.37 (Fig. 8).
        Na linha 17, foram agrupadas em uma subrotina todo o tratamento das bordas, ou seja, a aplicação de segunda ordem nos pontos próximos ao contorno, a aplicação de p = 0 na superfície, das equações one-way da onda nas demais bordas, bem como as camadas de Cerjan. Detalhamento sobre esta subrotina é deixado como exercício para o leitor interessado em implementar o código utilizando uma linguagem de programação. As linhas 18–22 escrevem os snapshots em arquivos a cada Nsnap passos, onde MOD(a,b) retorna o resto da divisão inteira a/b. As linhas 22–24 salvam o sismograma na matriz Sismo (cada um dos NR receptores em (z,x) = iprof,xk), posteriormente escrita em arquivo. Na linha 25, os campos de pressão são atualizados para continuar a marcha. Dentro de um laço duplo sob toda a malha, utiliza-se as atribuições: P1(i, k)←P2(i, k), P2(i, k)←P3(i, k).
        
          4.2.1. Critérios práticos para acurácia
          Um esquema numérico pode satisfazer todas as propriedades discutidas acima (seção 4.1.2) e ainda assim apresentar respostas numéricas com acurácia insuficiente para uma determinada aplicação. Intuitivamente, vê-se que a precisão da solução numérica depende dos parâmetros h e Δt adotados e, a princípio, quanto menores forem, melhor a resposta. Na realidade, o assunto é mais complexo como o leitor mais atento deve ter notado da discussão acima sobre estabilidade, em especial, do fato do nosso esquema ser condicionalmente estável.
          Como dito, tais esquemas requerem a utilização de parâmetros h e Δt relacionados entre si, respeitando a condição de estabilidade. Entretanto, mesmo satisfazendo esta condição – que a rigor só garante que os erros numéricos não se tornem incontroláveis durante a marcha no tempo –, as soluções podem se desviar bastante da solução esperada, sendo necessário impor valores h e Δt ainda menores para garantir um determinado grau de acurácia da solução.
          Um estudo detalhado relativo à obtenção do critério de estabilidade ou sobre a acurácia de formulações de diferenças finitas está fora do escopo deste trabalho. Ao leitor interessado em aprofundar-se no assunto, indica-se os mesmos livros de referência citados no início da seção 4. Aqui, apresenta-se, em lugar disso, alguns critérios práticos que, uma vez aplicados, garantem que as soluções numéricas vistas acima possuam estabilidade e precisão suficiente para inúmeras aplicações. Assim, frente aos parâmetros físicos do problema em questão (e.g., velocidade do meio, frequência da fonte), impõe-se a necessidade de os parâmetros numéricos satisfazerem os critérios apresentados abaixo.
          Antes de apresentar os critérios, entretanto, faz-se necessário algumas explicações adicionais. As soluções numéricas de problemas ondulatórios estão sujeitas ao problema conhecido como dispersão numérica. Isto é, no caso de meios não dispersivos e isotrópicos, como os regidos pela equação acústica da onda, as velocidades de fase e de grupo (ver conceito na Ref. [8, 22]) coincidem e são independentes da frequência e do ângulo de propagação. Quando discretiza-se o domínio do problema através do MDF, estas velocidades passam a ser função do espaçamento utilizado para a malha, além da velocidade de propagação do meio, da frequência e do ângulo de propagação. Para minimizar o nível de dispersão numérica a um patamar adequado (e imperceptível nas escala de tempo que será adotada) basta impor o seguinte critério:
          
            
              (39)
              
                
                  
                    h
                    ≤
                    
                      
                        c
                        
                          m
                          ⁢
                          i
                          ⁢
                          n
                        
                      
                      
                        α
                        ⁢
                        
                          f
                          
                            c
                            ⁢
                            o
                            ⁢
                            r
                            ⁢
                            t
                            ⁢
                            e
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde h é o espaçamento da malha, fcorte é a frequência de corte da fonte, isto é, a frequência máxima presente, cmin é a velocidade mínima presente no modelo de velocidades e α é um parâmetro que varia de acordo com a aproximação numérica utilizada. Assim definido, o parâmetro α representa o número de pontos discretos por comprimento de onda, onde se considera o menor comprimento de onda presente (referente à menor velocidade e à maior frequência).
          Em esquemas de diferenças finitas utilizando operador de segunda ordem no tempo e quarta ordem no espaço, como o discutido aqui, valores de α = 5 são suficientes para um boa precisão. Utilizando operadores de segunda ordem no espaço, é necessário utilizar α = 10. Enfatiza-se, ainda, que estes valores dependem do esquema numérico considerado, podendo variar para outras formulações.
          Para que a solução tenha estabilidade numérica, por outro lado, garantindo ainda um alto grau de precisão numérica, o seguinte critério deve ser satisfeito pelos parâmetros numéricos:
          
            
              (40)
              
                
                  
                    
                      Δ
                      ⁢
                      t
                    
                    ≤
                    
                      h
                      
                        β
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde Δt é o intervalo de tempo, h é espaçamento da malha, cmax é a velocidade máxima presente no modelo e β é um parâmetro obtido de forma empírica.
          A relação acima é similar ao critério de Courant-Friedrich-Levy (CFL). Ela expressa a necessidade do intervalo de tempo considerado ter de ser menor que o menor tempo que a onda leva pra atravessar uma célula de diferenças finitas (ou seja, considerando-se a maior velocidade no meio). Assim, β pode ser interpretado como o número de iterações necessárias para levar esta informação de um ponto a outro. Valores de β = 4 são suficientes para garantir a estabilidade da resposta numérica e um bom grau de precisão.
       </span>
      </span>
     </span>
     . Aqui, apresenta-se, em lugar disso, alguns critérios práticos que, uma vez aplicados, garantem que as soluções numéricas vistas acima possuam estabilidade e precisão suficiente para inúmeras aplicações. Assim, frente aos parâmetros físicos do problema em questão (e.g., velocidade do meio, frequência da fonte), impõe-se a necessidade de os parâmetros numéricos satisfazerem os critérios apresentados abaixo.
    </p>
    <p>
     Antes de apresentar os critérios, entretanto, faz-se necessário algumas explicações adicionais. As soluções numéricas de problemas ondulatórios estão sujeitas ao problema conhecido como dispersão numérica. Isto é, no caso de meios não dispersivos e isotrópicos, como os regidos pela equação acústica da onda, as velocidades de fase e de grupo (ver conceito na Ref. [
     <span class="ref">
      <sup class="xref xrefblue">
       8
      </sup>
      <span class="refCtt closed">
       <span>
        8. M. Nussenzweig, Curso de Física Básica (Edgard Blücher, São Paulo, 1996), v. 2, 3ª ed.
       </span>
      </span>
     </span>
     ,
     <span class="ref">
      <sup class="xref xrefblue">
       22
      </sup>
      <span class="refCtt closed">
       <span>
        22. K.F. Graff, Wave Motion in Elastic Solids (Dover Publication, Mineola, 1991).
       </span>
      </span>
     </span>
     ]) coincidem e são independentes da frequência e do ângulo de propagação. Quando discretiza-se o domínio do problema através do MDF, estas velocidades passam a ser função do espaçamento utilizado para a malha, além da velocidade de propagação do meio, da frequência e do ângulo de propagação. Para minimizar o nível de dispersão numérica a um patamar adequado (e imperceptível nas escala de tempo que será adotada) basta impor o seguinte critério:
    </p>
    <p>
    </p>
    <div class="row formula" id="eS4_E39">
     <a name="S4_E39">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (39)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mi>
           h
          </mi>
          <mo>
           ≤
          </mo>
          <mfrac>
           <msub>
            <mi>
             c
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              i
             </mi>
             <mo>
              ⁢
             </mo>
             <mi>
              n
             </mi>
            </mrow>
           </msub>
           <mrow>
            <mi>
             α
            </mi>
            <mo>
             ⁢
            </mo>
            <msub>
             <mi>
              f
             </mi>
             <mrow>
              <mi>
               c
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               o
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               r
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               t
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               e
              </mi>
             </mrow>
            </msub>
           </mrow>
          </mfrac>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde
     <i>
      h
     </i>
     é o espaçamento da malha,
     <i>
      f
     </i>
     <sub>
      <i>
       corte
      </i>
     </sub>
     é a frequência de corte da fonte, isto é, a frequência máxima presente,
     <i>
      c
     </i>
     <sub>
      <i>
       min
      </i>
     </sub>
     é a velocidade mínima presente no modelo de velocidades e α é um parâmetro que varia de acordo com a aproximação numérica utilizada. Assim definido, o parâmetro α representa o número de pontos discretos por comprimento de onda, onde se considera o menor comprimento de onda presente (referente à menor velocidade e à maior frequência).
    </p>
    <p>
     Em esquemas de diferenças finitas utilizando operador de segunda ordem no tempo e quarta ordem no espaço, como o discutido aqui, valores de
     <i>
      α
     </i>
     = 5 são suficientes para um boa precisão. Utilizando operadores de segunda ordem no espaço, é necessário utilizar
     <i>
      α
     </i>
     = 10. Enfatiza-se, ainda, que estes valores dependem do esquema numérico considerado, podendo variar para outras formulações.
    </p>
    <p>
     Para que a solução tenha estabilidade numérica, por outro lado, garantindo ainda um alto grau de precisão numérica, o seguinte critério deve ser satisfeito pelos parâmetros numéricos:
    </p>
    <p>
    </p>
    <div class="row formula" id="eS4_E40">
     <a name="S4_E40">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (40)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mi mathvariant="normal">
            Δ
           </mi>
           <mo>
            ⁢
           </mo>
           <mi>
            t
           </mi>
          </mrow>
          <mo>
           ≤
          </mo>
          <mfrac>
           <mi>
            h
           </mi>
           <mrow>
            <mi>
             β
            </mi>
            <mo>
             ⁢
            </mo>
            <msub>
             <mi>
              c
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               a
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               x
              </mi>
             </mrow>
            </msub>
           </mrow>
          </mfrac>
         </mrow>
         <mo>
          ,
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     onde Δ
     <i>
      t
     </i>
     é o intervalo de tempo,
     <i>
      h
     </i>
     é espaçamento da malha,
     <i>
      c
     </i>
     <sub>
      <i>
       max
      </i>
     </sub>
     é a velocidade máxima presente no modelo e β é um parâmetro obtido de forma empírica.
    </p>
    <p>
     A relação acima é similar ao critério de Courant-Friedrich-Levy (CFL). Ela expressa a necessidade do intervalo de tempo considerado ter de ser menor que o menor tempo que a onda leva pra atravessar uma célula de diferenças finitas (ou seja, considerando-se a maior velocidade no meio). Assim, β pode ser interpretado como o número de iterações necessárias para levar esta informação de um ponto a outro. Valores de
     <i>
      β
     </i>
     = 4 são suficientes para garantir a estabilidade da resposta numérica e um bom grau de precisão.
    </p>
    <h1 class="articleSectionTitle">
     5. Aplicação ao “imageamento” sísmico
    </h1>
    <p>
     Esta seção discute como a equação acústica da onda e as soluções numéricas obtidas anteriormente podem ser utilizadas para construção de um método que é capaz de gerar imagens associadas a descontinuidades de propriedades físicas do meio, no caso em questão, à velocidade de propagação.
    </p>
    <h2>
     5.1. Aquisição sísmica
    </h2>
    <p>
     A seguir, apresenta-se uma aquisição sísmica sintética realizada com um programa escrito em Fortran 90 seguindo o algoritmo explicado anteriormente. O modelo rodado está representado na Fig.
     <a class="open-asset-modal" data-target="#ModalFigS5_F9" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      9
     </a>
     . Ele foi derivado do modelo desenvolvido pela Hess Corporation e disponibilizado por cortesia pela empresa, sendo mantido na Internet pela Society of Exploration Geophysicists (SEG) para que interessados possam utilizar. Trata-se de uma modelo
     <i>
      offshore
     </i>
     (em mar) interessante do ponto de vista geológico, uma vez que contém um corpo salino de alta velocidade (
     <i>
      c
     </i>
     = 4500 m/s) à esquerda e uma grande falha à direita. Originalmente ele é um modelo anisotrópico, como simetria vertical transversa (ver artigo II), embora seja utilizado aqui neste primeiro artigo da série considerando-se os parâmetros de anisotropia iguais a zero.
    </p>
    <div class="row fig" id="S5_F9">
     <a name="S5_F9">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS5_F9" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/d61ac0e643106211a96e5524f9c1178e55aa56cb.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 9
      </strong>
      <br/>
      Modelo de velocidades acústico utilizado, baseado no modelo Hess.
      <br/>
     </div>
    </div>
    <p>
     O modelo Hess é composto originalmente por 3617×1501 pontos e uma lâmina d’água pouco profunda. O modelo utilizado aqui teve sua camada de água expandida e foi reamostrado para 2001×601 pontos, de modo a ser factível rodar os exemplos deste trabalho com a máquina disponível em tempo razoável. Como o espaçamento utilizado foi de
     <i>
      h
     </i>
     = 7 m, o tamanho total do modelo ficou em 14,0×4,2 km. A fonte empregada foi um pulso de Ricker de frequência
     <i>
      f
     </i>
     <sub>
      <i>
       corte
      </i>
     </sub>
     = 40 Hz e o incremento temporal adotado foi de Δ
     <i>
      t
     </i>
     = 3,8×10
     <sup>
      −4
     </sup>
     s, sendo o número de passos no tempo adotado de
     <i>
      N
     </i>
     <sub>
      <i>
       t
      </i>
     </sub>
     = 9000, totalizando um tempo de análise total de
     <i>
      t
     </i>
     <sub>
      <i>
       f
      </i>
     </sub>
     = 3,42 s. Com isto, os parâmetros numéricos ficaram de acordo com o recomendado no tópico
     <span class="ref footnote">
      <sup class="xref">
       4.2.1
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        4.2.1. Critérios práticos para acurácia
          Um esquema numérico pode satisfazer todas as propriedades discutidas acima (seção 4.1.2) e ainda assim apresentar respostas numéricas com acurácia insuficiente para uma determinada aplicação. Intuitivamente, vê-se que a precisão da solução numérica depende dos parâmetros h e Δt adotados e, a princípio, quanto menores forem, melhor a resposta. Na realidade, o assunto é mais complexo como o leitor mais atento deve ter notado da discussão acima sobre estabilidade, em especial, do fato do nosso esquema ser condicionalmente estável.
          Como dito, tais esquemas requerem a utilização de parâmetros h e Δt relacionados entre si, respeitando a condição de estabilidade. Entretanto, mesmo satisfazendo esta condição – que a rigor só garante que os erros numéricos não se tornem incontroláveis durante a marcha no tempo –, as soluções podem se desviar bastante da solução esperada, sendo necessário impor valores h e Δt ainda menores para garantir um determinado grau de acurácia da solução.
          Um estudo detalhado relativo à obtenção do critério de estabilidade ou sobre a acurácia de formulações de diferenças finitas está fora do escopo deste trabalho. Ao leitor interessado em aprofundar-se no assunto, indica-se os mesmos livros de referência citados no início da seção 4. Aqui, apresenta-se, em lugar disso, alguns critérios práticos que, uma vez aplicados, garantem que as soluções numéricas vistas acima possuam estabilidade e precisão suficiente para inúmeras aplicações. Assim, frente aos parâmetros físicos do problema em questão (e.g., velocidade do meio, frequência da fonte), impõe-se a necessidade de os parâmetros numéricos satisfazerem os critérios apresentados abaixo.
          Antes de apresentar os critérios, entretanto, faz-se necessário algumas explicações adicionais. As soluções numéricas de problemas ondulatórios estão sujeitas ao problema conhecido como dispersão numérica. Isto é, no caso de meios não dispersivos e isotrópicos, como os regidos pela equação acústica da onda, as velocidades de fase e de grupo (ver conceito na Ref. [8, 22]) coincidem e são independentes da frequência e do ângulo de propagação. Quando discretiza-se o domínio do problema através do MDF, estas velocidades passam a ser função do espaçamento utilizado para a malha, além da velocidade de propagação do meio, da frequência e do ângulo de propagação. Para minimizar o nível de dispersão numérica a um patamar adequado (e imperceptível nas escala de tempo que será adotada) basta impor o seguinte critério:
          
            
              (39)
              
                
                  
                    h
                    ≤
                    
                      
                        c
                        
                          m
                          ⁢
                          i
                          ⁢
                          n
                        
                      
                      
                        α
                        ⁢
                        
                          f
                          
                            c
                            ⁢
                            o
                            ⁢
                            r
                            ⁢
                            t
                            ⁢
                            e
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde h é o espaçamento da malha, fcorte é a frequência de corte da fonte, isto é, a frequência máxima presente, cmin é a velocidade mínima presente no modelo de velocidades e α é um parâmetro que varia de acordo com a aproximação numérica utilizada. Assim definido, o parâmetro α representa o número de pontos discretos por comprimento de onda, onde se considera o menor comprimento de onda presente (referente à menor velocidade e à maior frequência).
          Em esquemas de diferenças finitas utilizando operador de segunda ordem no tempo e quarta ordem no espaço, como o discutido aqui, valores de α = 5 são suficientes para um boa precisão. Utilizando operadores de segunda ordem no espaço, é necessário utilizar α = 10. Enfatiza-se, ainda, que estes valores dependem do esquema numérico considerado, podendo variar para outras formulações.
          Para que a solução tenha estabilidade numérica, por outro lado, garantindo ainda um alto grau de precisão numérica, o seguinte critério deve ser satisfeito pelos parâmetros numéricos:
          
            
              (40)
              
                
                  
                    
                      Δ
                      ⁢
                      t
                    
                    ≤
                    
                      h
                      
                        β
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde Δt é o intervalo de tempo, h é espaçamento da malha, cmax é a velocidade máxima presente no modelo e β é um parâmetro obtido de forma empírica.
          A relação acima é similar ao critério de Courant-Friedrich-Levy (CFL). Ela expressa a necessidade do intervalo de tempo considerado ter de ser menor que o menor tempo que a onda leva pra atravessar uma célula de diferenças finitas (ou seja, considerando-se a maior velocidade no meio). Assim, β pode ser interpretado como o número de iterações necessárias para levar esta informação de um ponto a outro. Valores de β = 4 são suficientes para garantir a estabilidade da resposta numérica e um bom grau de precisão.
       </span>
      </span>
     </span>
     , ou seja, o número α (pontos por comprimento de onda mínimo) não inferior a 5 e o número de passos de tempo β (iterações necessárias para levar a informação mais rápida de um ponto a outro da malha) não inferior a 4:
    </p>
    <div class="row formula" id="eS5_E41">
     <a name="S5_E41">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (41)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mi>
           α
          </mi>
          <mo>
           =
          </mo>
          <mstyle displaystyle="true">
           <mfrac>
            <msub>
             <mi>
              c
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               i
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               n
              </mi>
             </mrow>
            </msub>
            <mrow>
             <mi>
              h
             </mi>
             <mo>
              ⁢
             </mo>
             <msub>
              <mi>
               f
              </mi>
              <mrow>
               <mi>
                c
               </mi>
               <mo>
                ⁢
               </mo>
               <mi>
                o
               </mi>
               <mo>
                ⁢
               </mo>
               <mi>
                r
               </mi>
               <mo>
                ⁢
               </mo>
               <mi>
                t
               </mi>
               <mo>
                ⁢
               </mo>
               <mi>
                e
               </mi>
              </mrow>
             </msub>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           =
          </mo>
          <mstyle displaystyle="true">
           <mfrac>
            <mn>
             1500
            </mn>
            <mrow>
             <mn>
              7
             </mn>
             <mo>
              ×
             </mo>
             <mn>
              40
             </mn>
            </mrow>
           </mfrac>
          </mstyle>
          <mo>
           ≈
          </mo>
          <mn>
           5
          </mn>
         </mrow>
         <mo>
          ,
         </mo>
         <mn>
          4
         </mn>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <div class="row formula" id="eS5_E42">
     <a name="S5_E42">
     </a>
     <div class="col-md-12">
      <div class="formula-container">
       <span class="label">
        (42)
       </span>
       <math display="block">
        <mrow>
         <mrow>
          <mrow>
           <mi>
            β
           </mi>
           <mo>
            =
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mi>
              h
             </mi>
             <mrow>
              <mi mathvariant="normal">
               Δ
              </mi>
              <mo>
               ⁢
              </mo>
              <mi>
               t
              </mi>
              <mo>
               ⁢
              </mo>
              <msub>
               <mi>
                c
               </mi>
               <mrow>
                <mi>
                 m
                </mi>
                <mo>
                 ⁢
                </mo>
                <mi>
                 a
                </mi>
                <mo>
                 ⁢
                </mo>
                <mi>
                 x
                </mi>
               </mrow>
              </msub>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            =
           </mo>
           <mstyle displaystyle="true">
            <mfrac>
             <mn>
              7
             </mn>
             <mrow>
              <mn>
               3
              </mn>
              <mo>
               ,
              </mo>
              <mrow>
               <mn>
                8
               </mn>
               <mo>
                ×
               </mo>
               <msup>
                <mn>
                 10
                </mn>
                <mrow>
                 <mo>
                  -
                 </mo>
                 <mn>
                  4
                 </mn>
                </mrow>
               </msup>
               <mo>
                ×
               </mo>
               <mn>
                4500
               </mn>
              </mrow>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>
            ≈
           </mo>
           <mn>
            4
           </mn>
          </mrow>
          <mo>
           ,
          </mo>
          <mn>
           1
          </mn>
         </mrow>
         <mo>
          .
         </mo>
        </mrow>
       </math>
      </div>
     </div>
    </div>
    <p>
     Tais valores garantem uma precisão numérica adequada. Como os valores estão próximos dos ideais estipulados, garante-se que a modelagem não utilize mais recursos computacionais que o necessário para o problema em questão. Por exemplo, rodar um modelo com as mesmas dimensões físicas e pelo mesmo tempo total de análise utilizando
     <i>
      α
     </i>
     = 10 (o que equivale a reduzir o
     <i>
      h
     </i>
     pela metade) implicaria, no caso 2D, em quadruplicar o número de pontos da malha, multiplicando o tempo de processamento pelo mesmo fator. Além disso, ao reduzir o
     <i>
      h
     </i>
     pela metade, o Δ
     <i>
      t
     </i>
     também precisa ser reduzido pela metade para satisfazer a Eq.
     <a class="open-asset-modal" data-target="#ModalSchemeS4_E40" data-toggle="modal" href="">
      <span class="sci-ico-fileFormula">
      </span>
      40
     </a>
     , implicando na necessidade de dar o dobro do número de passos de tempo. No total, o tempo de processamento teria aumentado 8 vezes, além do maior gasto de memória.
    </p>
    <p>
     Na aquisição sintética rodada, um navio arrasta os receptores atrás de si, andando para a direita com a geometria de aquisição descrita a seguir. A cobertura do cabo de receptores é de 2,1 km, onde os receptores estão espaçados de 70 m (sendo 70 m o
     <i>
      offset
     </i>
     mínimo), totalizando 30 receptores localizados a esquerda da fonte sísmica (como mostrado esquematicamente na Fig.
     <a class="open-asset-modal" data-target="#ModalFigS5_F9" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      9
     </a>
     ): a linha tracejada
     <i>
      R
     </i>
     representa os receptores e os asteriscos representam a fonte nas posições em que foram aplicadas. A distância entre os tiros foi também de 70 m e, no total, foram dados 165 tiros, com a posição inicial de
     <i>
      x
     </i>
     = 2,1 km. Somente as posições do primeiro tiro e dos tiros 10, 60, 110 e 160 são apresentadas na Fig.
     <a class="open-asset-modal" data-target="#ModalFigS5_F9" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      9
     </a>
     . Cada tiro demorou cerca de 7 minutos para roda em uma máquina com processador Intel i7 de 3.4 GHz.
    </p>
    <p>
     Alguns instantâneos mostrando a distribuição do campo de pressão no domínio para um determinado tempo, para diferentes tempos, referente ao tiro 60, são apresentados na Fig.
     <a class="open-asset-modal" data-target="#ModalFigS5_F10" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      10
     </a>
     .
    </p>
    <div class="row fig" id="S5_F10">
     <a name="S5_F10">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS5_F10" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/182f8a0f092870af08cf6312a1d42beac9ecea7c.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 10
      </strong>
      <br/>
      Snapshots da propagação da onda para o tiro 60 nos tempos (a)
      <i>
       t
      </i>
      = 1,33s, (b)
      <i>
       t
      </i>
      = 1,90s, (c)
      <i>
       t
      </i>
      = 2,47s e (d)
      <i>
       t
      </i>
      = 3,04s.
      <br/>
     </div>
    </div>
    <p>
     Na Figura
     <a class="open-asset-modal" data-target="#ModalFigS5_F11" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      11
     </a>
     , são apresentados os sismogramas dos tiros 10, 60, 110 e 160 (mostrados na Fig.
     <a class="open-asset-modal" data-target="#ModalFigS5_F9" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      9
     </a>
     ), ou seja, as respostas ao longo do tempo (no eixo vertical) para cada receptor (no eixo horizontal), dispostos em ordem crescente de
     <i>
      offset
     </i>
     (distância entre fonte e receptor).
    </p>
    <div class="row fig" id="S5_F11">
     <a name="S5_F11">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS5_F11" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/db2887dbad47c79bcf94f3ff035738a77b6ac5c9.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 11
      </strong>
      <br/>
      Sismogramas adquiridos nas posições indicadas na Fig.
      <a class="open-asset-modal" data-target="#ModalFigS5_F9" data-toggle="modal" href="">
       <span class="sci-ico-fileFigure">
       </span>
       9
      </a>
      , referentes aos tiros de número (a) 10, (b) 60, (c) 110, (d) 160.
      <br/>
     </div>
    </div>
    <p>
     Através dos
     <i>
      snapshots
     </i>
     (instantâneos do campo de propagação em termos de pressão acústica), pode-se acompanhar a propagação da onda, desde a fonte até ser refletida e retornar aos receptores. Assim, pode-se identificar os diversos eventos coerentes presentes em um sismograma (que seja apresentado posteriormente). É fácil mostrar que as reflexões em interfaces planas são caracterizadas por hipérboles no sismograma, as chamadas hipérboles de reflexão. Quando os receptores não são planos, pode haver desvios da forma hiperbólica. Mesmo não sendo planos, eles podem ser aproximadamente planos localmente (como é o caso deste exemplo), dependendo do tamanho do cabo de receptores em comparação com a curvatura do refletor.
    </p>
    <p>
     Em geral, sismogramas contém inúmeras hipérboles que podem ser facilmente identificadas em meio aos mais variados
     <i>
      ruídos coerentes
     </i>
     (que são eventos assim considerados uma vez que não se tratam de reflexões, como, por exemplo, as refrações). Neste exemplo, não foram inseridos ruídos adicionais (há, entretanto, ruídos numéricos, imperceptíveis nos instantâneos), e sismogramas representam as respostas puras das simulações de propagação, contendo todos os eventos associados a esta propagação, como por exemplo as múltiplas (eventos que ocorrem quando a onda atinge a superfície do modelo, sendo refletiva e retornando para baixo em direção aos refletores novamente, atingindo por fim os receptores mais uma vez).
    </p>
    <p>
     O primeiro evento hiperbólico que aparece em cada um dos sismogramas sintéticos da Fig.
     <a class="open-asset-modal" data-target="#ModalFigS5_F11" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      11
     </a>
     caracteriza a reflexão no fundo do mar, sendo as demais curvas associadas à reflexão nas demais interfaces e no sal, bem como reflexões múltiplas. A reta inclinada que aparece sempre na mesma posição em todos os sismogramas é a onda direta que se propaga na água, desde a fonte até os receptores. Quanto mais longe o receptor está da fonte (maior o
     <i>
      offset
     </i>
     ), mais tempo a onda irá levar para chegar ao receptor. No tiro 60 (Fig.
     <a class="open-asset-modal" data-target="#ModalFigS5_F11" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      11
     </a>
     (b)), como exemplo de identificação de eventos nos sismograma sintético, chama-se a atenção para o sexto evento de reflexão, com amplitude acentuada, aproximadamente entre os tempos 2,25 e 2,5 s. Pode-se ver claramente através dos snapshots (em especial, da Fig.
     <a class="open-asset-modal" data-target="#ModalFigS5_F10" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      10
     </a>
     (a)) que ele caracteriza a reflexão no corpo de sal.
    </p>
    <h2>
     5.2. Mapeamentos dos refletores
    </h2>
    <p>
     Nesta seção, dentro do escopo do método sísmico, serão apresentadas as ideais fundamentais sobre o “imageamento” (mapeamento dos refletores) utilizando a equação da onda aplicada no sentido inverso do tempo, denominado de Migração Reversa no Tempo pré-empilhamento na literatura especializada da área de Geofísica Aplicada. Posteriormente, são descritas em detalhes as etapas do algoritmo de mapeamento e, na sequência, as alterações necessárias no algoritmo de modelagem direta para a sua programação em computador utilizando uma linguagem de programação de alto nível (neste trabalho, foi utilizada a linguagem Fortran, como já mencionado).
    </p>
    <p>
     Neste artigo, diferente do procedimento padrão realizado rotineiramente na indústria, o algoritmo será aplicado a dados sintéticos, gerados com o algoritmo de modelagem direta. Enfatiza-se que este tipo de migração (sintética) é muito utilizado para verifica a eficácia de um determinado método, por exemplo, frente a uma configuração geológica de interesse.
    </p>
    <p>
     Matematicamente, o problema do imageamento é um problema inverso, em contraposição ao problema direto da propagação da onda. No problema direto, as propriedade do meio são conhecidas e se deseja obter as respostas relativas à propagação da onda neste meio. No problema inverso, a resposta da propagação da onda no meio é conhecida e queremos utilizá-la, de forma inversa, para obter informações sobre o meio.
    </p>
    <p>
     Contudo, o problema do imageamento dentro do escopo do método sísmico abordado neste trabalho é um problema inverso aproximado, uma vez que ele utiliza o que se chama de macromodelo de velocidades como informação a priori (
     <i>
      input
     </i>
     do algoritmo). Como discutido anteriormente na seção
     <span class="ref footnote">
      <sup class="xref">
       2
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        2. Conceitos fundamentais de Sísmica
      Nesta seção, são discutidos alguns conceitos importantes sobre o Método Sísmico (ou, simplesmente, Sísmica) de forma bem direcionada aos nossos objetivos, ou seja, modelagem de propagação de ondas e sua a aplicação ao mapeamento de estruturas. Para uma abordagem completa e ainda introdutória, indicamos a Ref. [4]. Para uma abordagem mais detalhada e especializada, a Ref. [5] é a mais indicada.
      O método sísmico de reflexão é o principal método da geofísica aplicada, no caso específico de exploração e caracterização de reservatórios de hidrocarbonetos (petróleo e gás natural), no sentido de que é o que recebe maiores investimentos por parte da indústria do petróleo. Por esta razão é também o método mais desenvolvido. Ele constitui-se de 3 etapas principais: aquisição, processamento e interpretação.
      Na primeira, realizam-se in situ experimentos sísmicos cujo objetivo é fazer propagar ondas sísmicas na região de interesse, captando, em seguida, as ondas refletidas provenientes do meio ao longo do tempo. Na etapa de processamento, realizam-se procedimentos com o intuito de extrair as informações geológicas contidas nos dados coletados, gerando imagens da conformação geológica. De forma simplificada, pode-se dizer que o objetivo final desta etapa é obter uma imagem. Por fim, na terceira etapa, a imagem é interpretada (seja ela 2D ou 3D, como nas modernas aquisições e processamentos sísmicos), em conjunto com todas as informações geológicas e petrofísicas aferidas, visando identificar possíveis reservatórios.
      As ondas que se propagam no interior de materiais sólidos em geral – como as camadas de rochas sedimentares que compõe as bacias sedimentares que abrigam os reservatórios de hidrocarbonetos – podem ser de dois tipos (Fig. 1): além das ondas longitudinais, acústicas, na sismologia chamadas de ondas principais (ou simplesmente ondas P), tratadas neste artigo, ocorrem também ondas cisalhantes (ondas secundárias ou ondas S), conversões entre estes tipos de onda e ondas de superfície. Claramente, as ondas S não se propagam em fluidos, uma vez que estes meios não apresentam resistência ao cisalhamento, como ocorre em material sólido.
      
        Figura 1
        
          Ondas de corpo: (a) onda P e (b) onda S.
        
        
          
          
        
      
      Para descrever de forma mais detalhada a propagação de ondas em sólidos, é necessário lançar mão da chamada teoria da elasticidade (ou ainda de teorias mais sofisticadas), onde são corretamente tratadas tanto as ondas P quanto as ondas S, bem como as conversões de energia entre estes modos de onda quando da passagem das ondas através de interface onde há descontinuidade das propriedade físicas. Além disso, são corretamente descritas também as ondas de superfície, ondas que se propagam apenas próximo à superfície ou interfaces. As ondas P são mais rápidas que as S e ambos os modos de onda obedecem às leis usuais da refração e reflexão de ondas [6] (Lei de Snell):
      
        
          (1)
          
            
              
                
                  c
                  1
                
                ⁢
                sen
                ⁢
                
                  θ
                  1
                
              
              =
              
                
                  c
                  2
                
                ⁢
                sen
                ⁢
                
                  θ
                  2
                
              
            
          
        
      
      onde c1 e c2 são as velocidades de propagação da onda nos respectivos meios e θ1 e θ2 são os ângulos de incidência e transmissão (ou reflexão).
      É importante mencionar que a teoria acústica, que será utilizada neste trabalho, descreve corretamente a propagação de ondas P na Terra, mesmo não sendo capaz de descrever as ondas S e as conversões. Assim, tal teoria, de fato, pode ser utilizada para o imageamento de estruturas geológicas desde que aplicada apenas à energia associada a ondas P medidas em campo, aplicação em que é empregada mais comumente na indústria, devido a maior eficiência computacional dos algoritmos acústicos.
      Em relação aos tipos de levantamento realizados dentro do escopo do Método Sísmico, a chamada sísmica de reflexão é a mais comum. Ela objetiva coletar a energia de reflexões da onda sísmica que retornam à superfície após atingir regiões em subsuperfície com contraste de impedância acústica (I = ρc, sendo ρ e c, respectivamente a densidade e a velocidade de propagação da onda no meio). Outro tipo de aquisição é a chamada sísmica de refração, onde se objetiva captar a energia que sofre reflexão total (quando θ2 = π/2, refração no jargão da área) em uma interface.
      Em uma aquisição típica de sísmica de reflexão, uma fonte de ondas sísmicas é aplicada (usualmente próxima à superfície, em terra ou em mar), de forma que estas se propagam para o interior da área de interesse, ou seja, é gerado um sismo artificial de magnitude pequena. Quando encontra descontinuidades, a onda gerada pela fonte é refletida (como mencionado, proporcionalmente ao contraste de impedância acústica) e se dirige em direção à superfície, onde pode ser registrada e gravada para posteriormente ser processada e transformada em informação útil, especialmente para exploração de hidrocarbonetos. A fonte é detonada diversas vezes, varrendo, desta forma, imensas áreas e coletando grandes volumes de dados. A geometria de disposição das fontes e dos receptores influencia diretamente a qualidade final da imagem que poderá ser obtida. Outro aspecto fundamental é a redundância de informações, que possibilitará, no final das contas, aumentar a razão sinal-ruído e extrair informações sobre as velocidades de propagação do meio.
      As aquisições feitas em mar aberto são operações realizadas de forma muito eficiente por navios próprios de aquisição sísmica. Os navios sísmicos atuais tem o tamanho de um campo de futebol e podem arrastar cabos de mais de 10 km. Nestas aquisições, são empregados arranjos de canhões de ar, dispostos próximos ao navio, como geradores de energia símica. Em navios de última geração, é possível utilizar 20 cabos ou um pouco mais (chamados de streamer), com distância entre eles de 50 m e comprimento de até 12 km. Nestes cabos estão dispostos os arranjos de hidrofones (receptores). Para se ter uma ideia de valores, se a distância entre tiros consecutivos em uma determinada aquisição é de 50 m, a velocidade do navio é de 5 nós (cerca de 2,5 m/s) e o tempo total de registro é de 6–10 s. Tipicamente, é possível varrer 100 km2 ou mais em um turno de operação em águas livres. Uma aquisição de novos dados pode custar milhões de dólares.
      As ondas registradas em superfície contém informações preciosas sobre a geologia em subsuperfície. Neste sentido, o conjunto de dados como um todo contém informações sobre as reflexões, refrações e difrações dos diversos modos de onda e de conversões destes modos de onda ao se propagarem na região de interesse. Mesmo em aquisições marítimas, onde são medidas as respostas apenas da componente compressional das ondas, há informações sobre as diversas conversões ocorridas em subsuperfície. Toda estas informações podem ser divididas em duas componentes, sendo a primeira relativa aos tempos de trânsito e a segunda relativa às amplitudes das ondas sísmicas. Os tempos de trânsito são utilizados para extrair informações chamadas de cinemáticas (no jargão geofísico), ou seja, informações relativas à posição dos refletores, as quais são influenciadas apenas pelo perfil de velocidades (de acordo com a Lei de Snell). Já as amplitudes podem ser utilizadas para obter informações de outra natureza (dinâmicas), relacionadas com os coeficientes de reflexão entre as camadas rochosas e consequentemente com diversas propriedades do meio, como a densidade do meio de propagação.
      Em relação ao registro sísmico, após a geração artificial da perturbação pela fonte sísmica, o mesmo é feito por arranjos de equipamentos semelhantes a microfones, conhecidos como geofones (medido em terra) ou hidrofones (medido na água), dispostos, em geral, na superfície – no caso da chamada sísmica de superfície. Os geofones podem coletar dados multicomponentes enquanto os hidrofones coletam apenas informação da variação da pressão na água. Cada uma das medidas, coletada por um equipamento, é denominada de traço sísmico. Ao conjunto de dados obtidos dá-se o nome de sismogramas. Os sismogramas associados a cada tiro são denominados de painéis de tiro comum (common shot gathers). Tais registros contém informações da variação da pressão (no caso da água) ao longo do tempo para cada hidrofone que, por sua vez, são arranjados a diferentes distâncias da fonte (offset), como já mencionado.
      Na segunda etapa, após a aquisição, os dados sísmicos são processados digitalmente com o objetivo final de se gerar uma imagem da região de interesse. Nesta etapa, são realizados procedimentos com o intuito de atenuar sinais não desejados e aumentar a razão sinal-ruído. Ao final, são realizados procedimentos objetivando fazer uma imagem dos refletores, colapsando as reflexões e difrações presentes nos sismogramas para suas corretas posições em profundidade (ou mesmo em tempo), processo chamado de migração sísmica.
      O termo migração está associado às antigas técnicas geométricas (baseadas em traçado de raio, utilizando princípios como a Lei de Snell), baseadas em registros sísmicos feitos em papel. Buscava-se migrar as posições dos eventos observados nos sismogramas analógicos para suas corretas posições em tempo usando instrumentos típicos de desenho. Tais métodos de migração manual foram utilizados durante grande parte da primeira metade do séc. XX, sendo baseados em princípios geométricos simples, válidos apenas para configurações geológicas bem comportadas, como exemplificado para o caso de refletor plano (Fig. 2).
      
        Figura 2
        
          Migração de um refletor inclinado: em (a), é mostrada uma configuração geológica, formada por um trecho de refletor plano inclinado, sendo mostradas em fi e ri, respectivamente, as posições iniciais e finais das fontes e receptores e, em (b), mostra-se a “migração” dos eventos A e B para suas corretas posições em tempo (A e B).
       </span>
      </span>
     </span>
     , o objetivo principal dos diferentes métodos aplicados para o imageamento em sísmica de reflexão, conhecidos genericamente como métodos de migração, é o reposicionamento da energia sísmica medida para a suas corretas posições em subsuperfície, retirando as distorções introduzidas pela propagação da onda. Ou seja, objetiva-se obter uma imagem dos refletores e difratores em subsuperfície, relacionados com a geologia local.
    </p>
    <p>
     Dentro do longo fluxo de processamento utilizado rotineiramente pela indústria nestes problemas, é realizado previamente ao imageamento um procedimento chamado de análise de velocidades, onde se objetiva estimar o macromodelo que será utilizado na etapa de migração. Ele poderá ser utilizado para a migração ou, o que é mais comum, servirá de base para algum procedimento mais avançado para geração do macromodelo final, e.g., tomografia ou inversão da forma de onda completa (
     <i>
      full waveform inversion
     </i>
     , um procedimento de inversão não linear). É importante mencionar que a imagem gerada com a utilização do macromodelo, ou seja, o resultado da migração, fornece indícios sobre a qualidade do macromodelo. Quando o “foco” das imagens é ruim ou existem refletores se cruzando, por exemplo, sabe-se que há problemas. Quando isto ocorre, é comum que o processo de imageamento, quando aplicado em campo, seja feito mais de uma vez, até se chegar a uma solução considerada de qualidade suficiente pelo
     <i>
      interprete
     </i>
     (o geofísico responsável pela interpretação da imagem com o objetivo final de decidir a locação de um poço exploratório que irá comprovar ou não a existência de hidrocarbonetos no alvo previamente selecionado).
    </p>
    <p>
     Existem muitos métodos de migração diferentes, sendo um dos mais populares a chamada migração Kirchhoff, uma técnica que utiliza uma solução integral do problema de propagação de ondas para imagear estruturas. Ela é muito utilizada porque é uma técnica extremamente rápida onde as soluções integrais são implementadas de forma muito eficiente através de somatórios, sem marcha no tempo. Esta técnica, entretanto, não é adequada para utilização em modelos com algo grau de complexidade, como aqueles associados a regiões envolvendo tectônica salina, por exemplo. Nestes casos, em que o modelo de velocidade é complexo, os métodos de migração sísmica baseados na equação da onda vêm ganhando destaque. Não somente os crescentes desafios exploratórios, mas também o desenvolvimento de computadores mais rápidos (
     <i>
      clusters
     </i>
     ) e com maior capacidade de armazenamento, tonaram este um ramo importante. Estes métodos são conhecidos genericamente por métodos de migração baseados na equação da onda. Nestes métodos, os algoritmos de modelagem e de migração são utilizados em conjunto, apresentando as mesmas características.
    </p>
    <p>
     O que eles têm em comum é o fato de resolverem alguma aproximação da equação diferencial da onda (ou mesmo a equação completa), através da propagação direta do campo, diferentemente do método de migração Kirchhoff, que é baseado em soluções integrais desta equação, nas quais o campo de onda não é propagado. Tais métodos podem diferir quanto ao domínio utilizado (tempo ou frequência), quanto ao tipo de equação da onda utilizada (acústica ou elástica) e quanto à aproximação utilizada para resolver numericamente a equação da onda, como por exemplo a aproximação unidirecional que considera apenas o campo de onda descendente.
    </p>
    <p>
     Neste trabalho, será utilizada a equação acústica completa da onda, resolvida no domínio do tempo, o que caracteriza a Migração Reversa no Tempo. Especificamente, se utilizará a técnica que migra tiros separados e empilha as imagens resultantes de cada tiro ao final para obter a imagem completa, ou seja, a técnica pré-empilhamento. A migração pré-empilhamento apresenta resultados muito melhores do que a técnica pós-empilhamento, onde os dados são empilhados antes da realização da migração. O processo de empilhamento antes da migração sofre de problemas sérios para “focar” a energia em regiões complexas, o que terminam por degradar a imagem final. Entretanto, como a técnica de migração pós-empilhamento é aplicada apenas uma vez (a toda a seção empilhada), ele demanda muitos menos tempo de computação que a migração pré-empilhamento, sendo escolhida em alguns casos práticos por esta vantagem.
    </p>
    <p>
     A seguir, serão abordadas as etapas do método de migração utilizando propagação do campo de ondas reversamente no tempo, ou seja, a Migração Reversa no Tempo pré-empilhamento que é a técnica que será aplicada neste artigo.
    </p>
    <p>
     Pode-se dizer que o método de imageamento discutido neste artigo é o mais simples e intuitivo do ponto de vista conceitual para o imageamento sísmico.
    </p>
    <p>
     Por simplicidade, aqui o método será discutido levando em conta a aplicação a um único tiro (sismograma de tiro), com ênfase nas ideias fundamentais. Para obter uma imagem completa da região de interesse, é necessário que se aplique o algoritmo a diversos tiros e posteriormente as imagens são somadas (processo chamado de empilhamento).
    </p>
    <p>
     Em primeiro lugar, como dito anteriormente, o algoritmo desenvolvido aqui será aplicado a um exemplo sintético, ou seja, os sismogramas que serão utilizados para imagear estruturas em subsuperfície vêm de uma modelagem numérica do problema direto. Isto evita a necessidade de pré-processar os dados antes de migrar, de forma a ser possível se concentrar na parte conceitual do método e ainda assim chegar a um resultado final de excelente qualidade.
    </p>
    <p>
     Tudo o que será explicado aqui se aplicada da mesma forma a dados reais. De uma forma ou de outra, a migração pressupõe a existência de um dado a ser migrado (no nosso caso, os sismogramas de tiro, como os mostrados no tópico
     <span class="ref footnote">
      <sup class="xref">
       5.1
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        5.1. Aquisição sísmica
        A seguir, apresenta-se uma aquisição sísmica sintética realizada com um programa escrito em Fortran 90 seguindo o algoritmo explicado anteriormente. O modelo rodado está representado na Fig. 9. Ele foi derivado do modelo desenvolvido pela Hess Corporation e disponibilizado por cortesia pela empresa, sendo mantido na Internet pela Society of Exploration Geophysicists (SEG) para que interessados possam utilizar. Trata-se de uma modelo offshore (em mar) interessante do ponto de vista geológico, uma vez que contém um corpo salino de alta velocidade (c = 4500 m/s) à esquerda e uma grande falha à direita. Originalmente ele é um modelo anisotrópico, como simetria vertical transversa (ver artigo II), embora seja utilizado aqui neste primeiro artigo da série considerando-se os parâmetros de anisotropia iguais a zero.
        
          Figura 9
          
            Modelo de velocidades acústico utilizado, baseado no modelo Hess.
          
          
            
            
          
        
        O modelo Hess é composto originalmente por 3617×1501 pontos e uma lâmina d’água pouco profunda. O modelo utilizado aqui teve sua camada de água expandida e foi reamostrado para 2001×601 pontos, de modo a ser factível rodar os exemplos deste trabalho com a máquina disponível em tempo razoável. Como o espaçamento utilizado foi de h = 7 m, o tamanho total do modelo ficou em 14,0×4,2 km. A fonte empregada foi um pulso de Ricker de frequência fcorte = 40 Hz e o incremento temporal adotado foi de Δt = 3,8×10−4 s, sendo o número de passos no tempo adotado de Nt = 9000, totalizando um tempo de análise total de tf = 3,42 s. Com isto, os parâmetros numéricos ficaram de acordo com o recomendado no tópico 4.2.1, ou seja, o número α (pontos por comprimento de onda mínimo) não inferior a 5 e o número de passos de tempo β (iterações necessárias para levar a informação mais rápida de um ponto a outro da malha) não inferior a 4:
        
          (41)
          
            
              
                α
                =
                
                  
                    
                      c
                      
                        m
                        ⁢
                        i
                        ⁢
                        n
                      
                    
                    
                      h
                      ⁢
                      
                        f
                        
                          c
                          ⁢
                          o
                          ⁢
                          r
                          ⁢
                          t
                          ⁢
                          e
                        
                      
                    
                  
                
                =
                
                  
                    1500
                    
                      7
                      ×
                      40
                    
                  
                
                ≈
                5
              
              ,
              4
            
          
        
        
          (42)
          
            
              
                
                  β
                  =
                  
                    
                      h
                      
                        Δ
                        ⁢
                        t
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  =
                  
                    
                      7
                      
                        3
                        ,
                        
                          8
                          ×
                          
                            10
                            
                              -
                              4
                            
                          
                          ×
                          4500
                        
                      
                    
                  
                  ≈
                  4
                
                ,
                1
              
              .
            
          
        
        Tais valores garantem uma precisão numérica adequada. Como os valores estão próximos dos ideais estipulados, garante-se que a modelagem não utilize mais recursos computacionais que o necessário para o problema em questão. Por exemplo, rodar um modelo com as mesmas dimensões físicas e pelo mesmo tempo total de análise utilizando α = 10 (o que equivale a reduzir o h pela metade) implicaria, no caso 2D, em quadruplicar o número de pontos da malha, multiplicando o tempo de processamento pelo mesmo fator. Além disso, ao reduzir o h pela metade, o Δt também precisa ser reduzido pela metade para satisfazer a Eq. 40, implicando na necessidade de dar o dobro do número de passos de tempo. No total, o tempo de processamento teria aumentado 8 vezes, além do maior gasto de memória.
        Na aquisição sintética rodada, um navio arrasta os receptores atrás de si, andando para a direita com a geometria de aquisição descrita a seguir. A cobertura do cabo de receptores é de 2,1 km, onde os receptores estão espaçados de 70 m (sendo 70 m o offset mínimo), totalizando 30 receptores localizados a esquerda da fonte sísmica (como mostrado esquematicamente na Fig. 9): a linha tracejada R representa os receptores e os asteriscos representam a fonte nas posições em que foram aplicadas. A distância entre os tiros foi também de 70 m e, no total, foram dados 165 tiros, com a posição inicial de x = 2,1 km. Somente as posições do primeiro tiro e dos tiros 10, 60, 110 e 160 são apresentadas na Fig. 9. Cada tiro demorou cerca de 7 minutos para roda em uma máquina com processador Intel i7 de 3.4 GHz.
        Alguns instantâneos mostrando a distribuição do campo de pressão no domínio para um determinado tempo, para diferentes tempos, referente ao tiro 60, são apresentados na Fig. 10.
        
          Figura 10
          
            Snapshots da propagação da onda para o tiro 60 nos tempos (a) t = 1,33s, (b) t = 1,90s, (c) t = 2,47s e (d) t = 3,04s.
          
          
            
            
          
        
        Na Figura 11, são apresentados os sismogramas dos tiros 10, 60, 110 e 160 (mostrados na Fig. 9), ou seja, as respostas ao longo do tempo (no eixo vertical) para cada receptor (no eixo horizontal), dispostos em ordem crescente de offset (distância entre fonte e receptor).
        
          Figura 11
          
            Sismogramas adquiridos nas posições indicadas na Fig. 9, referentes aos tiros de número (a) 10, (b) 60, (c) 110, (d) 160.
          
          
            
            
          
        
        Através dos snapshots (instantâneos do campo de propagação em termos de pressão acústica), pode-se acompanhar a propagação da onda, desde a fonte até ser refletida e retornar aos receptores. Assim, pode-se identificar os diversos eventos coerentes presentes em um sismograma (que seja apresentado posteriormente). É fácil mostrar que as reflexões em interfaces planas são caracterizadas por hipérboles no sismograma, as chamadas hipérboles de reflexão. Quando os receptores não são planos, pode haver desvios da forma hiperbólica. Mesmo não sendo planos, eles podem ser aproximadamente planos localmente (como é o caso deste exemplo), dependendo do tamanho do cabo de receptores em comparação com a curvatura do refletor.
        Em geral, sismogramas contém inúmeras hipérboles que podem ser facilmente identificadas em meio aos mais variados ruídos coerentes (que são eventos assim considerados uma vez que não se tratam de reflexões, como, por exemplo, as refrações). Neste exemplo, não foram inseridos ruídos adicionais (há, entretanto, ruídos numéricos, imperceptíveis nos instantâneos), e sismogramas representam as respostas puras das simulações de propagação, contendo todos os eventos associados a esta propagação, como por exemplo as múltiplas (eventos que ocorrem quando a onda atinge a superfície do modelo, sendo refletiva e retornando para baixo em direção aos refletores novamente, atingindo por fim os receptores mais uma vez).
        O primeiro evento hiperbólico que aparece em cada um dos sismogramas sintéticos da Fig. 11 caracteriza a reflexão no fundo do mar, sendo as demais curvas associadas à reflexão nas demais interfaces e no sal, bem como reflexões múltiplas. A reta inclinada que aparece sempre na mesma posição em todos os sismogramas é a onda direta que se propaga na água, desde a fonte até os receptores. Quanto mais longe o receptor está da fonte (maior o offset), mais tempo a onda irá levar para chegar ao receptor. No tiro 60 (Fig. 11(b)), como exemplo de identificação de eventos nos sismograma sintético, chama-se a atenção para o sexto evento de reflexão, com amplitude acentuada, aproximadamente entre os tempos 2,25 e 2,5 s. Pode-se ver claramente através dos snapshots (em especial, da Fig. 10(a)) que ele caracteriza a reflexão no corpo de sal.
       </span>
      </span>
     </span>
     ). Além disso, é necessário o conhecimento prévio do macromodelo de velocidades, como discutido acima. Como irá se trabalhar com dados sintéticos, o modelo de velocidade é conhecido. Ao invés do modelo de velocidades conhecido (que possui descontinuidades de propriedades física), serão utilizados modelos suavizados, onde as reflexões serão bastante atenuadas. Isto é feito para evitar distorções nos tempos de trânsito, devendo ser suavizado o modelo de vagarosidade (inverso da velocidade), como discutido na Ref. [
     <span class="ref">
      <sup class="xref xrefblue">
       12
      </sup>
      <span class="refCtt closed">
       <span>
        12. D. Loewenthal, P.L. Stoffa e E.L. Faria, Geophysics 52 , 1007 (1987).
       </span>
      </span>
     </span>
     ].
    </p>
    <p>
     A primeira etapa da RTM consiste na propagação da onda no sentido direto do tempo, onde os tempos de chegada da onda direta em cada ponto do domínio são calculados e registrados na chamada Matriz de Tempo de Trânsito (MTT). Na segunda etapa, a energia do sismograma que se deseja imagear (seja um sismograma real, vindo de campo, ou um sintético) é reintroduzida no domínio, através da aplicação dos valores medidos pelos receptores como fonte (na posição em que foram medidos) e propagando-se no sentido inverso do tempo final de análise até o tempo inicial). Uma imagem para esta segunda etapa é a seguinte: considerando-se a onda que foi propagada da fonte até os receptores com um filme, a segunda etapa nada mais é do que voltar o filme para trás, até o início, de forma que os instantâneos vão ficando com o formato da fonte sísmica no exato local em que foi aplicada. Aplica-se, então, uma condição de imagem responsável por fazer com que a energia propagada no sentido inverso do tempo pare no local em que foi gerada através de uma reflexão ou difração. Em outras palavras, a condição de imagem é responsável por posicionar a energia na sua correta posição em subsuperfície.
    </p>
    <p>
     A condição de imagem estabelece que um ponto imagem
     <i>
      P
     </i>
     é todo aquele em que o tempo da onda depropagada é igual ao tempo da onda direta (dado pela MTT previamente calculada). Esta condição está representada esquematicamente na Fig.
     <a class="open-asset-modal" data-target="#ModalFigS5_F12" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      12
     </a>
     . Ela é chamada de condição e imagem por tempo de excitação.
    </p>
    <div class="row fig" id="S5_F12">
     <a name="S5_F12">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS5_F12" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/20507492c2d214bfa3d0bd610247fe4e161a24ff.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 12
      </strong>
      <br/>
      Condição de imagem.
      <br/>
     </div>
    </div>
    <p>
     A seguir, detalha-se cada uma das etapas citadas acima, com ênfase na sua aplicação computacional, sendo os respectivos algoritmos discutidos em detalhes. Posteriormente, com o objetivo de exemplificar e tornar claro todo o processo, os algoritmos serão aplicados aos dados sintéticos apresentados no tópico
     <span class="ref footnote">
      <sup class="xref">
       5.1
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        5.1. Aquisição sísmica
        A seguir, apresenta-se uma aquisição sísmica sintética realizada com um programa escrito em Fortran 90 seguindo o algoritmo explicado anteriormente. O modelo rodado está representado na Fig. 9. Ele foi derivado do modelo desenvolvido pela Hess Corporation e disponibilizado por cortesia pela empresa, sendo mantido na Internet pela Society of Exploration Geophysicists (SEG) para que interessados possam utilizar. Trata-se de uma modelo offshore (em mar) interessante do ponto de vista geológico, uma vez que contém um corpo salino de alta velocidade (c = 4500 m/s) à esquerda e uma grande falha à direita. Originalmente ele é um modelo anisotrópico, como simetria vertical transversa (ver artigo II), embora seja utilizado aqui neste primeiro artigo da série considerando-se os parâmetros de anisotropia iguais a zero.
        
          Figura 9
          
            Modelo de velocidades acústico utilizado, baseado no modelo Hess.
          
          
            
            
          
        
        O modelo Hess é composto originalmente por 3617×1501 pontos e uma lâmina d’água pouco profunda. O modelo utilizado aqui teve sua camada de água expandida e foi reamostrado para 2001×601 pontos, de modo a ser factível rodar os exemplos deste trabalho com a máquina disponível em tempo razoável. Como o espaçamento utilizado foi de h = 7 m, o tamanho total do modelo ficou em 14,0×4,2 km. A fonte empregada foi um pulso de Ricker de frequência fcorte = 40 Hz e o incremento temporal adotado foi de Δt = 3,8×10−4 s, sendo o número de passos no tempo adotado de Nt = 9000, totalizando um tempo de análise total de tf = 3,42 s. Com isto, os parâmetros numéricos ficaram de acordo com o recomendado no tópico 4.2.1, ou seja, o número α (pontos por comprimento de onda mínimo) não inferior a 5 e o número de passos de tempo β (iterações necessárias para levar a informação mais rápida de um ponto a outro da malha) não inferior a 4:
        
          (41)
          
            
              
                α
                =
                
                  
                    
                      c
                      
                        m
                        ⁢
                        i
                        ⁢
                        n
                      
                    
                    
                      h
                      ⁢
                      
                        f
                        
                          c
                          ⁢
                          o
                          ⁢
                          r
                          ⁢
                          t
                          ⁢
                          e
                        
                      
                    
                  
                
                =
                
                  
                    1500
                    
                      7
                      ×
                      40
                    
                  
                
                ≈
                5
              
              ,
              4
            
          
        
        
          (42)
          
            
              
                
                  β
                  =
                  
                    
                      h
                      
                        Δ
                        ⁢
                        t
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  =
                  
                    
                      7
                      
                        3
                        ,
                        
                          8
                          ×
                          
                            10
                            
                              -
                              4
                            
                          
                          ×
                          4500
                        
                      
                    
                  
                  ≈
                  4
                
                ,
                1
              
              .
            
          
        
        Tais valores garantem uma precisão numérica adequada. Como os valores estão próximos dos ideais estipulados, garante-se que a modelagem não utilize mais recursos computacionais que o necessário para o problema em questão. Por exemplo, rodar um modelo com as mesmas dimensões físicas e pelo mesmo tempo total de análise utilizando α = 10 (o que equivale a reduzir o h pela metade) implicaria, no caso 2D, em quadruplicar o número de pontos da malha, multiplicando o tempo de processamento pelo mesmo fator. Além disso, ao reduzir o h pela metade, o Δt também precisa ser reduzido pela metade para satisfazer a Eq. 40, implicando na necessidade de dar o dobro do número de passos de tempo. No total, o tempo de processamento teria aumentado 8 vezes, além do maior gasto de memória.
        Na aquisição sintética rodada, um navio arrasta os receptores atrás de si, andando para a direita com a geometria de aquisição descrita a seguir. A cobertura do cabo de receptores é de 2,1 km, onde os receptores estão espaçados de 70 m (sendo 70 m o offset mínimo), totalizando 30 receptores localizados a esquerda da fonte sísmica (como mostrado esquematicamente na Fig. 9): a linha tracejada R representa os receptores e os asteriscos representam a fonte nas posições em que foram aplicadas. A distância entre os tiros foi também de 70 m e, no total, foram dados 165 tiros, com a posição inicial de x = 2,1 km. Somente as posições do primeiro tiro e dos tiros 10, 60, 110 e 160 são apresentadas na Fig. 9. Cada tiro demorou cerca de 7 minutos para roda em uma máquina com processador Intel i7 de 3.4 GHz.
        Alguns instantâneos mostrando a distribuição do campo de pressão no domínio para um determinado tempo, para diferentes tempos, referente ao tiro 60, são apresentados na Fig. 10.
        
          Figura 10
          
            Snapshots da propagação da onda para o tiro 60 nos tempos (a) t = 1,33s, (b) t = 1,90s, (c) t = 2,47s e (d) t = 3,04s.
          
          
            
            
          
        
        Na Figura 11, são apresentados os sismogramas dos tiros 10, 60, 110 e 160 (mostrados na Fig. 9), ou seja, as respostas ao longo do tempo (no eixo vertical) para cada receptor (no eixo horizontal), dispostos em ordem crescente de offset (distância entre fonte e receptor).
        
          Figura 11
          
            Sismogramas adquiridos nas posições indicadas na Fig. 9, referentes aos tiros de número (a) 10, (b) 60, (c) 110, (d) 160.
          
          
            
            
          
        
        Através dos snapshots (instantâneos do campo de propagação em termos de pressão acústica), pode-se acompanhar a propagação da onda, desde a fonte até ser refletida e retornar aos receptores. Assim, pode-se identificar os diversos eventos coerentes presentes em um sismograma (que seja apresentado posteriormente). É fácil mostrar que as reflexões em interfaces planas são caracterizadas por hipérboles no sismograma, as chamadas hipérboles de reflexão. Quando os receptores não são planos, pode haver desvios da forma hiperbólica. Mesmo não sendo planos, eles podem ser aproximadamente planos localmente (como é o caso deste exemplo), dependendo do tamanho do cabo de receptores em comparação com a curvatura do refletor.
        Em geral, sismogramas contém inúmeras hipérboles que podem ser facilmente identificadas em meio aos mais variados ruídos coerentes (que são eventos assim considerados uma vez que não se tratam de reflexões, como, por exemplo, as refrações). Neste exemplo, não foram inseridos ruídos adicionais (há, entretanto, ruídos numéricos, imperceptíveis nos instantâneos), e sismogramas representam as respostas puras das simulações de propagação, contendo todos os eventos associados a esta propagação, como por exemplo as múltiplas (eventos que ocorrem quando a onda atinge a superfície do modelo, sendo refletiva e retornando para baixo em direção aos refletores novamente, atingindo por fim os receptores mais uma vez).
        O primeiro evento hiperbólico que aparece em cada um dos sismogramas sintéticos da Fig. 11 caracteriza a reflexão no fundo do mar, sendo as demais curvas associadas à reflexão nas demais interfaces e no sal, bem como reflexões múltiplas. A reta inclinada que aparece sempre na mesma posição em todos os sismogramas é a onda direta que se propaga na água, desde a fonte até os receptores. Quanto mais longe o receptor está da fonte (maior o offset), mais tempo a onda irá levar para chegar ao receptor. No tiro 60 (Fig. 11(b)), como exemplo de identificação de eventos nos sismograma sintético, chama-se a atenção para o sexto evento de reflexão, com amplitude acentuada, aproximadamente entre os tempos 2,25 e 2,5 s. Pode-se ver claramente através dos snapshots (em especial, da Fig. 10(a)) que ele caracteriza a reflexão no corpo de sal.
       </span>
      </span>
     </span>
     .
    </p>
    <h3>
     5.2.1. Implementação computacional
    </h3>
    <p>
     Cada uma das etapas mencionadas acima é implementada computacionalmente utilizando o código de diferenças finitas discutido na seção
     <span class="ref footnote">
      <sup class="xref">
       4.2
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        4.2. Formulação explícita adotada
        Nesta seção, será apresentada uma discretização simples da Eq. (10). Além disso, serão abordados critérios práticos para que tais soluções sejam adequadas.
        O esquema abordado aqui utiliza expressões de quarta ordem no espaço (Eq. 35) e de segunda ordem no tempo (utilizando expressão análoga à Eq. 34 para o tempo). Em 2D, a equação de diferenças (que fornece a solução numérica) é obtida substituindo-se as aproximações e isolando no primeiro membro o termo do tempo mais avançando dado por Pi,kn+1, obtendo-se:
        
          (37)
          
            
              
                P
                
                  i
                  ,
                  j
                
                
                  n
                  +
                  1
                
              
              =
              
                δ
                
                  i
                  ,
                  j
                
              
              
                [
                -
                
                  (
                  
                    P
                    
                      
                        i
                        +
                        2
                      
                      ,
                      j
                    
                    n
                  
                  +
                  
                    P
                    
                      i
                      ,
                      
                        j
                        +
                        2
                      
                    
                    n
                  
                  +
                  
                    P
                    
                      
                        i
                        -
                        2
                      
                      ,
                      j
                    
                    n
                  
                  +
                  
                    P
                    
                      i
                      ,
                      
                        j
                        -
                        2
                      
                    
                    n
                  
                  )
                
              
            
          
          
            
               
              +
              16
              
                (
                
                  P
                  
                    
                      i
                      +
                      1
                    
                    ,
                    j
                  
                  n
                
                +
                
                  P
                  
                    i
                    ,
                    
                      j
                      +
                      1
                    
                  
                  n
                
                +
                
                  P
                  
                    
                      i
                      -
                      1
                    
                    ,
                    j
                  
                  n
                
                +
                
                  P
                  
                    i
                    ,
                    
                      j
                      -
                      1
                    
                  
                  n
                
                )
              
              -
              60
              
                P
                
                  i
                  ,
                  j
                
                n
              
              ]
            
          
          
            
              
                
                   
                  +
                  
                    2
                    ⁢
                    
                      P
                      
                        i
                        ,
                        j
                      
                      n
                    
                  
                
                -
                
                  P
                  
                    i
                    ,
                    j
                  
                  
                    n
                    -
                    1
                  
                
              
              ,
            
          
        
        onde o parâmetro numérico definido acima é dado por
        
          
            (38)
            
              
                
                  
                    δ
                    
                      i
                      ,
                      j
                    
                  
                  =
                  
                    
                      Δ
                      ⁢
                      
                        t
                        2
                      
                      ⁢
                      
                        C
                        
                          i
                          ,
                          j
                        
                        2
                      
                    
                    
                      12
                      ⁢
                      h
                    
                  
                
                .
              
            
          
        
        Um fato importante em relação à discretização no tempo é que esquemas em quarta ordem (utilizando expressão análoga à Eq. 35 para o tempo) são incondicionalmente instáveis [20]. Por outro lado, as derivadas espaciais podem ser aproximadas em ordens mais elevadas sem problemas, o que é feito para minimizar a dispersão numérica (ver seção 4.2.1).
        Observa-se que, na formulação numérica apresentada, somente a velocidade c de propagação da onda é considerada, sendo este o único parâmetro que descreve o meio. Embora a densidade ρ apareça multiplicando a fonte, ela é considerada apenas no ponto onde ela é aplicada. Já a velocidade deve ser fornecida ponto a ponto no esquema, sendo este chamado de esquema heterogêneo (como definido na Ref. [21]).
        A formulação de diferenças finitas definida pela Eq. 37 é uma formulação explícita, uma vez que a resposta pode ser calculada explicitamente nos tempos futuros em função de tempos anteriores. Dadas condições iniciais conhecidas (em n = 0), isto permite que a solução seja calculada de forma explicita no passo de tempo seguinte (em n = 1) em função de valores de Pi,k0 conhecidos no tempo nulo e de valores Pi,k-1 no passo anterior (todos iguais a zero, pois são tempos anteriores ao da aplicação da fonte, no qual o meio encontra-se em equilíbrio). De forma geral, conhecendo-se Pi,kn e Pi,kn-1, pode-se calcular todos os valores de pressão no passo de tempo n + 1 e este processo continua iterativamente por Nt passos até que se atinja um determinado tempo final tf = NtΔt de análise. Esquemas explícitos têm a vantagem de não necessitarem de solução de sistemas lineares a cada passo de tempo, um processo bem mais dispendioso computacionalmente se comparado à marcha explícita.
        Os pontos de pressão discretos (sobre a malha de diferenças finitas) necessários para o cômputo de um ponto de pressão no tempo futuro definem o que se chama de estêncil do operador de diferenças finitas, conforme mostrado na Fig. 8.
        
          Figura 8
          
            Estêncil do esquema de diferenças finitas.
          
          
            
            
          
        
        A seguir, será tratada a implementação computacional. Além da simplicidade mostrada acima para a obtenção de esquemas de diferenças finitas e da simplicidade conceitual do MDF, outra grande vantagem do método reside na simplicidade da programação de esquemas explícitos. Além disso, a solução numérica numérica é de boa qualidade, em especial para problemas de propagação de ondas, desde que sejam satisfeitas as condições discutidas na seção 4.2.1, i.e., desde que se satisfaça o critério de estabilidade e se utilize espaçamentos da malha e incremento temporal pequeno o suficiente para que e se tenha uma boa precisão numérica.
        No código computacional, em primeiro lugar, deve-se definir os parâmetros físicos associados ao problema. Estes são: o domínio de propagação da onda, ou seja, o tamanho X e Z do modelo 2D (em metros, por exemplo); as velocidades de propagação de onda no meio, definidas ponto a ponto no domínio; e a frequência de corte da fonte. Os parâmetros numéricos também precisam ser definidos de forma adequada, como será detalhado na seção 4.2.1. Os principais parâmetros numéricos são: os espaçamentos da malha Δx e Δz, que define os números de pontos Nz×Nx, e o incremento temporal Δt, que define o número de passos Nt.
        Um algoritmo básico é apresentado (Algoritmo 8) e explicado na sequência. Primeiro, deve-se declarar as variáveis necessárias para a solução do problema, definir os parâmetros físicos e numérico associados ou lê-los de arquivo. Caso sejam lidos de arquivo durante a execução do programa, as matrizes de Nz×Nx posições devem ser alocadas dinamicamente, após tais parâmetros terem sido lidos e alternativamente, de forma mais simples, tais matrizes podem ser declaradas se Nz e Nx são declarados como parâmetros. Na linha 8, o modelo de velocidade é lido para a matriz de velocidades. Na linha 8, deve-se realizar alguns cálculos iniciais, como: (1) zerar as matrizes P1 e P2 que irão guardar os valores de pressão na malha em instantes de tempo consecutivos, respectivamente em n−1 e n, necessários para a marcha explícita no tempo (cálculo de P3 em n + 1), (2) calcular parâmetros da fonte, como os dados pelas Eq. 12–14 e (3) a matriz δ é calculada (Eq. 38).
        
          Algoritmo 1
          
            Propagação de onda
          
          
            
            
          
        
        A linha 8 dá início à marcha no tempo propriamente dita (laço sobre o número de passos de tempo n). Na linha 10, a fonte sísmica é aplicada no ponto kf×if da malha, utilizando-se uma função definida pelo usuário, com base na Eq. 11. A fonte é aplicada por meio da introdução do valor da fonte na posição correta da malha, por meio da matriz P1. Assim, ela será corretamente considerada quando executada a linha 14 na posição da fonte. Repare que a fonte só será aplicada se o passo de tempo for menor ou igual que a variável inteira Nfonte que especifica o número de passos de tempo onde a fonte é não nula, conforme definido pela Eq. 15. Deve-se utilizar Nfonte como o inteiro de valor mais próximo de tM/Δt (tM dado pela Eq. 16). Entre as linha 12–16, o operador de diferença finita, dado pela Eq. 37, é calculado em cada ponto da malha através de um laço duplo. Na linha 14, F(P2) representa todos os valores de P2 necessários para o cômputo de P3, dados pelos pontos entre colchetes na Eq.37 (Fig. 8).
        Na linha 17, foram agrupadas em uma subrotina todo o tratamento das bordas, ou seja, a aplicação de segunda ordem nos pontos próximos ao contorno, a aplicação de p = 0 na superfície, das equações one-way da onda nas demais bordas, bem como as camadas de Cerjan. Detalhamento sobre esta subrotina é deixado como exercício para o leitor interessado em implementar o código utilizando uma linguagem de programação. As linhas 18–22 escrevem os snapshots em arquivos a cada Nsnap passos, onde MOD(a,b) retorna o resto da divisão inteira a/b. As linhas 22–24 salvam o sismograma na matriz Sismo (cada um dos NR receptores em (z,x) = iprof,xk), posteriormente escrita em arquivo. Na linha 25, os campos de pressão são atualizados para continuar a marcha. Dentro de um laço duplo sob toda a malha, utiliza-se as atribuições: P1(i, k)←P2(i, k), P2(i, k)←P3(i, k).
        
          4.2.1. Critérios práticos para acurácia
          Um esquema numérico pode satisfazer todas as propriedades discutidas acima (seção 4.1.2) e ainda assim apresentar respostas numéricas com acurácia insuficiente para uma determinada aplicação. Intuitivamente, vê-se que a precisão da solução numérica depende dos parâmetros h e Δt adotados e, a princípio, quanto menores forem, melhor a resposta. Na realidade, o assunto é mais complexo como o leitor mais atento deve ter notado da discussão acima sobre estabilidade, em especial, do fato do nosso esquema ser condicionalmente estável.
          Como dito, tais esquemas requerem a utilização de parâmetros h e Δt relacionados entre si, respeitando a condição de estabilidade. Entretanto, mesmo satisfazendo esta condição – que a rigor só garante que os erros numéricos não se tornem incontroláveis durante a marcha no tempo –, as soluções podem se desviar bastante da solução esperada, sendo necessário impor valores h e Δt ainda menores para garantir um determinado grau de acurácia da solução.
          Um estudo detalhado relativo à obtenção do critério de estabilidade ou sobre a acurácia de formulações de diferenças finitas está fora do escopo deste trabalho. Ao leitor interessado em aprofundar-se no assunto, indica-se os mesmos livros de referência citados no início da seção 4. Aqui, apresenta-se, em lugar disso, alguns critérios práticos que, uma vez aplicados, garantem que as soluções numéricas vistas acima possuam estabilidade e precisão suficiente para inúmeras aplicações. Assim, frente aos parâmetros físicos do problema em questão (e.g., velocidade do meio, frequência da fonte), impõe-se a necessidade de os parâmetros numéricos satisfazerem os critérios apresentados abaixo.
          Antes de apresentar os critérios, entretanto, faz-se necessário algumas explicações adicionais. As soluções numéricas de problemas ondulatórios estão sujeitas ao problema conhecido como dispersão numérica. Isto é, no caso de meios não dispersivos e isotrópicos, como os regidos pela equação acústica da onda, as velocidades de fase e de grupo (ver conceito na Ref. [8, 22]) coincidem e são independentes da frequência e do ângulo de propagação. Quando discretiza-se o domínio do problema através do MDF, estas velocidades passam a ser função do espaçamento utilizado para a malha, além da velocidade de propagação do meio, da frequência e do ângulo de propagação. Para minimizar o nível de dispersão numérica a um patamar adequado (e imperceptível nas escala de tempo que será adotada) basta impor o seguinte critério:
          
            
              (39)
              
                
                  
                    h
                    ≤
                    
                      
                        c
                        
                          m
                          ⁢
                          i
                          ⁢
                          n
                        
                      
                      
                        α
                        ⁢
                        
                          f
                          
                            c
                            ⁢
                            o
                            ⁢
                            r
                            ⁢
                            t
                            ⁢
                            e
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde h é o espaçamento da malha, fcorte é a frequência de corte da fonte, isto é, a frequência máxima presente, cmin é a velocidade mínima presente no modelo de velocidades e α é um parâmetro que varia de acordo com a aproximação numérica utilizada. Assim definido, o parâmetro α representa o número de pontos discretos por comprimento de onda, onde se considera o menor comprimento de onda presente (referente à menor velocidade e à maior frequência).
          Em esquemas de diferenças finitas utilizando operador de segunda ordem no tempo e quarta ordem no espaço, como o discutido aqui, valores de α = 5 são suficientes para um boa precisão. Utilizando operadores de segunda ordem no espaço, é necessário utilizar α = 10. Enfatiza-se, ainda, que estes valores dependem do esquema numérico considerado, podendo variar para outras formulações.
          Para que a solução tenha estabilidade numérica, por outro lado, garantindo ainda um alto grau de precisão numérica, o seguinte critério deve ser satisfeito pelos parâmetros numéricos:
          
            
              (40)
              
                
                  
                    
                      Δ
                      ⁢
                      t
                    
                    ≤
                    
                      h
                      
                        β
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  ,
                
              
            
          
          onde Δt é o intervalo de tempo, h é espaçamento da malha, cmax é a velocidade máxima presente no modelo e β é um parâmetro obtido de forma empírica.
          A relação acima é similar ao critério de Courant-Friedrich-Levy (CFL). Ela expressa a necessidade do intervalo de tempo considerado ter de ser menor que o menor tempo que a onda leva pra atravessar uma célula de diferenças finitas (ou seja, considerando-se a maior velocidade no meio). Assim, β pode ser interpretado como o número de iterações necessárias para levar esta informação de um ponto a outro. Valores de β = 4 são suficientes para garantir a estabilidade da resposta numérica e um bom grau de precisão.
       </span>
      </span>
     </span>
     com algumas modificações pontuais adequadas para a obtenção de matriz de tempo de trânsito (MTT) e da imagem, respectivamente, na primeira e na segunda etapa, como será detalhado a seguir.
    </p>
    <h3>
     1a Etapa: propagação no sentido direto
    </h3>
    <p>
     Nesta etapa, objetiva-se obter os tempos que a onda direta demora para chegar a cada ponto do domínio, ou seja, a chamada matriz de tempo de trânsito (MTT). Para tal, o algoritmo de propagação de ondas é utilizado. Porém, é necessária lançar mão de algum critério para identificação da onda direta no algoritmo.
    </p>
    <p>
     Um critério simples que pode ser utilizado com bons resultados, embora tenha os seus problemas inerentes, é o critério da amplitude máxima. Com este critério, considera-se o tempo de trânsito da onda com maior amplitude que passa em um determinado ponto do modelo durante o tempo de aquisição. Ou seja, a onda com maior amplitude é interpretada como a onda direta, embora se saiba que há situações em que isto não é verdade. Entretanto, este critério funciona bastante bem porque a amplitude da onda decai a medida que a onda se propaga (devido a divergência esférica) e, além disso, ao sofrer reflexões e refrações, a onda perde energia e, em geral, tem a sua amplitude diminuída. Com isto, a onda direta costuma ser a onda de maior amplitude se comparada às ondas que irão passar posteriormente no mesmo ponto de observação.
    </p>
    <p>
     No Algoritmo
     <a class="open-asset-modal" data-target="#ModalFigF2" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      2
     </a>
     , é apresentado o pseudo-código para obtenção da MTT. A primeira modificação que deve ser feita no algoritmo original (Algoritmo
     <a class="open-asset-modal" data-target="#ModalFigF1" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      1
     </a>
     ), conforme mostrado na linha 5, se deve à utilização do modelo de velocidades suavizado, para evitar a interferência de ondas refletidas em determinados pontos do domínio que interfiram construtivamente e gerem uma onda com amplitude grande que pode ser erroneamente avaliada como uma onda direta.
    </p>
    <div class="row fig" id="S5_F13">
     <a name="S5_F13">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS5_F13" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/d83d5906c329f3ddde12e5c07c1dd5a2e3cb0a80.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 13
      </strong>
      <br/>
      Matriz de tempo de trânsito utilizando o modelo de velocidades (a) não suavizado e (b) suavizado.
      <br/>
     </div>
    </div>
    <p>
     Na Figura
     <a class="open-asset-modal" data-target="#ModalFigS5_F13" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      13
     </a>
     são mostradas, comparativamente, matrizes de tempo de trânsito com condição de máxima amplitude, com e sem a utilização do modelo de velocidades suavizado. Como pode ser visto, a MTT que utilizou o modelo de velocidades suavizado apresenta uma continuidade maior, caracterizando sua maior qualidade em comparação a que usa o modelo não suavizado.
    </p>
    <div class="row fig" id="F2">
     <a name="F2">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigF2" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/6e8f72bacf922a285f91a054ff104d5cefa1c660.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Algoritmo 2
      </strong>
      <br/>
      1a Etapa do imageamento
      <br/>
     </div>
    </div>
    <p>
     Na migração, não se deseja obter sismogramas (e, em geral, nem instantâneos da propagação). Assim, as linhas correspondentes a estas tarefas são substituídas por um código para obter a MTT, mostrado entre as linhas 17–24. Repare que um matriz
     <i>
      Amp
     </i>
     (
     <i>
      N
     </i>
     <sub>
      <i>
       z
      </i>
     </sub>
     ,
     <i>
      N
     </i>
     <sub>
      <i>
       x
      </i>
     </sub>
     ) auxiliar é utilizada para armazenar as amplitudes atuais dos tempos registrados para cada posição da malha. Tais amplitudes são verificadas em cada ponto da malha (a cada passo de tempo) e, caso a amplitude atual no ponto seja maior que a armazenada, registra-se então o novo tempo associado a esta amplitude. Quando a maior amplitude passa pelo ponto, o tempo correspondente é armazenado. O processo deixa então de registrar novos tempos, uma vez que eles estarão associados a amplitudes menores. Ao final da marcha no tempo, a MTT é escrita em arquivo de forma a poder ser utilizada na etapa seguinte da migração.
    </p>
    <p>
     Mais uma vez, é importante lembrar que o procedimento descrito deve ser aplicado a cada um dos tiros da migração pré-empilhamento.
    </p>
    <h3>
     2a Etapa: propagação no sentido inverso
    </h3>
    <p>
     A seguir, a segunda parte da migração é apresentada no Algoritmo
     <a class="open-asset-modal" data-target="#ModalFigF3" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      3
     </a>
     . Como na etapa anterior, um modelo de velocidades suavizado deve ser utilizado. Agora o objetivo é fazer com que as reflexões e difrações associadas à energia propagada reversamente no tempo sejam atenuadas, evitando que a condição de imagem produza artefatos advindos destas ondas.
    </p>
    <p>
     Nesta etapa, adicionalmente, é necessário ler os arquivos contendo a matriz de tempo de trânsito e sismograma (armazenadas nas matrizes MTT e SIS), relativo ao tiro a ser migrado, como mostrado na linha 7. Além disso, o laço da marcha no tempo é realizado no sentido de tempo inverso, do tempo final para o inicial, conforme apresentado na linha 8. O sismograma deve ser aplicada como fonte, como discutido anteriormente, para que a energia registrada seja reintroduzida no domínio. Assim, a cada passo de tempo, aplica-se o sismograma (armazenado na matriz
     <i>
      SIS
     </i>
     (
     <i>
      N
     </i>
     <sub>
      <i>
       t
      </i>
     </sub>
     ,
     <i>
      N
     </i>
     <sub>
      <i>
       x
      </i>
     </sub>
     )), na posição em que foram medidos, referentes a cada um dos traços sísmicos, ou seja, na profundidade
     <i>
      i
     </i>
     <sub>
      <i>
       prof
      </i>
     </sub>
     e posição
     <i>
      x
     </i>
     <sub>
      1
     </sub>
     até
     <i>
      x
     </i>
     <sub>
      <i>
       k
      </i>
     </sub>
     , com
     <i>
      k
     </i>
     = 1 até
     <i>
      k
     </i>
     =
     <i>
      N
     </i>
     <sub>
      <i>
       R
      </i>
     </sub>
     , como feito no laço entre as linhas 9–11.
    </p>
    <div class="row fig" id="F3">
     <a name="F3">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigF3" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/d2d605848ace8898d8c04f7985fb4c4e12b447ed.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Algoritmo 3
      </strong>
      <br/>
      2a Etapa do imageamento&gt;
      <br/>
     </div>
    </div>
    <p>
     O laço duplo, varrendo toda malha, entre as linhas 18–23 é a condição de imagem. Como se vê, a cada passo de tempo, cada posição da malha é testada para verificar se o tempo (no caso dado pelo índice
     <i>
      n
     </i>
     de passo no tempo) é igual a MTT naquele ponto. Em caso afirmativo, a amplitude propagada inversamente no tempo (ou seja,
     <i>
      P
     </i>
     3) é salva na matriz
     <i>
      imagem
     </i>
     , na posição correspondente. Ao final da marcha no tempo, a matriz
     <i>
      imagem
     </i>
     é escrita em arquivo. Repare que esta imagem é referente a um único tiro, sendo, portanto, uma imagem parcial, capaz que imagear os refletores próximos à região do tiro. Da mesma forma, todos os demais tiros precisam ser migrados, devendo todas elas serem somadas para obter a imagem final.
    </p>
    <h2>
     5.3. Resultados do imageamento
    </h2>
    <p>
     Nesta seção, apresenta-se um exemplo completo de imageamento utilizando algoritmos escritos em Fortran 90 seguindo a lógica discutida acima. Como mencionado anteriormente, o método de imageamento utilizado é conhecido como Migração Reversa no Tempo pré-empilhamento. Neste exemplo serão migrados os 165 tiros do exemplo de aquisição apresentado no tópico
     <span class="ref footnote">
      <sup class="xref">
       5.1
      </sup>
      <span class="refCtt closed">
       <span class="refCttPadding">
        5.1. Aquisição sísmica
        A seguir, apresenta-se uma aquisição sísmica sintética realizada com um programa escrito em Fortran 90 seguindo o algoritmo explicado anteriormente. O modelo rodado está representado na Fig. 9. Ele foi derivado do modelo desenvolvido pela Hess Corporation e disponibilizado por cortesia pela empresa, sendo mantido na Internet pela Society of Exploration Geophysicists (SEG) para que interessados possam utilizar. Trata-se de uma modelo offshore (em mar) interessante do ponto de vista geológico, uma vez que contém um corpo salino de alta velocidade (c = 4500 m/s) à esquerda e uma grande falha à direita. Originalmente ele é um modelo anisotrópico, como simetria vertical transversa (ver artigo II), embora seja utilizado aqui neste primeiro artigo da série considerando-se os parâmetros de anisotropia iguais a zero.
        
          Figura 9
          
            Modelo de velocidades acústico utilizado, baseado no modelo Hess.
          
          
            
            
          
        
        O modelo Hess é composto originalmente por 3617×1501 pontos e uma lâmina d’água pouco profunda. O modelo utilizado aqui teve sua camada de água expandida e foi reamostrado para 2001×601 pontos, de modo a ser factível rodar os exemplos deste trabalho com a máquina disponível em tempo razoável. Como o espaçamento utilizado foi de h = 7 m, o tamanho total do modelo ficou em 14,0×4,2 km. A fonte empregada foi um pulso de Ricker de frequência fcorte = 40 Hz e o incremento temporal adotado foi de Δt = 3,8×10−4 s, sendo o número de passos no tempo adotado de Nt = 9000, totalizando um tempo de análise total de tf = 3,42 s. Com isto, os parâmetros numéricos ficaram de acordo com o recomendado no tópico 4.2.1, ou seja, o número α (pontos por comprimento de onda mínimo) não inferior a 5 e o número de passos de tempo β (iterações necessárias para levar a informação mais rápida de um ponto a outro da malha) não inferior a 4:
        
          (41)
          
            
              
                α
                =
                
                  
                    
                      c
                      
                        m
                        ⁢
                        i
                        ⁢
                        n
                      
                    
                    
                      h
                      ⁢
                      
                        f
                        
                          c
                          ⁢
                          o
                          ⁢
                          r
                          ⁢
                          t
                          ⁢
                          e
                        
                      
                    
                  
                
                =
                
                  
                    1500
                    
                      7
                      ×
                      40
                    
                  
                
                ≈
                5
              
              ,
              4
            
          
        
        
          (42)
          
            
              
                
                  β
                  =
                  
                    
                      h
                      
                        Δ
                        ⁢
                        t
                        ⁢
                        
                          c
                          
                            m
                            ⁢
                            a
                            ⁢
                            x
                          
                        
                      
                    
                  
                  =
                  
                    
                      7
                      
                        3
                        ,
                        
                          8
                          ×
                          
                            10
                            
                              -
                              4
                            
                          
                          ×
                          4500
                        
                      
                    
                  
                  ≈
                  4
                
                ,
                1
              
              .
            
          
        
        Tais valores garantem uma precisão numérica adequada. Como os valores estão próximos dos ideais estipulados, garante-se que a modelagem não utilize mais recursos computacionais que o necessário para o problema em questão. Por exemplo, rodar um modelo com as mesmas dimensões físicas e pelo mesmo tempo total de análise utilizando α = 10 (o que equivale a reduzir o h pela metade) implicaria, no caso 2D, em quadruplicar o número de pontos da malha, multiplicando o tempo de processamento pelo mesmo fator. Além disso, ao reduzir o h pela metade, o Δt também precisa ser reduzido pela metade para satisfazer a Eq. 40, implicando na necessidade de dar o dobro do número de passos de tempo. No total, o tempo de processamento teria aumentado 8 vezes, além do maior gasto de memória.
        Na aquisição sintética rodada, um navio arrasta os receptores atrás de si, andando para a direita com a geometria de aquisição descrita a seguir. A cobertura do cabo de receptores é de 2,1 km, onde os receptores estão espaçados de 70 m (sendo 70 m o offset mínimo), totalizando 30 receptores localizados a esquerda da fonte sísmica (como mostrado esquematicamente na Fig. 9): a linha tracejada R representa os receptores e os asteriscos representam a fonte nas posições em que foram aplicadas. A distância entre os tiros foi também de 70 m e, no total, foram dados 165 tiros, com a posição inicial de x = 2,1 km. Somente as posições do primeiro tiro e dos tiros 10, 60, 110 e 160 são apresentadas na Fig. 9. Cada tiro demorou cerca de 7 minutos para roda em uma máquina com processador Intel i7 de 3.4 GHz.
        Alguns instantâneos mostrando a distribuição do campo de pressão no domínio para um determinado tempo, para diferentes tempos, referente ao tiro 60, são apresentados na Fig. 10.
        
          Figura 10
          
            Snapshots da propagação da onda para o tiro 60 nos tempos (a) t = 1,33s, (b) t = 1,90s, (c) t = 2,47s e (d) t = 3,04s.
          
          
            
            
          
        
        Na Figura 11, são apresentados os sismogramas dos tiros 10, 60, 110 e 160 (mostrados na Fig. 9), ou seja, as respostas ao longo do tempo (no eixo vertical) para cada receptor (no eixo horizontal), dispostos em ordem crescente de offset (distância entre fonte e receptor).
        
          Figura 11
          
            Sismogramas adquiridos nas posições indicadas na Fig. 9, referentes aos tiros de número (a) 10, (b) 60, (c) 110, (d) 160.
          
          
            
            
          
        
        Através dos snapshots (instantâneos do campo de propagação em termos de pressão acústica), pode-se acompanhar a propagação da onda, desde a fonte até ser refletida e retornar aos receptores. Assim, pode-se identificar os diversos eventos coerentes presentes em um sismograma (que seja apresentado posteriormente). É fácil mostrar que as reflexões em interfaces planas são caracterizadas por hipérboles no sismograma, as chamadas hipérboles de reflexão. Quando os receptores não são planos, pode haver desvios da forma hiperbólica. Mesmo não sendo planos, eles podem ser aproximadamente planos localmente (como é o caso deste exemplo), dependendo do tamanho do cabo de receptores em comparação com a curvatura do refletor.
        Em geral, sismogramas contém inúmeras hipérboles que podem ser facilmente identificadas em meio aos mais variados ruídos coerentes (que são eventos assim considerados uma vez que não se tratam de reflexões, como, por exemplo, as refrações). Neste exemplo, não foram inseridos ruídos adicionais (há, entretanto, ruídos numéricos, imperceptíveis nos instantâneos), e sismogramas representam as respostas puras das simulações de propagação, contendo todos os eventos associados a esta propagação, como por exemplo as múltiplas (eventos que ocorrem quando a onda atinge a superfície do modelo, sendo refletiva e retornando para baixo em direção aos refletores novamente, atingindo por fim os receptores mais uma vez).
        O primeiro evento hiperbólico que aparece em cada um dos sismogramas sintéticos da Fig. 11 caracteriza a reflexão no fundo do mar, sendo as demais curvas associadas à reflexão nas demais interfaces e no sal, bem como reflexões múltiplas. A reta inclinada que aparece sempre na mesma posição em todos os sismogramas é a onda direta que se propaga na água, desde a fonte até os receptores. Quanto mais longe o receptor está da fonte (maior o offset), mais tempo a onda irá levar para chegar ao receptor. No tiro 60 (Fig. 11(b)), como exemplo de identificação de eventos nos sismograma sintético, chama-se a atenção para o sexto evento de reflexão, com amplitude acentuada, aproximadamente entre os tempos 2,25 e 2,5 s. Pode-se ver claramente através dos snapshots (em especial, da Fig. 10(a)) que ele caracteriza a reflexão no corpo de sal.
       </span>
      </span>
     </span>
     . Por consistência, a mesma geometria de aquisição e os mesmos parâmetros são utilizados.
    </p>
    <p>
     Na Figura
     <a class="open-asset-modal" data-target="#ModalFigS5_F14" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      14
     </a>
     são mostradas as imagens dos tiros 10, 60, 110 e 160, colocando-se o modelo de velocidades como fundo (para comparação). Como dito anteriormente, cada imagem é capaz de recuperar apenas as informações próximas aos receptores, sendo imagens parciais de toda a área em estudo. Somente após o empilhamento de todos o tiros é que obtém-se uma imagem satisfatória de toda seção. O processo de empilhamento é responsável também por melhorar a razão sinal-ruído da imagem final em relação às imagens individuais de cada trecho. Isto se deve ao fato dos tiros serem dados próximos uns aos outros, de forma a haver eventos redundantes.
    </p>
    <div class="row fig" id="S5_F14">
     <a name="S5_F14">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS5_F14" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/3a74cd8ec1f4be855bbeee7f01555e90d5b7b588.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 14
      </strong>
      <br/>
      Imagens de tiro único para cada um dos tiros mostrados na Fig.
      <a class="open-asset-modal" data-target="#ModalFigS5_F9" data-toggle="modal" href="">
       <span class="sci-ico-fileFigure">
       </span>
       9
      </a>
      , ou seja, os tiros (a) 10, (b) 60, (c) 110 e (d) 160.
      <br/>
     </div>
    </div>
    <p>
     Assim, os eventos associados a reflexões e difrações de fato são amplificados, uma vez que tendem a aparecer em todas as imagens próximas, enquanto os artefatos tendem a se cancelar. O resultado final da migração dos 165, após o empilhamento de todos os tiros, é mostrado na Fig
     <a class="open-asset-modal" data-target="#ModalFigS5_F15" data-toggle="modal" href="">
      <span class="sci-ico-fileFigure">
      </span>
      15
     </a>
     . Enfatizamos que a imagem está apresentada como saída do algoritmo de empilhamento, no qual as matrizes de imagem dos diferentes tiros foram simplesmente somada e nenhum filtro para remover ruídos foi aplicado. A migração dos 165 tiros levou cerca de 20 horas no total, sendo que a primeira e a segunda etapas foram rodadas em paralelo em um processador multinúcleo de 3.4 GHz.
    </p>
    <div class="row fig" id="S5_F15">
     <a name="S5_F15">
     </a>
     <div class="col-md-4 col-sm-4">
      <a data-target="#ModalFigS5_F15" data-toggle="modal" href="">
       <div class="thumbImg">
        <img src="https://minio.scielo.br/documentstore/1806-9126/F9tMcXCvkhVWXzbt8sLLVDm/5d6188795af7685dbe3c3e8a70a57124799a311e.jpg"/>
        <div class="zoom">
         <span class="sci-ico-zoom">
         </span>
        </div>
       </div>
      </a>
     </div>
     <div class="col-md-8 col-sm-8">
      <strong>
       Figura 15
      </strong>
      <br/>
      Imagem final do modelo Hess após o empilhamento dos 165 tiros.
      <br/>
     </div>
    </div>
    <h1 class="articleSectionTitle">
     6. Conclusões
    </h1>
    <p>
     Neste trabalho, foi apresentada de forma didática e detalhada a parte teórica e a construção de um algoritmo de propagação de ondas acústicas utilizando o Método das Diferenças Finitas. Foi discutida também a sua aplicação ao mapeamento de refletores utilizando propagação de ondas reversas no tempo, sendo tal método conhecido como Migração Reversa no Tempo pré-empilhamento na literatura especializada de Geofísica Aplicada. Trata-se de um dos métodos de imageamento mais poderosos aplicados pela indústria do petróleo, que vem sendo utilizado para imagear regiões extremamente desafiadoras como, e.g., o pré-sal.
    </p>
    <p>
     Todas as ideias fundamentais foram discutidas em detalhes, tendo os algoritmos sido apresentados, permitindo ao leitor uma visão detalhada de um dos principais métodos utilizados na exploração de hidrocarbonetos atualmente. Diversos exemplos e figuras visaram ilustrar ideias de compreensão mais difícil, mesmo para o público da área de Geofísica. A partir do exposto, espera-se que qualquer pessoa com conhecimentos de programação e física seja capaz de compreender e implementar os algoritmos apresentados e reproduzir os exemplos, preenchendo-se uma lacuna de material sobre o tema para um público de físicos, em especial aqueles que almejam especializar-se em Geofísica, um quantitativo cada vez maior de jovens, devido às perspectivas de emprego em empresas.
    </p>
    <p>
     Além disso, a simplicidade da resolução da equação acústica da onda pelo MDF permite a abordagem do tema em disciplinas da graduação. Sua aplicação ao imageamento constitui-se em um desafio interessante para o estudante, uma vez que articula conhecimentos computacionais, de física pura e aplicada em um único problema, enquanto introduz o estudante a um tema de ponta em uma área correlata da Física.
    </p>
    <p>
     O imageamento em meios mais complexos, que demandam a utilização de algoritmos de propagação mais elaborados – tanto no que se refere a equações mais refinadas, e.g., a equação elástica da onda com anisotropia, como outros algoritmos utilizando MDF ou outros métodos numéricos –, pode ser abordado utilizando-se as mesmas ideias básicas discutidas neste trabalho. Assim, espera-se que ele possa servir de motivação para o aprendizado e aplicação em casos mais complexos. Pode ainda servir de motivação para aplicações em casos distintos como, por exemplo, o imageamento com ultrassom em medicina ou a realização de ensaios não destrutivos em engenharia.
    </p>
   </div>
   <div class="articleSection" data-anchor="Agradecimentos">
    <h1 class="articleSectionTitle">
     Agradecimentos
    </h1>
    <p>
     Agradeço aos Drs. Cleberson Dors e Cid S. G. Monteiro, autores do código de visualização utilizados e aos Drs. Jaime F. Vilas da Rocha e Luis Juracy R. Lemos pelas leituras criticas do manuscrito.
    </p>
   </div>
   <div class="articleSection" data-anchor="Referências bibliográficas">
    <h1 class="articleSectionTitle">
     References
    </h1>
    <div class="ref-list">
     <ul class="refList">
      <li>
       <sup class="xref big">
        1.
       </sup>
       <div>
        E. Baysal, D.D. Kosloff e J.W.C. Sherwood, Geophysics 48 , 1514 (1983).
       </div>
      </li>
      <li>
       <sup class="xref big">
        2.
       </sup>
       <div>
        G.A. Mcmechan, Geophysical Prospecting 31 , 413 (1983).
       </div>
      </li>
      <li>
       <sup class="xref big">
        3.
       </sup>
       <div>
        N.D. Whitmore,
        <i>
         Iterative depth migration by backward time propagation
        </i>
        , disponível em: https://doi.org/10.1190/1.1893867
        <br/>
        <a href="https://doi.org/10.1190/1.1893867" target="_blank">
         » https://doi.org/10.1190/1.1893867
        </a>
       </div>
      </li>
      <li>
       <sup class="xref big">
        4.
       </sup>
       <div>
        P. Kearey, M.l Brooks e I. Hill,
        <i>
         Geofísica de exploração
        </i>
        (Oficina de Textos, São Paulo, 2009).
       </div>
      </li>
      <li>
       <sup class="xref big">
        5.
       </sup>
       <div>
        O. Yilmaz,
        <i>
         Seismic Data Analysis. Processing, Inversion, and Interpretation of Seismica Data
        </i>
        (Society of Exploration Geophysicists, Tulsa, 2008).
       </div>
      </li>
      <li>
       <sup class="xref big">
        6.
       </sup>
       <div>
        A.V. Andrade-Neto e D.D. Andrade, Revista Brasileira de Ensino de Física 43 , e20200350 (2021).
       </div>
      </li>
      <li>
       <sup class="xref big">
        7.
       </sup>
       <div>
        C.P.A. Wapenaar e A.J. Berkhout,
        <i>
         Elastic Wave Field Extrapolation: Redatuming of Single- and Multi-Component Seismic Data
        </i>
        (Elsevier Science, New York, 1989), v. 2.
       </div>
      </li>
      <li>
       <sup class="xref big">
        8.
       </sup>
       <div>
        M. Nussenzweig,
        <i>
         Curso de Física Básica
        </i>
        (Edgard Blücher, São Paulo, 1996), v. 2, 3ª ed.
       </div>
      </li>
      <li>
       <sup class="xref big">
        9.
       </sup>
       <div>
        L. Di Bartolo, C. Dors e W.J. Mansur, Geophysics 77 , T187 (2012).
       </div>
      </li>
      <li>
       <sup class="xref big">
        10.
       </sup>
       <div>
        C. Cerjan, D. Kosloff, R. Kosloff e M. Reshef, Geophysics 50 , 705 (1985).
       </div>
      </li>
      <li>
       <sup class="xref big">
        11.
       </sup>
       <div>
        J.P. Berenger, Journal of computational physics 114 , 185 (1994).
       </div>
      </li>
      <li>
       <sup class="xref big">
        12.
       </sup>
       <div>
        D. Loewenthal, P.L. Stoffa e E.L. Faria, Geophysics 52 , 1007 (1987).
       </div>
      </li>
      <li>
       <sup class="xref big">
        13.
       </sup>
       <div>
        J.W. Thomas,
        <i>
         Numerical partial differential equations: finite difference methods
        </i>
        (Springer Science &amp; Business Media, Berlim, 1995), v. 22.
       </div>
      </li>
      <li>
       <sup class="xref big">
        14.
       </sup>
       <div>
        J.C. Strikwerda,
        <i>
         Finite difference schemes and partial differential equations
        </i>
        (SIAM, Pensilvânia, 2004), 2ª ed.
       </div>
      </li>
      <li>
       <sup class="xref big">
        15.
       </sup>
       <div>
        R.J. LeVeque,
        <i>
         Finite difference methods for ordinary and partial differential equations: steady-state and time-dependent problems
        </i>
        (SIAM, Pensilvânia, 2007).
       </div>
      </li>
      <li>
       <sup class="xref big">
        16.
       </sup>
       <div>
        I.P. Mysovskih,
        <i>
         Lectures on Numerical Methods
        </i>
        (Wolters-Noordhoff Plublishin Groningen, Netherlands, 1969).
       </div>
      </li>
      <li>
       <sup class="xref big">
        17.
       </sup>
       <div>
        V.S. Ryaben’Kii e S.V. Tsynkov,
        <i>
         A theoretical introduction to numerical analysis
        </i>
        (Chapman &amp; Hall/CRC, New York, 2007).
       </div>
      </li>
      <li>
       <sup class="xref big">
        18.
       </sup>
       <div>
        E. Isaacson e H.B. Keller,
        <i>
         Analysis of numerical methods
        </i>
        (Dover Inc, Illinois, 1994), 1ª ed.
       </div>
      </li>
      <li>
       <sup class="xref big">
        19.
       </sup>
       <div>
        K.J. Bathe,
        <i>
         Finite Element Procedures
        </i>
        (Prentice-Hall, New Jersey, 1996), 2ª ed.
       </div>
      </li>
      <li>
       <sup class="xref big">
        20.
       </sup>
       <div>
        L. Anne, P. Joly e Q.H. Tran, Computacional Geociences 4 , 207 (2000).
       </div>
      </li>
      <li>
       <sup class="xref big">
        21.
       </sup>
       <div>
        K.R. Kelly, R.W. Ward, S. Treitel e R.M. Alford, Geophysics 41 , 2 (1976).
       </div>
      </li>
      <li>
       <sup class="xref big">
        22.
       </sup>
       <div>
        K.F. Graff,
        <i>
         Wave Motion in Elastic Solids
        </i>
        (Dover Publication, Mineola, 1991).
       </div>
      </li>
     </ul>
    </div>
   </div>
   <div class="articleSection">
    <div class="ref-list">
     <ul class="refList footnote">
      <li>
       <span class="xref big">
        1
       </span>
       <div>
        <i>
         n-ésima ordem na variável x
        </i>
        significa que o erro de truncamento da série de Taylor da aproximação via DF seja da ordem da
        <i>
         n
        </i>
        -ésima potência do equivalente espaçamento da malha, isto é, Δ
        <i>
         x
        </i>
        <sup>
         <i>
          n
         </i>
        </sup>
        .
       </div>
      </li>
     </ul>
    </div>
   </div>
   <div class="articleSection" data-anchor="Datas de Publicação ">
    <h1 class="articleSectionTitle">
     Datas de Publicação
    </h1>
    <div class="row">
     <div class="col-md-12 col-sm-12">
      <ul class="articleTimeline">
       <li>
        <strong>
         Publicação nesta coleção
        </strong>
        <br/>
        06 Ago 2021
       </li>
       <li>
        <strong>
         Data do Fascículo
        </strong>
        <br/>
        2021
       </li>
      </ul>
     </div>
    </div>
   </div>
   <div class="articleSection" data-anchor="Histórico">
    <h1 class="articleSectionTitle">
     Histórico
    </h1>
    <div class="row">
     <div class="col-md-12 col-sm-12">
      <ul class="articleTimeline">
       <li>
        <strong>
         Recebido
        </strong>
        <br/>
        02 Jun 2021
       </li>
       <li>
        <strong>
         Revisado
        </strong>
        <br/>
        13 Jul 2021
       </li>
       <li>
        <strong>
         Aceito
        </strong>
        <br/>
        13 Jul 2021
       </li>
      </ul>
     </div>
    </div>
   </div>
   <section class="documentLicense">
    <div class="container-license">
     <div class="row">
      <div class="col-sm-3 col-md-2">
       <a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank" title="">
        <img alt="Creative Common - by 4.0 deed.en" src="https://licensebuttons.net/l/by/4.0/deed.en/88x31.png"/>
       </a>
      </div>
      <div class="col-sm-9 col-md-10">
       <a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank" title="">
        This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.
       </a>
      </div>
     </div>
    </div>
   </section>
  </article>
 </div>
</div>